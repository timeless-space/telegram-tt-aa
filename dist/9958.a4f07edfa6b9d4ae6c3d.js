"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[9958],{4794:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(60748),o=n(33555),s=n(7054),i=n(42431),r=n(46752),c=n(18360),l=n(59107),d=n(31212),m=n(70172),u=n(231);const h=(0,a.X$)((0,o.c$)(((e,{chatId:t})=>{const n=(0,s.Z1J)(e,t),a=(0,i.Bj)(e,t);return{groupCall:a,isActive:((0,s.jUK)(e).isMasterTab?e.groupCalls.activeGroupCallId:void 0)!==a?.id&&Boolean(a?a.participantsCount>0&&a.isLoaded:n&&n.isCallNotEmpty&&n.isCallActive)}}))((({chatId:e,isActive:t,className:n,groupCall:s,hasPinnedOffset:i})=>{const{requestMasterAndJoinGroupCall:h,subscribeToGroupCallUpdates:p}=(0,o.Sv)(),Z=(0,l.Z)(),g=(0,a.I4)((()=>{h({chatId:e})}),[h,e]),f=s?.participants,v=(0,a.Ye)((()=>{if(!f)return[];const e=(0,o.Rd)().users.byId,t=(0,o.Rd)().chats.byId;return Object.values(f).slice(0,3).map((({id:n})=>e[n]||t[n])).filter(Boolean)}),[f]);(0,a.d4)((()=>{if(s?.id&&(t||!s.isLoaded))return p({id:s.id,subscribed:!0}),()=>{p({id:s.id,subscribed:!1})}}),[s?.id,s?.isLoaded,t,p]);const{shouldRender:P,transitionClassNames:E}=(0,d.Z)(Boolean(s&&t)),y=(0,c.Z)(s?.participantsCount,!0),b=(0,c.Z)(v,!0);if(P)return a.ZP.createElement("div",{className:(0,r.Z)("GroupCallTopPane",i&&"has-pinned-offset",n,E),onClick:g},a.ZP.createElement("div",{className:"info"},a.ZP.createElement("span",{className:"title"},Z("VoipGroupVoiceChat")),a.ZP.createElement("span",{className:"participants"},Z("Participants",y??0,"i"))),a.ZP.createElement("div",{className:"avatars"},b?.map((e=>a.ZP.createElement(m.Z,{key:e.id,peer:e})))),a.ZP.createElement(u.Z,{round:!0,className:"join"},Z("VoipChatJoin")))})))},34076:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(60748),o=n(33555),s=n(7054),i=n(46752),r=n(60706),c=n(59107);const l=({text:e,className:t})=>{const n=(0,c.Z)(),l=(0,a.sO)(),[d,m,u]=(0,r.Z)(!1),h=(0,s.FOo)((0,o.Rd)()),p=(0,a.Ye)((()=>{if(!h)return e;if(!d)return l.current||e;const t=l.current,n=[];for(let o=0;o<e.length;o++)t&&e[o]!==t[o]?n.push(a.ZP.createElement("div",{className:"IYTzbS8o"},a.ZP.createElement("div",{className:"Jw1oQFdk"},e[o]),a.ZP.createElement("div",{className:"TZfEz3sc",onAnimationEnd:u},t[o]),a.ZP.createElement("div",{className:"Y9ied8_t",onAnimationEnd:u},e[o]))):n.push(a.ZP.createElement("span",null,e[o]));return l.current=e,n}),[h,d,e]);return(0,a.d4)((()=>{m()}),[e]),a.ZP.createElement("span",{className:(0,i.Z)("tgKbsVmz",t),dir:n.isRtl?"rtl":void 0},p)}},45601:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(60748),o=n(59187),s=n(4463),i=n(6202),r=n(21179);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c.apply(this,arguments)}const l=(0,a.X$)((function(e){const{sticker:t,noLoad:n,forcePreview:l,...d}=e,m=t?.thumbnail?.dataUri,u=t&&`sticker${t.id}`,h=(0,i.Z)(t?(0,s.RK)(t.id):void 0,n&&!l,o.IU.BlobUrl),p=(0,i.Z)(u,n);return a.ZP.createElement(r.Z,c({tgsUrl:p,previewUrl:h,thumbDataUri:m},d))}))},21179:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(60748),o=n(46752),s=n(80036),i=n(60706),r=n(25190),c=n(70692),l=n(58912);const d="lM2usrZU";function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m.apply(this,arguments)}const u=new Set,h=(0,a.X$)((function(e){const{previewUrl:t,thumbDataUri:n,className:h,...p}=e,[Z,,g]=(0,i.Z)(Boolean(n)),f=(0,c.Z)(Z),[v,P,E]=(0,i.Z)(u.has(t)),y=(0,c.Z)(v),[b,C]=(0,i.Z)(!1),S=(0,r.Z)((()=>{P(),u.add(t)})),w=(0,r.Z)((()=>{g(),E(),setTimeout(C,300)})),{size:I}=e;return a.ZP.createElement("div",{className:(0,o.Z)(h,"xCi2f0YH"),style:(0,s.Z)(void 0!==I&&`width: ${I}px; height: ${I}px;`)},n&&!b&&a.ZP.createElement("img",{src:n,className:(0,o.Z)(d,f),draggable:!1}),t&&!b&&a.ZP.createElement("img",{src:t,className:(0,o.Z)(d,y),draggable:!1,onLoad:S}),a.ZP.createElement(l.Z,m({},p,{onLoad:w})))}))},73482:(e,t,n)=>{n.d(t,{ZP:()=>A});var a=n(60748),o=n(33555),s=n(59187),i=n(91713),r=n(4463),c=n(10396),l=n(46752),d=n(64963),m=n(790),u=n(1735),h=n(89945),p=n(15376),Z=n(32340);var g=n(42797),f=n(23186),v=n(12019),P=n(59107),E=n(25190),y=n(6202),b=n(6701),C=n(31212),S=n(231),w=n(8337),I=n(39196),N=n(58912),M=n(65979);const k=window.matchMedia("(max-width: 375px)"),T=window.matchMedia("(max-width: 410px)");function x(e,t,n){return a.ZP.createElement("div",{className:"seekline",ref:n},t.map((({start:e,end:t})=>a.ZP.createElement("div",{className:"seekline-buffered-progress",style:`left: ${100*e}%; right: ${100-100*t}%`}))),a.ZP.createElement("span",{className:"seekline-play-progress"},a.ZP.createElement("i",{className:"seekline-play-progress-inner",style:`transform: translateX(${100*e}%)`})),a.ZP.createElement("span",{className:"seekline-thumb"},a.ZP.createElement("i",{className:"seekline-thumb-inner",style:`transform: translateX(${100*e}%)`})))}const A=(0,a.X$)((({theme:e,message:t,senderTitle:n,uploadProgress:A,origin:R,date:O,noAvatars:L,className:B,isSelectable:D,isSelected:$,isDownloading:F,isTranscribing:U,isTranscriptionHidden:j,isTranscribed:_,isTranscriptionError:V,canDownload:z,canTranscribe:H,autoPlay:W,onHideTranscription:q,onPlay:G,onPause:Y,onReadMedia:X,onCancelUpload:K,onDateClick:J})=>{const{cancelMessageMediaDownload:Q,downloadMessageMedia:ee,transcribeAudio:te,openOneTimeMediaModal:ne}=(0,o.Sv)(),{content:{audio:ae,voice:oe,video:se},isMediaUnread:ie}=t,re=ae||(0,r.jR)(t),ce=Boolean(oe||se),le=(0,a.sO)(!1),de=(0,a.sO)(null),me=(0,P.Z)(),{isRtl:ue}=me,{isMobile:he}=(0,g.ZP)(),[pe,Ze]=(0,a.eJ)(!1),ge=pe||!0,fe=(0,r.Ti)(t,"pictogram"),ve=(0,y.Z)(fe,!1,s.IU.BlobUrl),Pe=(0,r.qR)(t),Ee=R===i.Cr.OneTimeModal,ye=ce?Pe?"oneTimeVoice":"voice":"audio",be=(0,y.Z)((0,r.Ti)(t,"inline"),!ge,(0,r.kG)(t,"inline")),{loadProgress:Ce}=(0,b.Z)((0,r.Ti)(t,"download"),!F,(0,r.kG)(t,"download")),Se=(0,E.Z)((()=>{Ze(!0),G?.(t.id,t.chatId)})),we=(0,E.Z)((()=>{Ze(!1)})),{isBuffered:Ie,bufferedRanges:Ne,bufferingHandlers:Me,checkBuffering:ke}=(0,v.Z)(),Te=Ee,{isPlaying:xe,playProgress:Ae,playPause:Re,setCurrentTime:Oe,duration:Le}=(0,f.Z)((0,c.An)(t),(0,r.XV)(t),ye,be,Me,void 0,ke,Boolean(pe||W),Se,we,(0,r.CI)(t)||Pe,void 0,Y,Te,Pe&&!Ee),Be=1-Ae,De=(0,r.B4)(t),$e=Pe&&Ee,Fe=function(e,t,n=0,o=!1,s=!1,i=!1,r=!1){const c=(0,a.sO)(null),{data:l,peak:d}=(0,a.Ye)((()=>{if(!t)return;const{waveform:e,duration:n}=t;if(!e)return{data:new Array(Math.min(n,30)).fill(0),peak:0};const{MIN_SPIKES:a,MAX_SPIKES:o}=function(e,t){return{MIN_SPIKES:e?k.matches?16:20:25,MAX_SPIKES:e?k.matches?35:t&&T.matches?40:45:75}}(i,s),r=Math.min(n/10,1),c=Math.round(a+(o-a)*r),l=(0,u.x)(new Uint8Array(e));return(0,u.C)(l,c)}),[i,t,s])||{};return(0,a.bt)((()=>{const t=c.current;t&&l&&void 0!==d&&function(e,t,n,{peak:a,fillStyle:o,progressFillStyle:s}){const i=4*t.length;e.width=2*i,e.height=46,e.style.width=`${i}px`,e.style.height="23px";const r=e.getContext("2d");r.scale(2,2),t.forEach(((e,i)=>{r.globalAlpha=i/t.length>=n?.5:1,r.fillStyle=n>i/t.length?s:o;const c=Math.max(2,e/Math.max(1,a)*23);!function(e,t,n,a,o,s){2<2*s&&(s=1),o<2*s&&(s=o/2),e.beginPath(),e.moveTo(t+s,n),e.arcTo(t+2,n,t+2,n-o,s),e.arcTo(t+2,n-o,t,n-o,s),e.arcTo(t,n-o,t,n,s),e.arcTo(t,n,t+2,n,s),e.closePath()}(r,4*i,(23+c)/2,0,c,1),r.fill()}))}(t,l,r?1-n:n,{peak:d,fillStyle:o?"dark"===e?"#B7ABED":"#AEDFA4":"dark"===e?"#494A78":"#ADD3F7",progressFillStyle:o?"dark"===e?"#FFFFFF":"#4FAE4E":"dark"===e?"#8774E1":"#3390EC"})}),[o,d,n,l,e,r]),c}(e,oe,!ie||De||$e?Ae:1,De,!L,he,$e),Ue=xe||Ae>0&&Ae<1;(0,a.d4)((()=>{Ze(xe)}),[xe]);const je=pe&&!Ie,{isUploading:_e,isTransferring:Ve,transferProgress:ze}=(0,r.Sc)(t,A||Ce,je||F,void 0!==A),{shouldRender:He,transitionClassNames:We}=(0,C.Z)(Ve),qe=He&&(je||_e),Ge=(0,E.Z)((()=>{if(_e)K?.();else{if(Pe)return ne({message:t}),void X?.();xe||G?.(t.id,t.chatId),(0,o.Sv)().setAudioPlayerOrigin({origin:R}),Ze(!pe),Re()}}));(0,a.d4)((()=>{X&&ie&&(xe||F)&&X()}),[xe,ie,X,F]);const Ye=(0,E.Z)((()=>{F?Q({message:t}):ee({message:t})})),Xe=(0,E.Z)((e=>{if(le.current&&de.current){const{width:t,left:n}=de.current.getBoundingClientRect(),a=e instanceof MouseEvent?e.clientX:e.targetTouches[0].clientX;e.stopPropagation(),Oe(Math.max(Math.min(Le*((a-n)/t),Le-.1),.001))}})),Ke=(0,E.Z)((e=>{e instanceof MouseEvent&&2===e.button||(le.current=!0,Xe(e))})),Je=(0,E.Z)((()=>{le.current=!1})),Qe=(0,E.Z)((()=>{J(t.id,t.chatId)})),et=(0,E.Z)((()=>{te({chatId:t.chatId,messageId:t.id})}));function tt(){if(ce)return n||"Voice";const{title:e,fileName:t}=re;return e||t}(0,a.d4)((()=>{if(de.current&&Ue&&!Ee)return(0,d.sf)(de.current,{onCapture:Ke,onRelease:Je,onClick:Je,onDrag:Xe})}),[Ue,Ke,Xe,Je,Ee]);const nt=(0,l.Z)("Audio",B,Ee&&"non-interactive",R===i.Cr.Inline&&"inline",De&&R===i.Cr.Inline&&"own",(R===i.Cr.Search||R===i.Cr.SharedMedia)&&"bigger",$&&"audio-is-selected"),at=["toogle-play-wrapper"];qe?at.push("loading"):at.push(xe?"pause":"play");const ot=(0,l.Z)("content",Ue&&"with-seekline");function st(){return a.ZP.createElement("div",{className:ot},a.ZP.createElement("div",{className:"content-row"},a.ZP.createElement("p",{className:"title",dir:"auto",title:tt()},(0,Z.Z)(tt())),a.ZP.createElement("div",{className:"message-date"},Boolean(O)&&a.ZP.createElement(w.Z,{className:"date",onClick:Qe},(0,m.VX)(me,1e3*O)))),Ue&&a.ZP.createElement("div",{className:"meta search-result",dir:ue?"rtl":void 0},a.ZP.createElement("span",{className:"duration with-seekline",dir:"auto"},Ae<1&&`${(0,m.k9)(Le*Ae,Le)}`),x(Ae,Ne,de)),!Ue&&function(){if(ce)return a.ZP.createElement("div",{className:"meta",dir:ue?"rtl":void 0},(0,m.k9)((oe||se).duration));const{performer:e}=re;return a.ZP.createElement("div",{className:"meta",dir:ue?"rtl":void 0},(0,m.k9)(Le),a.ZP.createElement("span",{className:"bullet"},"•"),e&&a.ZP.createElement("span",{className:"performer",title:e},(0,Z.Z)(e)),e&&n&&a.ZP.createElement("span",{className:"bullet"},"•"),n&&a.ZP.createElement("span",{title:n},(0,Z.Z)(n)))}())}return a.ZP.createElement("div",{className:nt,dir:me.isRtl?"rtl":"ltr"},D&&a.ZP.createElement("div",{className:"message-select-control"},$&&a.ZP.createElement("i",{className:"icon icon-select"})),a.ZP.createElement("div",{className:(0,l.Z)(...at)},a.ZP.createElement(S.Z,{round:!0,ripple:!he,size:"smaller",className:"toggle-play",color:ve?"translucent-white":"primary",ariaLabel:xe?"Pause audio":"Play audio",onClick:Ge,isRtl:me.isRtl,backgroundImage:ve,nonInteractive:Ee},!Ee&&a.ZP.createElement(M.Z,{name:"play"}),!Ee&&a.ZP.createElement(M.Z,{name:"pause"}),Ee&&a.ZP.createElement(N.Z,{className:"flame",tgsUrl:h.l.Flame,nonInteractive:!0,noLoop:!1,size:40})),Pe&&!Ee&&a.ZP.createElement(M.Z,{name:"view-once"})),He&&a.ZP.createElement("div",{className:(0,l.Z)("media-loading",We,qe&&"interactive")},a.ZP.createElement(I.Z,{progress:ze,transparent:!0,withColor:!0,size:"m",onClick:qe?Ge:void 0,noCross:!qe})),Ee&&!He&&a.ZP.createElement("div",{className:(0,l.Z)("media-loading")},a.ZP.createElement(I.Z,{progress:Ae,transparent:!0,size:"m",noCross:!0,rotationOffset:3/4})),re&&z&&!_e&&a.ZP.createElement(S.Z,{round:!0,size:"tiny",className:"download-button",ariaLabel:F?"Cancel download":"Download",onClick:Ye},a.ZP.createElement("i",{className:(0,l.Z)("icon",F?"icon-close":"icon-arrow-down")})),R===i.Cr.Search&&st(),R!==i.Cr.Search&&re&&function(e,t,n,o,s,i,r,c,l,d,u){const{title:h,performer:g,fileName:f}=t,v=o||s>0&&s<1,{isRtl:P}=e;return a.ZP.createElement("div",{className:"content"},a.ZP.createElement("p",{className:"title",dir:"auto",title:h},(0,Z.Z)(h||f)),v&&a.ZP.createElement("div",{className:"meta",dir:P?"rtl":void 0},a.ZP.createElement("span",{className:"duration with-seekline",dir:"auto"},(0,m.k9)(n*s,n)),x(s,i,r)),!v&&c&&a.ZP.createElement("div",{className:"meta",dir:P?"rtl":void 0},d?`${(0,p.yW)(t.size*d)} / `:void 0,(0,p.yW)(t.size)),!v&&!c&&a.ZP.createElement("div",{className:"meta",dir:P?"rtl":void 0},a.ZP.createElement("span",{className:"duration",dir:"auto"},(0,m.k9)(n)),g&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("span",{className:"bullet"},"•"),a.ZP.createElement("span",{className:"performer",dir:"auto",title:g},(0,Z.Z)(g))),Boolean(l)&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("span",{className:"bullet"},"•"),a.ZP.createElement(w.Z,{className:"date",onClick:u},(0,m.ZK)(e,1e3*l,!0)))))}(me,re,Le,xe,Ae,Ne,de,F||_e,O,ze,J?Qe:void 0),R===i.Cr.SharedMedia&&(oe||se)&&st(),(R===i.Cr.Inline||Ee)&&oe&&function(e,t,n,o,s,r,c,d,u,h,p,Z){return a.ZP.createElement("div",{className:"content"},a.ZP.createElement("div",{className:"waveform-wrapper"},a.ZP.createElement("div",{className:"waveform",draggable:!1,ref:t},a.ZP.createElement("canvas",{ref:n})),h&&a.ZP.createElement(S.Z,{onClick:()=>{(d||u)&&p?p(!c):r||h()}},a.ZP.createElement("i",{className:(0,l.Z)("transcribe-icon","icon",d||u?"icon-down":"icon-transcribe",(d||u)&&!c&&"transcribe-shown")}),r&&a.ZP.createElement("svg",{viewBox:"0 0 32 24",className:"loading-svg"},a.ZP.createElement("rect",{className:"loading-rect",fill:"transparent",width:"32",height:"24","stroke-width":"3","stroke-linejoin":"round",rx:"6",ry:"6",stroke:"var(--accent-color)","stroke-dashoffset":"1","stroke-dasharray":"32,68"})))),a.ZP.createElement("p",{className:(0,l.Z)("voice-duration",Z!==i.Cr.OneTimeModal&&s&&"unread"),dir:"auto"},0===o||1===o?(0,m.k9)(e.duration):(0,m.k9)(e.duration*o)))}(oe,de,Fe,Pe?Be:Ae,ie,U,j,_,V,H?et:void 0,q,R))}))},65351:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(46752),s=n(59107),i=n(70172);const r={root:"kXs18Nmi","size-micro":"bnYA0Wm9",sizeMicro:"bnYA0Wm9","size-mini":"ZGpPX4Wb",sizeMini:"ZGpPX4Wb","size-tiny":"ufyZRVf5",sizeTiny:"ufyZRVf5","size-small":"UA2exR6e",sizeSmall:"UA2exR6e","size-small-mobile":"PTbjjZjF",sizeSmallMobile:"PTbjjZjF","size-medium":"jncPG8PA",sizeMedium:"jncPG8PA","size-large":"pd70AQAO",sizeLarge:"pd70AQAO","size-jumbo":"KpwfP5mr",sizeJumbo:"KpwfP5mr",avatar:"XND8fhC1"},c=(0,a.X$)((({peers:e,size:t,className:n})=>{const c=(0,s.Z)();return a.ZP.createElement("div",{className:(0,o.Z)(n,r.root,r[`size-${t}`]),dir:c.isRtl?"rtl":"ltr"},e?.map((e=>a.ZP.createElement(i.Z,{size:t,peer:e,className:r.avatar}))))}))},70180:(e,t,n)=>{n.d(t,{Z:()=>E});var a=n(60748),o=n(33555),s=n(59187),i=n(83716),r=n(4463),c=n(7054),l=n(64319),d=n(6272),m=n(69118),u=n(3858),h=n(32340),p=n(274),Z=n(59107),g=n(25190),f=n(31876),v=n(83321);const P=(0,m.Ds)((e=>e()),500,!1),E=(0,a.X$)((0,o.c$)(((e,{chatOrUserId:t,isSavedDialog:n})=>{const{countryList:{phoneCodes:a}}=e,o=t?(0,c.Z1J)(e,t):void 0,s=(0,r.YC)(t)?(0,c.dyD)(e,t):void 0,i=o?.isForum,l=o&&(0,r.i4)(o,(0,c.dZI)(e),(0,c.NJL)(e)),{threadId:d}=(0,c.Btg)(e)||{},m=i?Number(d):void 0,u=o?(0,c.x67)(e,o.id)?.inviteLink:void 0;let h=s?(0,c.ccz)(e,s.id)?.bio:void 0;return!h&&o&&(h=(0,c.x67)(e,o.id)?.about),{phoneCodeList:a,chat:o,user:s,canInviteUsers:o&&!s&&(!(0,r.eA)(o)&&!(0,r.Mg)(o,"inviteUsers")||(0,r.VE)(o,"inviteUsers")),isMuted:l,topicId:m,chatInviteLink:u,description:h,topicLink:m?(0,c.Pn)(e,t,m):void 0,hasSavedMessages:!n&&e.chats.listIds.saved?.includes(t)}}))((({chatOrUserId:e,user:t,chat:n,isInSettings:c,canInviteUsers:m,isMuted:E,phoneCodeList:y,topicId:b,description:C,chatInviteLink:S,topicLink:w,hasSavedMessages:I})=>{const{loadFullUser:N,showNotification:M,updateChatMutedState:k,updateTopicMutedState:T,loadPeerStories:x,openSavedDialog:A}=(0,o.Sv)(),{id:R,usernames:O,phoneNumber:L,isSelf:B}=t||{},{id:D,usernames:$}=n||{},F=R||D,U=(0,Z.Z)(),[j,_]=(0,a.eJ)(!E);(0,a.d4)((()=>{_(!E)}),[E]),(0,a.d4)((()=>{R&&N({userId:R})}),[R]),(0,p.Z)((([e])=>{F&&e!==F&&(t||n&&(0,r.eA)(n))&&x({peerId:F})}),[F,n,t]);const V=Boolean(b&&b!==s._f),z=n&&(0,r.eA)(n)||t?.isPremium,H=(0,a.Ye)((()=>{const e=O?.filter((e=>e.isActive));return e?.length?e:void 0}),[O]),W=(0,a.Ye)((()=>{const e=t?void 0:$?.filter((e=>e.isActive));return e?.length?e:void 0}),[$,t]),q=(0,a.Ye)((()=>{if(n)return V?w:(0,r.hu)(n)||S}),[n,V,w,S]),G=(0,g.Z)((()=>{_((e=>{const t=!e;return P((()=>{V?T({chatId:D,topicId:b,isMuted:!t}):k({chatId:D,isMuted:!t})})),t}))})),Y=(0,g.Z)((()=>{A({chatId:e})}));if(!n||n.isRestricted||B&&!c)return;function X(e,t){(0,l.TE)(e),M({message:`${t} was copied`})}const K=L&&(0,d.WZ)(y,L);function J(e,t){const[n,...o]=e,s=o.length?U("UsernameAlso","%USERNAMES%").split("%").map((e=>"USERNAMES"===e?a.ZP.createElement(a.ZP.Fragment,null,o.map((({username:e},n)=>{const o=t?`${i.zHP}${e}`:`@${e}`;return a.ZP.createElement(a.ZP.Fragment,null,n>0?", ":"",a.ZP.createElement("a",{key:e,href:`${i.zHP}${e}`,onClick:e=>{(0,u.Z)(e),X(o,U(t?"Link":"Username"))},className:"text-entity-link username-link"},`@${e}`))}))):e)):void 0,r=t?`t.me/${n.username}`:n.username,c=t?`${i.zHP}${n.username}`:`@${n.username}`;return a.ZP.createElement(f.Z,{icon:t?"link":"mention",multiline:!0,narrow:!0,ripple:!0,onClick:()=>X(c,U(t?"Link":"Username"))},a.ZP.createElement("span",{className:"title",dir:"auto"},r),a.ZP.createElement("span",{className:"subtitle"},s&&a.ZP.createElement("span",{className:"other-usernames"},s),U(t?"Link":"Username")))}return a.ZP.createElement("div",{className:"ChatExtra"},K&&Boolean(K.length)&&a.ZP.createElement(f.Z,{icon:"phone",multiline:!0,narrow:!0,ripple:!0,onClick:()=>X(K,U("Phone"))},a.ZP.createElement("span",{className:"title",dir:"auto"},K),a.ZP.createElement("span",{className:"subtitle"},U("Phone"))),H&&J(H),C&&Boolean(C.length)&&a.ZP.createElement(f.Z,{icon:"info",multiline:!0,narrow:!0,isStatic:!0},a.ZP.createElement("span",{className:"title word-break allow-selection",dir:"auto"},(0,h.Z)(C,["br",z?"links":"tg_links","emoji"])),a.ZP.createElement("span",{className:"subtitle"},U(R?"UserBio":"Info"))),W&&!V&&J(W,!0),(!W&&m||V)&&q&&a.ZP.createElement(f.Z,{icon:"link",multiline:!0,narrow:!0,ripple:!0,onClick:()=>X(q,U("SetUrlPlaceholder"))},a.ZP.createElement("div",{className:"title"},q),a.ZP.createElement("span",{className:"subtitle"},U("SetUrlPlaceholder"))),!c&&a.ZP.createElement(f.Z,{icon:"unmute",ripple:!0,onClick:G},a.ZP.createElement("span",null,U("Notifications")),a.ZP.createElement(v.Z,{id:"group-notifications",label:R?"Toggle User Notifications":"Toggle Chat Notifications",checked:j,inactive:!0})),I&&!c&&a.ZP.createElement(f.Z,{icon:"saved-messages",ripple:!0,onClick:Y},a.ZP.createElement("span",null,U("SavedMessagesTab"))))})))},54210:(e,t,n)=>{n.d(t,{Z:()=>Rt});var a=n(60748),o=n(33555),s=n(59187),i=n(83716),r=n(57710),c=n(4463),l=n(7054),d=n(9211),m=n(46752),u=n(790),h=n(82850),p=n(65723),Z=n(70735),g=n(89455),f=n(41098),v=n(82267),P=n(97184),E=n(43858);let y;function b(e){y.focus(),e.focus()}P.cj&&(y=document.createElement("input"),y.classList.add("for-ios-autocapitalization-fix"),document.body.appendChild(y));var C=n(76087);const S=/id="docs-internal-guid/i,w={BOLD:"700",ITALIC:"italic",UNDERLINE:"underline",STRIKETHROUGH:"line-through",SUPERSCRIPT:"super",SUBSCRIPT:"sub"},I={ANCHOR:"a",BOLD:"strong",ITALIC:"em",UNDERLINE:"u",BLOCKQUOTE:"blockquote",STRIKETHROUGH:"del",SUPERSCRIPT:"sup",SUBSCRIPT:"sub"},N=["H1","H2","H3","H4","H5","H6"];function M(e){return(new DOMParser).parseFromString(e,"text/html").body}function k(e,t){const n=document.createElement(I.ANCHOR);return n.href=t,n.appendChild(e.cloneNode(!0)),n}function T(e,t){const n=document.createElement(t);return n.appendChild(e.cloneNode(!0)),n}function x(e,t){let n=t.cloneNode(!0);return e?(e.style&&e.style.fontWeight===w.BOLD&&(n=T(n,I.BOLD)),e.style&&e.style.fontStyle===w.ITALIC&&(n=T(n,I.ITALIC)),e.style&&e.style.textDecoration===w.UNDERLINE&&(n=T(n,I.UNDERLINE)),e.style&&e.style.textDecoration===w.STRIKETHROUGH&&(n=T(n,I.STRIKETHROUGH)),e.style&&e.style.verticalAlign===w.SUPERSCRIPT&&(n=T(n,I.SUPERSCRIPT)),e.style&&e.style.verticalAlign===w.SUBSCRIPT&&(n=T(n,I.SUBSCRIPT)),n):n}function A(e){const t=e.cloneNode(!0);let n=document.createTextNode(t.textContent||""),a=t;return"A"===t.nodeName&&(n=k(n,t.href),"style"in t.childNodes[0]&&Boolean(t.childNodes[0].style)&&(a=t.childNodes[0])),n=x(a,n),n}function R(e){if(e.childNodes&&(e.childNodes.length<=1||"OL"===e.nodeName||"UL"===e.nodeName)){let t,n=document.createTextNode(e.textContent||"");if("UL"===e.nodeName||"OL"===e.nodeName||"LI"===e.nodeName){t=document.createElement(e.nodeName),n=document.createDocumentFragment();const a=[];for(let t=0;t<e.childNodes.length;t++)a.push(...R(e.childNodes[t]));a.map((e=>n.appendChild(e)))}else-1!==N.indexOf(e.nodeName)?(t=document.createElement(e.nodeName),n=A(e.childNodes[0])):"P"===e.nodeName?(t=document.createElement("p"),n=function(e){const t=e.cloneNode(!0);let n=document.createTextNode(t.textContent||""),a=document.createTextNode("");return"style"in t.childNodes[0]&&Boolean(t.childNodes[0].style)&&(a=t.childNodes[0]),t.childNodes[0]&&"A"===t.childNodes[0].nodeName&&(n=k(n.cloneNode(!0),t.childNodes[0].href),a=t.childNodes[0].childNodes[0]),n=x(a,n),n}(e)):"BR"===e.nodeName?n=e:(t=document.createElement("span"),n=A(e));return t?(t.appendChild(n),[t]):[e.cloneNode(!0)]}if(e.childNodes){const t=[];for(let n=0;n<e.childNodes.length;n++)t.push(...R(e.childNodes[n]));return t}return[e]}function O(e){return 8!==e.nodeType}const L=/<style>(.*?)<\/style>/gs;var B=n(44139),D=n(96391),$=n(33780),F=n(32340),U=n(4809),j=n(96557),_=n(49488),V=n(17240),z=n(86203),H=n(274),W=n(60706),q=n(69156),G=n(59107),Y=n(25190),X=n(87204),K=n(33057),J=n(56389),Q=n(31212),ee=n(33799),te=n(70971),ne=n(34446),ae=n(52400),oe=n(11309),se=n(71790);const ie=/^\/([\w@]{1,32})?$/i;var re=n(56266),ce=n(21262);const le=(e,t,n,r,l,d,m)=>{const{showNotification:u}=(0,o.Sv)(),h=(0,G.Z)();(0,a.d4)((()=>{if(e)return document.addEventListener("paste",a,!1),()=>{document.removeEventListener("paste",a,!1)};async function a(e){if(!e.clipboardData)return;const a=document.activeElement;if(a&&![i.R2F,i.nYf,i.Cic].includes(a.id))return;const o=e.clipboardData.getData("text").substring(0,4096),p=e.clipboardData.getData("text/html");let Z=p?(0,g.ZP)(function(e){let t=document.createElement("div");try{e=(n=e).match(S)?function(e){const t=document.createElement("body"),n=e.childNodes,a=Array.from(n).filter(O),o=[];for(const e of a)o.push(...R(e));for(let e=0;e<o.length;e++)t.appendChild(o[e].cloneNode(!0));return t}(M(n.replace(/(\r\n|\n|\r)/,""))).innerHTML:M(n.replace(/(\r\n|\n|\r)/,"")).innerHTML}catch(e){i.eMD&&console.error(e)}var n;t.innerHTML=e.replace(/\u00a0/g," ").replace(L,"");const a=t.querySelectorAll(".text-content");return a.length&&(t=a[a.length-1]),Array.from(t.getElementsByTagName("*")).forEach((e=>{if(e instanceof HTMLElement)switch(e.removeAttribute("style"),"BR"===e.tagName&&e.replaceWith("\n"),"P"===e.tagName&&e.appendChild(document.createTextNode("\n")),"IMG"!==e.tagName||e.dataset.entityType||e.replaceWith(e.getAttribute("alt")||""),e.dataset.ignoreOnPaste&&e.remove(),g.xe[e.tagName]&&e.setAttribute("data-entity-type",g.xe[e.tagName]),e.dataset.entityType||e.textContent!==e.innerText||e.replaceWith(e.textContent),e.dataset.alt&&e.setAttribute("alt",e.dataset.alt),e.dataset.entityType){case s.Vv.MentionName:e.replaceWith(e.textContent||"");break;case s.Vv.CustomEmoji:e.textContent=e.dataset.alt||""}else e.remove()})),t.innerHTML.trimEnd()}(p),void 0,!0):void 0;Z&&(0,re.Lo)(Z)&&d&&(Z=(0,re.If)(Z),m?.());const{items:f}=e.clipboardData;let v=[];if(e.preventDefault(),f.length>0&&(v=await(0,ce.Z)(f),l&&(v=v?.slice(0,1))),!v?.length&&!o)return;const P=Z?.entities?.length?Z:{text:o};let E=!1;try{E="urn:schemas-microsoft-com:office:word"===(new DOMParser).parseFromString(p,"text/html").documentElement.getAttribute("xmlns:w")}catch(e){}const y=P&&P.text;let b=v?.length&&!E;const w=v?await Promise.all(v.map((e=>(0,C.Z)(e.name,e)))):[],I=l&&w?.length&&(0,c.Gy)(l,w[0])||Boolean(y),N=(0,c.kT)(w[0]),k=l&&l?.groupedId;l&&N?u({message:h(k?"lng_edit_media_album_error":"lng_edit_media_invalid_file")}):!k||(b=I,b)?(b&&n(l?w:e=>e.concat(w)),y&&(b?r(P):t(P,a?.id))):u({message:h("lng_edit_media_album_error")})}}),[t,l,n,e,d,m,r,h])};var de=n(60130),me=n(72645),ue=n(88957),he=n(13819),pe=n(20797);let Ze=!1;const ge=new Set([s.Vv.TextUrl,s.Vv.Url]);var fe=n(28353),ve=n(16580);const Pe=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+(.*)/is,Ee=/^@([a-z0-9_]{1,32})[\u00A0\u0020]+\n{2,}/i,ye={username:"",query:"",canShowHelp:!1,usernameLowered:""},be=document.createElement("div");const Ce=(0,ve.Z)(((e,t,n)=>({username:e,query:t,canShowHelp:n,usernameLowered:e.toLowerCase()})));var Se=n(29295),we=n(33681),Ie=n(9668);const Ne=new RegExp(`^${i.t8f.source}$`,"g");var Me=n(23989);const ke={encoderPath:new URL(n(68973),n.b).href,reuseWorker:!0},Te={type:"audio/ogg"};let xe,Ae,Re;async function Oe(){return xe||(xe=n.e(1161).then(n.t.bind(n,1161,23)),Ae=(await xe).default,Re=new Ae(ke)),xe}async function Le(e){await async function(){await Oe(),await Re.start()}();const t=Date.now();let n;const a=[],o=[];Re.ondataavailable=e=>{a.push(e)};const s=function(t,n){const a=t.sourceNode,s=a.context.createAnalyser();s.fftSize=64,a.connect(s);const i=s.frequencyBinCount,c=new Uint8Array(i);let l=!1;return function t(){if(l)return;s.getByteFrequencyData(c);const n=c.reduce(((e,t)=>e+t),0)/i/255;(t=>{o.push(255*t),e(t)})(n<.1?0:n),(0,r.i$)(t)}(),()=>{l=!0}}(Re);return{stop:()=>new Promise(((e,i)=>{Re.onstop=()=>{e({blob:new Blob(a,Te),duration:Math.round(((n||Date.now())-t)/1e3),waveform:o})},Re.onerror=i;const r=Math.max(0,t+1e3-Date.now());setTimeout((()=>{Re.stop(),s()}),r)})),pause:()=>{const e=Math.max(0,t+1e3-Date.now());setTimeout((()=>{Re.pause(),n=Date.now(),s()}),e)}}}var Be=n(99203),De=n(48778);const $e=e=>{const{attachments:t}=e,n=(0,De.Z)(Be.gl.Extra,"AttachmentModal",!t.length);return n?a.ZP.createElement(n,e):void 0};var Fe=n(30879),Ue=n(71394),je=n(85655),_e=n(56503),Ve=n(65979),ze=n(52328),He=n(58964),We=n(43521),qe=n(42797),Ge=n(6202);const Ye="VGmPJoga",Xe=/#fff/gi,Ke=(0,a.X$)((({icon:e,theme:t})=>{const{isTouchScreen:n}=(0,qe.ZP)(),o=(0,Ge.Z)((0,c.ym)(e),!1,s.IU.Text),i=(0,a.Ye)((()=>{if(!o)return"";const e="dark"===t?"rgb(170, 170, 170)":"rgb(112, 117, 121)",n=o.replace(Xe,e),a=(new DOMParser).parseFromString(n,"image/svg+xml");return a.querySelectorAll("path").forEach((t=>{t.style.stroke=e,t.style.strokeWidth="0.5px"})),`data:image/svg+xml;utf8,${a.documentElement.outerHTML}`}),[o,t]);return a.ZP.createElement("i",{className:(0,m.Z)("mklnEg0s","icon",!n&&Ye)},a.ZP.createElement("img",{src:i,alt:"",className:(0,m.Z)("tT8KQwg0",!n&&Ye),draggable:!1}))})),Je=(0,a.X$)((({bot:e,theme:t,chatId:n,threadId:s,isInSideMenu:i,canShowNew:r,onMenuOpened:c,onMenuClosed:l})=>{const{callAttachBot:d,toggleAttachBot:m}=(0,o.Sv)(),u=(0,G.Z)(),h=(0,a.Ye)((()=>e.icons.find((({name:e})=>"default_static"===e))?.document),[e.icons]),[p,Z,g]=(0,W.Z)(),[f,v]=(0,a.eJ)(void 0),P=(0,Y.Z)((e=>{e.preventDefault();const t=e.currentTarget.getBoundingClientRect();v({x:t.right,y:t.bottom}),c(),Z()})),E=(0,Y.Z)((()=>{d(i?{bot:e,isFromSideMenu:!0}:{bot:e,chatId:n,threadId:s})})),y=(0,Y.Z)((()=>{g(),l()})),b=(0,Y.Z)((()=>{v(void 0)})),C=(0,Y.Z)((()=>{m({botId:e.id,isEnabled:!1})}));return a.ZP.createElement(He.Z,{key:e.id,customIcon:h&&a.ZP.createElement(Ke,{icon:h,theme:t}),icon:h?void 0:"bots",onClick:E,onContextMenu:P},e.shortName,r&&e.isDisclaimerNeeded&&a.ZP.createElement("span",{className:"menu-item-badge"},u("New")),f&&a.ZP.createElement(ze.Z,{isOpen:p,positionX:"right",style:`left: ${f.x}px;top: ${f.y}px;`,className:"bot-attach-context-menu",autoClose:!0,withPortal:!0,onClose:y,onCloseAnimationEnd:b},a.ZP.createElement(He.Z,{icon:"stop",destructive:!0,onClick:C},u("WebApp.RemoveBot"))))})),Qe=(0,a.X$)((({chatId:e,threadId:t,isButtonVisible:n,canAttachMedia:o,canAttachPolls:s,canSendPhotos:r,canSendVideos:l,canSendDocuments:d,canSendAudios:m,attachBots:u,peerType:h,isScheduled:p,isChatWithBot:Z,handleSendCrypto:g,handleSendCryptoViaLink:f,handleSendNTFViaLink:v,handleSendNFT:E,handleCreatePOAP:y,theme:b,shouldCollectDebugLogs:C,onFileSelect:S,onMenuOpen:w,onMenuClose:I,onPollCreate:N,hasReplaceableMedia:M,editingMessage:k})=>{const[T,x,A]=(0,W.Z)(),[R,O,L]=(0,_e.Z)(T,A),B=r&&l,D=r||l,[$,F,U]=(0,W.Z)(),j=T||$,_=(k&&k?.groupedId&&Boolean((0,c.O$)(k)||(0,c.F$)(k)||Boolean((0,c.b7)(k)||(0,c.Cg)(k))),k&&k?.groupedId&&Boolean((0,c.oP)(k)||(0,c.kd)(k)||(0,c.aE)(k)));(0,a.d4)((()=>{T&&L()}),[T,L]),(0,a.d4)((()=>{j?w():I()}),[j,I,w]);const V=(0,Y.Z)((()=>{T?A():x()})),z=(0,Y.Z)(((e,t)=>{const{files:n}=e.target,a=(0,Ue.ox)(n);a?.length&&S(a,t)})),H=(0,Y.Z)((()=>{(0,je.g)(Array.from(B?i.dII:r?i.oGt:i.wGh).join(","),(e=>z(e,!0)))})),q=((0,Y.Z)((()=>{(0,je.g)(!d&&m?Array.from(i.e74).join(","):"*",(e=>z(e,!1)))})),(0,Y.Z)((()=>{const e=new File([(0,Fe.aZ)()],i.Wpe,{type:"text/plain"});S([e])}))),X=(0,a.Ye)((()=>u?Object.values(u).filter((t=>!(!h||!t.isForAttachMenu)&&(!("bots"!==h||t.id!==e||!t.attachMenuPeerTypes.includes("self"))||t.attachMenuPeerTypes.includes(h)))):void 0),[u,e,h]),K=(0,G.Z)();if(n)return a.ZP.createElement("div",{className:"AttachMenu"},k&&M?a.ZP.createElement(We.Z,{id:"replace-menu-button",className:T?"AttachMenu--button activated":"AttachMenu--button",round:!0,color:"translucent",onActivate:V,ariaLabel:"Replace an attachment",ariaControls:"replace-menu-controls",hasPopup:!0},a.ZP.createElement(Ve.Z,{name:"replace"})):a.ZP.createElement(We.Z,{id:"attach-menu-button",disabled:Boolean(k),className:T?"AttachMenu--button activated":"AttachMenu--button",round:!0,color:"translucent",onActivate:V,ariaLabel:"Add an attachment",ariaControls:"attach-menu-controls",hasPopup:!0},a.ZP.createElement(Ve.Z,{name:"attach"})),a.ZP.createElement(ze.Z,{id:"attach-menu-controls",isOpen:j,autoClose:!0,positionX:"right",positionY:"bottom",onClose:A,className:"AttachMenu--menu fluid",onCloseAnimationEnd:A,onMouseEnter:P.$b?void 0:R,onMouseLeave:P.$b?void 0:O,noCloseOnBackdrop:!P.$b,ariaLabelledBy:"attach-menu-button"},!o&&a.ZP.createElement(He.Z,{className:"media-disabled",disabled:!0},"Posting media content is not allowed in this group."),o&&a.ZP.createElement(a.ZP.Fragment,null,D&&!_&&a.ZP.createElement(He.Z,{icon:"photo",onClick:H},K(B?"AttachmentMenu.PhotoOrVideo":r?"InputAttach.Popover.Photo":"InputAttach.Popover.Video")),d&&C&&a.ZP.createElement(He.Z,{icon:"bug",onClick:q},K("DebugSendLogs"))),!Z&&Number(e)>=0&&a.ZP.createElement(He.Z,{icon:"lock",className:"margin-left-1px",customIcon:a.ZP.createElement("img",{className:"icon",src:"./wallet_20px.svg",alt:""}),onClick:g},K("Send Crypto")),s&&!k&&a.ZP.createElement(He.Z,{icon:"poll",onClick:N},K("Poll")),!Z&&Number(e)>=0&&a.ZP.createElement(He.Z,{icon:"permissions",className:"margin-left-1px",onClick:E,customIcon:a.ZP.createElement("img",{className:"icon",src:"./hexagon.svg",alt:"",width:20,height:20})},K("Send NFT")),!Z&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(He.Z,{icon:"link",className:"margin-left-1px",onClick:f},K("Send Crypto via link")),a.ZP.createElement(He.Z,{icon:"link",className:"margin-left-1px",onClick:v},K("Send NFT via link"))),!k&&!M&&!p&&X?.map((n=>a.ZP.createElement(Je,{bot:n,chatId:e,threadId:t,theme:b,onMenuOpened:F,onMenuClosed:U})))))})),et=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"BotCommandMenu",!t);return n?a.ZP.createElement(n,e):void 0},tt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"BotCommandTooltip",!t);return n?a.ZP.createElement(n,e):void 0};var nt=n(231);const at=(0,a.X$)((0,o.c$)(((e,{messageId:t})=>{const{chatId:n}=(0,l.Btg)(e)||{};return n?{message:(0,l.hjO)(e,n,t)}:{}}))((({isOpen:e,message:t,onClose:n})=>{const{clickBotInlineButton:s}=(0,o.Sv)(),[i,r]=(0,_e.Z)(e,n),{isKeyboardSingleUse:c}=t||{};if(t&&t.keyboardButtons)return a.ZP.createElement(ze.Z,{isOpen:e,autoClose:c,positionX:"right",positionY:"bottom",onClose:n,className:"BotKeyboardMenu",onCloseAnimationEnd:n,onMouseEnter:P.$b?void 0:i,onMouseLeave:P.$b?void 0:r,noCompact:!0},a.ZP.createElement("div",{className:"content custom-scroll"},t.keyboardButtons.map((e=>a.ZP.createElement("div",{className:"row"},e.map((e=>a.ZP.createElement(nt.Z,{ripple:!0,disabled:"unsupported"===e.type,onClick:()=>s({messageId:t.id,button:e})},e.text))))))))}))),ot=(0,a.X$)((({isOpen:e,onClick:t,text:n,isDisabled:o})=>{const s=(0,a.sO)(null);return(0,a.d4)((()=>{const e=s.current;if(!e)return;const t=e.scrollWidth+1;e.closest(".Composer").style.setProperty("--bot-menu-text-width",`${t}px`)}),[e,n]),(0,a.d4)((()=>{const e=s.current;if(!e)return;const t=e.closest(".Composer");return()=>{t.style.removeProperty("--bot-menu-text-width")}}),[]),a.ZP.createElement(nt.Z,{className:(0,m.Z)("bot-menu",e&&"open"),round:!0,color:"translucent",disabled:o,onClick:t,ariaLabel:"Open bot command keyboard"},a.ZP.createElement("i",{className:(0,m.Z)("bot-menu-icon","icon","icon-webapp",e&&"open")}),a.ZP.createElement("span",{ref:s,className:"bot-menu-text"},n))}));var st=n(18360),it=n(12644),rt=n(17891),ct=n(32683),lt=n(66902);const dt=(0,a.X$)((0,o.c$)(((e,{shouldForceShowEditing:t})=>{const{chatId:n,threadId:a,type:o}=(0,l.Btg)(e)||{};if(!n||!a||!o)return{};const{forwardMessages:{fromChatId:s,toChatId:i,messageIds:r,noAuthors:c,noCaptions:d}}=(0,l.jUK)(e),m="scheduled"===o?(0,l.nBP)(e,n):(0,l._$9)(e,n,a),u=(0,l.FOo)(e),h=i===n,p=r?.map((t=>(0,l.hjO)(e,s,t))),Z=(0,l.Mst)(e,n,a),g=Z?.replyInfo;let f,v;if(g&&!t?f=(0,l.hjO)(e,g.replyToPeerId||n,g.replyToMsgId):m?f=(0,l.kKD)(e,n,a,o):h&&1===r.length&&(f=p?.[0]),g&&f&&!t){const{forwardInfo:t}=f,a=(0,l.FM1)(e,n);t&&(t.isChannelPost||a)&&(v=(0,l.cve)(e,f)),v||t?.hiddenUserName&&!Boolean(g.quoteText)||(v=(0,l.Urc)(e,f))}else h?(f&&(v=(0,l.cve)(e,f),v||(v=(0,l.Urc)(e,f))),v||(v=(0,l.RGZ)(e,s))):m&&f&&(v=(0,l.Urc)(e,f));const P=p?.some((e=>e?.content.text&&Object.keys(e.content).length>1)),E=h&&1===r.length&&Boolean(f?.content.storyData),y=g?.replyToMsgId===a&&!g.replyToPeerId;return{replyInfo:g,editingId:m,message:f,sender:v,shouldAnimate:u,forwardedMessagesCount:h?r.length:void 0,noAuthors:c,noCaptions:d,forwardsHaveCaptions:P,isCurrentUserPremium:(0,l.wVz)(e),isContextMenuDisabled:E,isReplyToDiscussion:y}}))((({replyInfo:e,editingId:t,message:n,sender:s,shouldAnimate:i,forwardedMessagesCount:r,noAuthors:l,noCaptions:d,forwardsHaveCaptions:u,shouldForceShowEditing:h,isCurrentUserPremium:p,isContextMenuDisabled:Z,isReplyToDiscussion:g,onClear:f})=>{const{resetDraftReplyInfo:v,setEditingId:P,focusMessage:E,changeForwardRecipient:y,setForwardNoAuthors:b,setForwardNoCaptions:C,exitForwardMode:S}=(0,o.Sv)(),w=(0,a.sO)(null),I=(0,G.Z)(),N="topicCreate"===n?.content.action?.type,M=Boolean(r),k=Boolean((e||t)&&n||s&&r),T=(0,rt.Z)([k,M],k&&M?300:void 0),{shouldRender:x,transitionClassNames:A}=(0,Q.Z)(T&&k&&!N&&!g,void 0,!i,void 0,!i),R=(0,Y.Z)((()=>{e&&!h?v():t?P({messageId:void 0}):r&&S(),f?.()}));(0,a.d4)((()=>k?(0,Me.Z)(R):void 0),[k,R]);const O=(0,Y.Z)((()=>{M||E({chatId:n.chatId,messageId:n.id,noForumTopicPanel:!0})})),L=(0,Y.Z)((e=>{e.stopPropagation(),R()})),B=(0,Y.Z)((()=>{y()})),{isContextMenuOpen:D,contextMenuPosition:F,handleContextMenu:U,handleContextMenuClose:j,handleContextMenuHide:_}=(0,V.Z)(w),z=(0,Y.Z)((()=>w.current)),H=(0,Y.Z)((()=>w.current)),W=(0,Y.Z)((()=>w.current.querySelector(".forward-context-menu .bubble"))),{positionX:q,positionY:X,transformOriginX:K,transformOriginY:J,style:ee}=(0,it.Z)(F,z,H,W);(0,a.d4)((()=>{x||j()}),[j,x]);const te=(0,m.Z)("ComposerEmbeddedMessage",A),ne=(0,st.Z)(s,!0),ae=(0,m.Z)("ComposerEmbeddedMessage_inner",(0,$.D)(ne)),oe=e&&!h,se=(0,a.Ye)((()=>oe?"reply":t?"edit":M?"forward":void 0),[t,M,oe]),ie=r&&r>1?I("ForwardedMessageCount",r):void 0,re=(0,a.Ye)((()=>{if(!n||!M||!n.content.text||!l||p)return n;const e=(0,c.If)(n.content.text);return{...n,content:{...n.content,text:e}}}),[p,M,n,l]),ce=(0,st.Z)(se,!0);if(x)return a.ZP.createElement("div",{className:te,ref:w,onContextMenu:U,onClick:U},a.ZP.createElement("div",{className:ae},a.ZP.createElement("div",{className:"embedded-left-icon"},ce&&a.ZP.createElement(Ve.Z,{name:ce}),Boolean(e?.quoteText)&&a.ZP.createElement(Ve.Z,{name:"quote",className:"quote-reply"})),a.ZP.createElement(ct.m,{isOpen:k,className:"inside-input",replyInfo:e,isInComposer:!0,message:re,sender:l?void 0:s,customText:ie,title:t&&!oe?I("EditMessage"):l?I("HiddenSendersNameDescription"):void 0,onClick:O}),a.ZP.createElement(nt.Z,{className:"embedded-cancel",round:!0,faded:!0,color:"translucent",ariaLabel:I("Cancel"),onClick:L},a.ZP.createElement("i",{className:"icon icon-close"})),M&&!Z&&a.ZP.createElement(ze.Z,{isOpen:D,transformOriginX:K,transformOriginY:J,positionX:q,positionY:X,style:ee,className:"forward-context-menu",onClose:j,onCloseAnimationEnd:_},a.ZP.createElement(He.Z,{icon:l?void 0:"message-succeeded",customIcon:l?a.ZP.createElement("i",{className:"icon icon-placeholder"}):void 0,onClick:()=>b({noAuthors:!1})},I(r>1?"ShowSenderNames":"ShowSendersName")),a.ZP.createElement(He.Z,{icon:l?"message-succeeded":void 0,customIcon:l?void 0:a.ZP.createElement("i",{className:"icon icon-placeholder"}),onClick:()=>b({noAuthors:!0})},I(r>1?"HideSenderNames":"HideSendersName")),u&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(lt.Z,null),a.ZP.createElement(He.Z,{icon:d?void 0:"message-succeeded",customIcon:d?a.ZP.createElement("i",{className:"icon icon-placeholder"}):void 0,onClick:()=>C({noCaptions:!1})},I(r>1?"Conversation.ForwardOptions.ShowCaption":"ShowCaption")),a.ZP.createElement(He.Z,{icon:d?"message-succeeded":void 0,customIcon:d?void 0:a.ZP.createElement("i",{className:"icon icon-placeholder"}),onClick:()=>C({noCaptions:!0})},I(r>1?"Conversation.ForwardOptions.HideCaption":"HideCaption"))),a.ZP.createElement(lt.Z,null),a.ZP.createElement(He.Z,{icon:"replace",onClick:B},I("ChangeRecipient")))))})));var mt=n(93219),ut=n(67146),ht=n(12420);const pt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"DropArea",!t);return n?a.ZP.createElement(n,e):void 0};var Zt=n(19830);const gt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"InlineBotTooltip",!t);return n?a.ZP.createElement(n,e):void 0},ft=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"MentionTooltip",!t);return n?a.ZP.createElement(n,e):void 0};var vt=n(76609);const Pt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"PollModal",!t);return n?a.ZP.createElement(n,e):void 0},Et=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"SendAsMenu",!t);return n?a.ZP.createElement(n,e):void 0},yt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"StickerTooltip",!t);return n?a.ZP.createElement(n,e):void 0};var bt=n(23522),Ct=n(54659);const St=new RegExp(i.FM6,"i"),wt=(0,a.X$)((0,o.c$)(((e,{chatId:t,threadId:n})=>{const a=(0,l.tVX)(e,t,n);return{theme:(0,l.Puy)(e),webPagePreview:(0,l.jUK)(e).webPagePreview,noWebPage:a}}))((({chatId:e,threadId:t,getHtml:n,isDisabled:i,webPagePreview:r,noWebPage:c,theme:l})=>{const{loadWebPagePreview:d,clearWebPagePreview:u,toggleMessageWebPage:h}=(0,o.Sv)(),p=(0,a.sO)(),Z=(0,oe.iD)((()=>{const e=(0,g.ZP)(n()),t=e.entities?.find((e=>e.type===s.Vv.TextUrl));return p.current=e,t?.url||e.text.match(St)?.[0]}),[n],300,!0),f=(0,se.Z)(Z,[Z,n],!0);(0,a.d4)((()=>{const n=f(),a=p.current;n?d({text:a}):(u(),h({chatId:e,threadId:t}))}),[f,e,t]),(0,ne.Z)((()=>{u(),h({chatId:e,threadId:t})}),[e,u,t,h]);const v=(0,z.Z)((()=>Boolean(r&&n()&&!c&&!i)),[i,n,c,r]),{shouldRender:P,transitionClassNames:E}=(0,Q.Z)(v),y=(0,st.Z)(r,!0),b=(0,Y.Z)((()=>{h({chatId:e,threadId:t,noWebPage:!0})}));if(!P||!y)return;const{photo:C,...S}=y,w={content:{webPage:S}};return a.ZP.createElement("div",{className:(0,m.Z)("WebPagePreview",E)},a.ZP.createElement("div",{className:"WebPagePreview_inner"},a.ZP.createElement("div",{className:"WebPagePreview-left-icon"},a.ZP.createElement("i",{className:"icon icon-link"})),a.ZP.createElement(Ct.Z,{message:w,inPreview:!0,theme:l}),a.ZP.createElement(nt.Z,{className:"WebPagePreview-clear",round:!0,faded:!0,color:"translucent",ariaLabel:"Clear Webpage Preview",onClick:b},a.ZP.createElement("i",{className:"icon icon-close"}))))})));var It=n(96621),Nt=n(49204),Mt=n(70172);const kt=e=>{const{isOpen:t}=e,n=(0,De.Z)(Be.gl.Extra,"DeleteMessageModal",!t);return n?a.ZP.createElement(n,e):void 0};var Tt=n(36368),xt=function(e){return e.Send="send",e.Record="record",e.Edit="edit",e.Schedule="schedule",e.Forward="forward",e.SendOneTime="sendOneTime",e}(xt||{});let At;const Rt=(0,a.X$)((0,o.c$)(((e,{chatId:t,threadId:n,storyId:a,messageListType:o,isMobile:r,type:m})=>{const u=(0,l.Z1J)(e,t),h=t!==i.FVh?(0,l.kBx)(e,t):void 0,p=Boolean(h),Z=(0,l.FM1)(e,t),g=(0,c.YC)(t),f=p?(0,l.ccz)(e,h.id):void 0,v=g?void 0:(0,l.x67)(e,t),P=(p||!g)&&(0,l.FTG)(e,t,n),E=(0,l.qyA)(e,t,n),{language:y,shouldSuggestStickers:b,shouldSuggestCustomEmoji:C,shouldUpdateStickerSetOrder:S}=e.settings.byKey,w=e.emojiKeywords[i.pRL],I=y!==i.pRL?e.emojiKeywords[y]:void 0,N=P?P.id:void 0,M=N?(0,l.hjO)(e,t,N):void 0,{currentUserId:k}=e,T=(0,l.dyD)(e,k),x=v?v?.sendAsId||k:void 0,A=u?.sendAsPeerIds&&x&&(u.sendAsPeerIds.some((e=>e.id===x))?x:u?.adminRights?.anonymous?u?.id:void 0),R=A?(0,l.dyD)(e,A):void 0,O=!R&&A?(0,l.Z1J)(e,A):void 0,L=(0,l.uHr)(e,t),B=(0,l.nAc)(e,t),D=(0,l.jUK)(e),$=Boolean(D.storyViewer.storyId),F=(0,l.Btg)(e),U=t===F?.chatId&&n===F?.threadId&&o===F?.type&&!$,j=(0,l.dyD)(e,t),_=(j&&!(0,l.ccz)(e,j.id)?.noVoiceMessages)??!0,V=v?.slowMode,z=(0,l.wVz)(e),H="scheduled"===o?(0,l.hI0)(e,t):(0,l.saH)(e,t,n),W=a&&(0,l.JrV)(e,t,a),q=W&&"sentReaction"in W?W.sentReaction:void 0,G=(0,l.Mst)(e,t,n),Y=G?.replyInfo?(0,l.hjO)(e,t,G.replyInfo.replyToMsgId):void 0,X=u?.isForum&&u.isForumAsMessages&&n===s._f&&Y?(0,l.p$s)(e,Y):void 0,K="scheduled"===o;return{availableReactions:"story"===m?e.reactions.availableReactions:void 0,topReactions:"story"===m?e.reactions.topReactions:void 0,isOnActiveTab:!D.isBlurred,editingMessage:(0,l.kKD)(e,t,n,o),draft:G,chat:u,isChatWithBot:p,isChatWithSelf:Z,isForCurrentMessageList:U,canScheduleUntilOnline:(0,l.Eh5)(e,t),isChannel:u?(0,c.eA)(u):void 0,isRightColumnShown:(0,l.Jf5)(e,r),isSelectModeActive:(0,l.CAb)(e),withScheduledButton:"thread"===o&&Boolean(E?.length),isInScheduledList:K,botKeyboardMessageId:N,botKeyboardPlaceholder:M?.keyboardPlaceholder,isForwarding:t===D.forwardMessages.toChatId,pollModal:D.pollModal,stickersForEmoji:e.stickers.forEmoji.stickers,customEmojiForEmoji:e.customEmojis.forEmoji.stickers,chatFullInfo:v,topInlineBotIds:e.topInlineBots?.userIds,currentUserId:k,currentUser:T,contentToBeScheduled:D.contentToBeScheduled,shouldSuggestStickers:b,shouldSuggestCustomEmoji:C,shouldUpdateStickerSetOrder:S,recentEmojis:e.recentEmojis,baseEmojiKeywords:w?.keywords,emojiKeywords:I?.keywords,inlineBots:D.inlineBots.byUsername,isInlineBotLoading:D.inlineBots.isLoading,botCommands:f?f.botInfo?.commands||!1:void 0,botMenuButton:f?.botInfo?.menuButton,sendAsUser:R,sendAsChat:O,sendAsId:A,editingDraft:H,requestedDraftText:L,requestedDraftFiles:B,attachBots:e.attachMenu.bots,attachMenuPeerType:(0,l.taM)(e,t),theme:(0,l.Puy)(e),fileSizeLimit:(0,d.M)(e,"uploadMaxFileparts")*i.pJM,captionLimit:(0,d.M)(e,"captionLength"),isCurrentUserPremium:z,canSendVoiceByPrivacy:_,attachmentSettings:e.attachmentSettings,slowMode:V,currentMessageList:F,isReactionPickerOpen:(0,l.Io8)(e),canBuyPremium:!z&&!(0,l.oe5)(e),canPlayAnimatedEmojis:(0,l.W9H)(e),canSendOneTimeMedia:!Z&&g&&!p&&!K,shouldCollectDebugLogs:e.settings.byKey.shouldCollectDebugLogs,sentStoryReaction:q,stealthMode:e.stories.stealthMode,replyToTopic:X}}))((({type:e,isOnActiveTab:t,dropAreaState:n,isInScheduledList:l,canScheduleUntilOnline:d,isReady:y,isMobile:S,onDropHide:w,onFocus:I,onBlur:N,editingMessage:M,chatId:k,threadId:T,storyId:x,currentMessageList:A,messageListType:R,draft:O,chat:L,chatFullInfo:re,replyToTopic:ce,isForCurrentMessageList:ve,isCurrentUserPremium:ke,canSendVoiceByPrivacy:Te,isChatWithBot:xe,isChatWithSelf:Ae,isChannel:Re,fileSizeLimit:Be,isRightColumnShown:De,isSelectModeActive:Fe,isReactionPickerOpen:Ue,isForwarding:je,pollModal:_e,botKeyboardMessageId:ze,botKeyboardPlaceholder:He,inputPlaceholder:qe,withScheduledButton:Ge,stickersForEmoji:Ye,customEmojiForEmoji:Xe,topInlineBotIds:Ke,currentUserId:Je,currentUser:st,captionLimit:it,contentToBeScheduled:rt,shouldSuggestStickers:ct,shouldSuggestCustomEmoji:lt,baseEmojiKeywords:Ct,emojiKeywords:St,recentEmojis:Rt,inlineBots:Ot,isInlineBotLoading:Lt,botCommands:Bt,sendAsUser:Dt,sendAsChat:$t,sendAsId:Ft,editingDraft:Ut,requestedDraftText:jt,requestedDraftFiles:_t,botMenuButton:Vt,attachBots:zt,attachMenuPeerType:Ht,attachmentSettings:Wt,theme:qt,slowMode:Gt,shouldUpdateStickerSetOrder:Yt,editableInputCssSelector:Xt,editableInputId:Kt,inputId:Jt,className:Qt,availableReactions:en,topReactions:tn,canBuyPremium:nn,canPlayAnimatedEmojis:an,shouldCollectDebugLogs:on,sentStoryReaction:sn,stealthMode:rn,canSendOneTimeMedia:cn,onForward:ln})=>{const{sendMessage:dn,clearDraft:mn,showDialog:un,forwardMessages:hn,openPollModal:pn,closePollModal:Zn,loadScheduledHistory:gn,openThread:fn,addRecentEmoji:vn,sendInlineBotResult:Pn,loadSendAs:En,resetOpenChatWithDraft:yn,callAttachBot:bn,addRecentCustomEmoji:Cn,showNotification:Sn,showAllowedMessageTypesNotification:wn,openStoryReactionPicker:In,closeReactionPicker:Nn,sendStoryReaction:Mn,sendDefaultReaction:kn,editMessage:Tn}=(0,o.Sv)(),xn=(0,G.Z)(),An=(0,a.sO)(null),Rn=(0,a.sO)(null),[On,Ln]=(0,ee.Z)(""),[Bn,Dn]=(0,a.eJ)(!1),$n=(0,q.Z)(Xt),Fn=(0,a.sO)(),Un=(0,X.Z)(n),{width:jn}=E.Z.get(),_n="messageList"===e,Vn="story"===e,zn=_n?L?.sendAsPeerIds:void 0,Hn=zn&&(zn.length>1||!zn.some((e=>e.id===Je))),[Wn,qn,Gn]=(0,W.Z)(),Yn=(0,J.Z)(k,T),[Xn,Kn,Jn]=(0,W.Z)(),[Qn,ea,ta]=(0,W.Z)(),na=M&&(0,c.jL)(M),{emojiSet:aa,members:oa,botCommands:sa}=re||{},ia=aa?.id,ra=!(!sn||!("emoticon"in sn))&&sn.emoticon===i.mzt.emoticon;(0,a.d4)((()=>{k&&window?.onReceivedChatId?.postMessage(JSON.stringify({chatId:k,threadId:T}))}),[k,T]),(0,a.d4)((()=>{const e=()=>{clearInterval(At)};return window.addEventListener("cleanup-interval",e),()=>{window.removeEventListener("cleanup-interval",e)}}),[]),(0,a.d4)(h.AU,[On]);const ca=(0,a.sO)(0),[la,da]=(0,K.Z)(_n&&d,Gn);(0,_.Z)((()=>{Dn(!0)}),430),(0,a.d4)((()=>{_n||Nn()}),[_n,x]),(0,a.d4)((()=>{Fn.current=void 0}),[k]),(0,a.d4)((()=>{k&&y&&!Vn&&gn({chatId:k})}),[y,k,T,Vn]),(0,a.d4)((()=>{k&&L&&!zn&&y&&(0,c.ZV)(L)&&En({chatId:k})}),[L,k,y,En,zn]);const ma=(0,a.sO)(!1);(0,ne.Z)((([e,t])=>{ma.current=Boolean(k===e&&zn&&!t)}),[k,zn]);const[ua,ha]=(0,a.eJ)([]),pa=Boolean(ua.length),[Za,ga]=(0,a.eJ)(void 0),{canSendStickers:fa,canSendGifs:va,canAttachMedia:Pa,canAttachPolls:Ea,canAttachEmbedLinks:ya,canSendVoices:ba,canSendPlainText:Ca,canSendAudios:Sa,canSendVideos:wa,canSendPhotos:Ia,canSendDocuments:Na}=(0,a.Ye)((()=>(0,c.H5)(L,re,xe,Vn)),[L,re,xe,Vn]),Ma=!Ca&&!M,ka=(0,Y.Z)(((e,t=Kt)=>{if(t===Kt&&Ma)return;const n=window.getSelection();let a;if(a=t===Kt?document.querySelector(Xt):document.getElementById(t),n.rangeCount){const o=n.getRangeAt(0);if((0,D.R)(o,t))return(0,f.tx)(e),void a.dispatchEvent(new Event("input",{bubbles:!0}))}Ln(`${On()}${e}`),(0,r.Yq)((()=>{(0,p.Z)(a)}))})),Ta=(0,Y.Z)(((e,t=Kt)=>{const n=(0,F.Z)(e,["escape_html","emoji_html","br_html"]).join("").replace(/\u200b+/g,"​");ka(n,t)})),xa=(0,Y.Z)(((e,t=Kt)=>{const n=(0,U.z)(e);ka(n,t)})),Aa=(0,Y.Z)(((e,t=Kt)=>{ka((0,B.yR)(e),t)})),Ra=(0,Y.Z)((()=>{Za&&(xa(Za,Kt),ga(void 0))})),{shouldSuggestCompression:Oa,shouldForceCompression:La,shouldForceAsFile:Ba,handleAppendFiles:Da,handleFileSelect:$a,onCaptionUpdate:Fa,handleClearAttachments:Ua,handleSetAttachments:ja}=function({attachments:e,fileSizeLimit:t,setHtml:n,setAttachments:s,chatId:i,canSendAudios:r,canSendVideos:l,canSendPhotos:d,canSendDocuments:m,insertNextText:u,editedMessage:h}){const p=(0,G.Z)(),{openLimitReachedModal:g,showAllowedMessageTypesNotification:f,showNotification:v}=(0,o.Sv)(),[P,E]=(0,a.eJ)(!1),[y,b]=(0,a.eJ)(!1),[S,w]=(0,a.eJ)(void 0),I=(0,Y.Z)((()=>{s(Z.D),u()})),N=(0,Y.Z)((n=>{const a="function"==typeof n?n(e):n;if(a.length)if(a.some((e=>{const t=(0,c.SA)(e);return"audio"===t&&!r&&!m||"video"===t&&!l&&!m||"image"===t&&!d&&!m||"file"===t&&!m})))f({chatId:i});else if(a.some((({size:e})=>e>t)))g({limit:"uploadMaxFileparts"});else{s(a);const e=a.some((e=>{const t=(0,c.SA)(e);return"audio"===t&&!r||"video"===t&&!l||"image"===t&&!d}));E(Boolean(e&&m)),b(!m),w(void 0)}else I()}));return{shouldSuggestCompression:S,handleAppendFiles:(0,Y.Z)((async(t,n)=>{if(h){const e=await(0,C.Z)(t[0].name,t[0]),n=h&&(0,c.Gy)(h,e);h?.groupedId?n?N([e]):v({message:p("lng_edit_media_album_error")}):N([e])}else{const a=await Promise.all(t.map((e=>(0,C.Z)(e.name,e,{shouldSendAsSpoiler:n||void 0}))));N([...e,...a])}})),handleFileSelect:(0,Y.Z)((async(e,t)=>{if(h){const t=await(0,C.Z)(e[0].name,e[0]),n=h&&(0,c.Gy)(h,t);h?.groupedId?n?N([t]):v({message:p("lng_edit_media_album_error")}):N([t])}else{const t=await Promise.all(e.map((e=>(0,C.Z)(e.name,e))));N(t)}w(t)})),onCaptionUpdate:n,handleClearAttachments:I,handleSetAttachments:N,shouldForceCompression:y,shouldForceAsFile:P}}({attachments:ua,setHtml:Ln,setAttachments:ha,fileSizeLimit:Be,chatId:k,canSendAudios:Sa,canSendVideos:wa,canSendPhotos:Ia,canSendDocuments:Na,insertNextText:Ra,editedMessage:M}),[_a,Va,za]=(0,W.Z)(),[Ha,Wa,qa]=(0,W.Z)(),[Ga,Ya,Xa]=(0,W.Z)(),[Ka,Ja,Qa]=(0,W.Z)(),[eo,to,no]=(0,W.Z)(),[ao,oo,so]=(0,W.Z)(),{startRecordingVoice:io,stopRecordingVoice:ro,pauseRecordingVoice:co,activeVoiceRecording:lo,currentRecordTime:mo,recordButtonRef:uo,startRecordTimeRef:ho,isViewOnceEnabled:po,setIsViewOnceEnabled:Zo,toogleViewOnceEnabled:go}=(()=>{const e=(0,a.sO)(null),[t,n]=(0,a.eJ)(),o=(0,a.sO)(),[s,i]=(0,a.eJ)(),[c,l]=(0,a.eJ)(!1);(0,a.d4)((()=>{P.s$&&P.mh&&Oe()}),[]);const d=(0,Y.Z)((async()=>{try{const{stop:t,pause:a}=await Le((t=>{e.current&&(o.current&&Date.now()%4==0&&(0,r.WM)((()=>{e.current&&(e.current.style.boxShadow=`0 0 0 ${50*(t||0)}px rgba(0,0,0,.15)`)})),i(Date.now()))}));o.current=Date.now(),i(Date.now()),n({stop:t,pause:a})}catch(e){console.error(e)}})),m=(0,Y.Z)((()=>{if(t){(0,r.WM)((()=>{e.current&&(e.current.style.boxShadow="none")}));try{return t.pause()}catch(e){return void console.error(e)}}})),u=(0,Y.Z)((()=>{if(t){n(void 0),o.current=void 0,i(void 0),(0,r.WM)((()=>{e.current&&(e.current.style.boxShadow="none")}));try{return t.stop()}catch(e){return void console.error(e)}}}));(0,a.d4)((()=>t?(0,Me.Z)(u):void 0),[t,u]);const h=(0,Y.Z)((()=>{l(!c)}));return{startRecordingVoice:d,pauseRecordingVoice:m,stopRecordingVoice:u,activeVoiceRecording:t,currentRecordTime:s,recordButtonRef:e,startRecordTimeRef:o,isViewOnceEnabled:c,setIsViewOnceEnabled:l,toogleViewOnceEnabled:h}})(),fo=ve&&!Vn;(0,j.Z)((()=>{Yn({type:"recordAudio"})}),fo?lo&&i.o_S:void 0),(0,a.d4)((()=>{ve&&!Vn&&(lo||Yn({type:"cancel"}))}),[lo,ve,Vn,Yn]);const vo=(0,te.Y)(Boolean(M));(0,a.d4)((()=>{ve&&!Vn&&On()&&!vo.current&&Yn({type:"typing"})}),[On,vo,ve,Vn,Yn]);const Po=L&&(0,c.Nl)(L),{isEmojiTooltipOpen:Eo,closeEmojiTooltip:yo,filteredEmojis:bo,filteredCustomEmojis:Co,insertEmoji:So}=(0,fe.Z)(Boolean(y&&t&&(Vn||ve)&&ct&&!pa),On,Ln,void 0,Rt,Ct,St),{isCustomEmojiTooltipOpen:wo,closeCustomEmojiTooltip:Io,insertCustomEmoji:No}=(0,de.Z)(Boolean(y&&t&&(Vn||ve)&&lt&&!pa),On,Ln,$n,An,Xe),{isStickerTooltipOpen:Mo,closeStickerTooltip:ko}=function(e,t,n){const{loadStickersForEmoji:s,clearStickersForEmoji:r}=(0,o.Sv)(),[c,l,d]=(0,W.Z)(!1),m=(0,se.Z)((()=>{const n=t();if(!e||!n||P.op&&n.length>8)return;if(!n.match(P.op?we.Z:i.t8f))return;const a=(0,ae._)(n);return a&&(P.op&&1===(0,Ie.Z)(a)||!P.op&&Boolean(n.match(Ne)))?P.op?a:a.match(/alt="(.+)"/)?.[1]:void 0}),[t,e]),u=(0,z.Z)((()=>Boolean(m())),[m]),h=Boolean(n?.length);return(0,a.d4)((()=>{if(!e||!u)return;const t=m();t?h||s({emoji:t}):r()}),[e,u,m,h,s,r]),(0,a.d4)(d,[d,t]),{isStickerTooltipOpen:Boolean(u&&h&&!c),closeStickerTooltip:l}}(Boolean(y&&t&&(Vn||ve)&&ct&&fa&&!pa),On,Ye),{isMentionTooltipOpen:To,closeMentionTooltip:xo,insertMention:Ao,mentionFilteredUsers:Ro}=(0,Se.Z)(Boolean(_n&&y&&ve&&!pa),On,Ln,$n,An,oa,Ke,Je),{isOpen:Oo,botId:Lo,isGallery:Bo,switchPm:Do,switchWebview:$o,results:Fo,closeTooltip:Uo,help:jo,loadMore:_o}=function(e,t,n,s){const{queryInlineBot:i,resetInlineBot:r,resetAllInlineBots:c}=(0,o.Sv)(),[l,d,m]=(0,W.Z)(!1),u=(0,oe.CH)((()=>{const t=n();return e&&t.startsWith("@")?function(e){if(!e.startsWith("@"))return ye;const t=function(e){return be.innerHTML=e.replace(/<br>/g,"\n"),be.querySelectorAll("[alt]").forEach((e=>{e.innerText||(e.innerText=e.getAttribute("alt"))})),be.innerText}(e),n=t.match(Pe);return n?Ce(n[1],n[2],""===n[2]&&!t.match(Ee)):ye}(t):ye}),[n,e],300),{username:h,query:p,canShowHelp:Z,usernameLowered:g}=(0,z.Z)(u,[u,n],!0);(0,ne.Z)((([e])=>{e&&r({username:e})}),[h,r]),(0,a.d4)((()=>{g&&i({chatId:t,username:g,query:p})}),[t,p,i,g]),(0,a.d4)(m,[m,n]);const{id:f,switchPm:v,switchWebview:P,offset:E,results:y,isGallery:b,help:C}=g&&s?.[g]||{},S=Boolean((y?.length||v)&&!l);(0,a.d4)((()=>{S||h||c()}),[S,c,h]);const w=(0,Y.Z)((()=>{g&&i({chatId:t,username:g,query:p,offset:E})}));return{isOpen:S,botId:f,isGallery:b,switchPm:v,switchWebview:P,results:y,closeTooltip:d,help:Z&&C?`@${h} ${C}`:void 0,loadMore:w}}(Boolean(_n&&y&&ve&&!pa),k,On,Ot),{isOpen:Vo,close:zo,filteredBotCommands:Ho}=function(e,t,n,o){const[s,i]=(0,a.eJ)(),[r,c,l]=(0,W.Z)(!1),d=(0,oe.CH)((()=>{const n=t();return e&&n.startsWith("/")?(0,ae._)(n).match(ie)?.[0].trim():void 0}),[t,e],300),m=(0,se.Z)(d,[d,t],!0);return(0,a.d4)((()=>{const e=m(),t=n||o;if(!e||!t)return void i(void 0);const a=e.substring(1),s=t.filter((e=>!a||e.command.startsWith(a)));i(s?.length?s:void 0)}),[m,n,o]),(0,a.d4)(l,[l,t]),{isOpen:Boolean(s?.length&&!r),close:c,filteredBotCommands:s}}(Boolean(_n&&y&&ve&&(Bt&&Bt?.length||sa?.length)),On,Bt,sa);(({draft:e,chatId:t,threadId:n,getHtml:c,setHtml:l,editedMessage:d,isDisabled:m})=>{const{saveDraft:u,clearDraft:h,loadCustomEmojis:p}=(0,o.Sv)(),Z=(0,a.sO)(!1);(0,a.d4)((()=>{const t=c(),n=void 0!==e?.isLocal;(0,U.z)(e?.text)!==t||n?Z.current=!0:Z.current=!1}),[e,c]),(0,a.d4)((()=>{Z.current=!1}),[t,n]);const f=Boolean(d),v=(0,Y.Z)(((e={})=>{if(m||f||!Z.current)return;const a=c();a?u({chatId:e.chatId??t,threadId:e.threadId??n,text:(0,g.ZP)(a)}):h({chatId:e.chatId??t,threadId:e.threadId??n,shouldKeepReply:!0})})),P=(0,ue.Z)(i.r_R,!0,void 0,[t,n]);(0,me.Z)((([a,o,i])=>{if(m)return;const r=Z.current;if(t===a&&n===o){if(r&&!e)return;if(!e&&i&&l(""),r)return}if(d||!e)return;l((0,U.z)(e.text));const c=e.text?.entities?.map((e=>e.type===s.Vv.CustomEmoji&&e.documentId)).filter(Boolean)||[];c.length&&p({ids:c})}),[t,n,e,c,l,d,m]),(0,a.d4)((()=>{if(!m)return()=>{f||v({chatId:t,threadId:n}),Ze=!0,(0,r.i$)((()=>{Ze=!1}))}}),[t,n,f,v,m]);const E=(0,te.Y)(t),y=(0,te.Y)(n);(0,a.d4)((()=>{if(m||Ze)return;if(!c())return void v();const e=E.current,t=y.current;P((()=>{E.current===e&&y.current===t&&v()}))}),[E,c,m,P,y,v]),(0,he.Z)(v),(0,pe.Z)(v)})({draft:O,chatId:k,threadId:T,getHtml:On,setHtml:Ln,editedMessage:M,isDisabled:Vn});const Wo=(0,Y.Z)(((e=!1)=>{e||Ln(""),ha(Z.D),ga(void 0),yo(),Io(),ko(),xo(),S?setTimeout((()=>Xa()),350):Xa()})),[qo,Go,Yo]=((e,t,n,s,l,d,m,u,h,Z)=>{const{editMessage:f,setEditingDraft:v,toggleMessageWebPage:P}=(0,o.Sv)(),[E,y]=(0,a.eJ)(!1),b=h?.replyInfo?.replyToMsgId;(0,H.Z)((([e,a])=>{if(!n)return;if(b&&a!==b)return t(""),void y(!1);if(e?.id===n.id&&b===a)return;const o=!e&&Z?.text.length?Z:n.content.text,s=(0,U.z)(o);t(s),y(!0),(0,r.Yq)((()=>{const e=document.querySelector(i.Edp);e&&(0,p.Z)(e,!0)}))}),[n,b,Z,t]),(0,a.d4)((()=>{if(!n)return;const e=!("webPage"in n.content)&&n.content.text?.entities?.some((e=>ge.has(e.type)));P({chatId:d,threadId:m,noWebPage:e})}),[d,m,n]),(0,a.d4)((()=>{if(n)return()=>{const t=(0,g.ZP)(e()),n=t.text.length?t:void 0;v({chatId:d,threadId:m,type:u,text:n})}}),[d,n,e,v,m,u]);const C=(0,oe.iD)((()=>{if(!n)return!1;const t=(0,g.ZP)(e());return!("webPage"in n.content)&&n.content.text?.entities?.some((e=>ge.has(e.type)))&&!t.entities?.some((e=>ge.has(e.type)))}),[n,e],300,!0),S=(0,se.Z)(C,[C,e],!0);(0,H.Z)((([e])=>{n&&e?.id===n.id&&S()&&P({chatId:d,threadId:m,noWebPage:!1})}),[n,d,e,m,S]);const w=(0,Y.Z)((()=>{h&&(0,r.i$)((()=>{t((0,U.z)(h.text)),(0,r.Yq)((()=>{const e=document.querySelector(i.Edp);e&&(0,p.Z)(e,!0)}))}))})),I=(0,Y.Z)((()=>{s(),w()})),N=(0,Y.Z)((()=>{const{text:t,entities:a}=(0,g.ZP)(e());n&&(t||(0,c.u8)(n)?(f({messageList:{chatId:d,threadId:m,type:u},text:t,entities:a}),s(),w()):l())})),M=(0,Y.Z)((()=>{if(!n)return;const t=(0,g.ZP)(e()),a=t.text.length?t:void 0;v({chatId:d,threadId:m,type:u,text:a})}));return(0,he.Z)(M),(0,pe.Z)(M),[N,I,E]})(On,Ln,M,Wo,to,k,T,R,O,Ut),Xo=(0,te.Y)(Wo),Ko=(0,te.Y)(ro);(0,a.d4)((()=>()=>{Ko.current(),Xo.current()}),[k,T,Xo,Ko]);const Jo=(0,Y.Z)((()=>{const e=ca.current;Sn(e?{message:xn("UnlockPremiumEmojiHint2"),action:{action:"openChat",payload:{id:Je,shouldReplaceHistory:!0}},actionText:xn("Open")}:{message:xn("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:xn("PremiumMore")}),ca.current=Number(!e)})),Qo=(0,z.Z)((()=>Xn||!ln||On()&&!pa?M&&Yo?xt.Edit:!P.mh||lo||je||On()&&!pa?l?xt.Schedule:xt.Send:xt.Record:xt.Forward),[lo,M,On,pa,je,Xn,ln,Yo,l]),es=!l,{isContextMenuOpen:ts,handleContextMenu:ns,handleContextMenuClose:as,handleContextMenuHide:os}=(0,V.Z)(uo,!(Qo===xt.Send&&es)),{contextMenuPosition:ss,handleContextMenu:is,handleBeforeContextMenu:rs,handleContextMenuHide:cs}=(0,V.Z)(Rn,!Vn);(0,a.d4)((()=>{Ue||ss&&(In({peerId:k,storyId:x,position:ss}),cs())}),[k,cs,Ue,x,ss]),le(ve||Vn,xa,ja,ga,M,!ke&&!Ae,Jo);const ls=(0,Y.Z)((()=>{M&&Go()})),ds=(0,Y.Z)(((e,t)=>{const n=t?it:4096;if(e?.length>n){const t=e.length-n;return un({data:{message:"MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS",textParams:{"{EXTRA_CHARS_COUNT}":t.toString(),"{PLURAL_S}":t>1?"s":""},hasErrorKey:!0}}),!1}return!0})),ms=(0,Y.Z)((()=>{if(Gt&&!Po){const e=document.querySelector(Xt),t=(0,v.bp)(),n=Fn.current&&Math.floor(t-Fn.current),a=Gt.nextSendDate&&Gt.nextSendDate>t;if(n&&n<Gt.seconds||a){const o=a?Gt.nextSendDate-t:Gt.seconds-n;return un({data:{message:xn("SlowModeHint",(0,u.k9)(o)),isSlowMode:!0,hasErrorKey:!1}}),e?.blur(),!1}}return!0})),us=(0,Y.Z)((({attachments:e,sendCompressed:t=Wt.shouldCompress,sendGrouped:n=Wt.shouldSendGrouped,isSilent:a,scheduledAt:o})=>{if(!A&&!x)return;const{text:s,entities:i}=(0,g.ZP)(On());(s||e.length)&&ds(s,!0)&&ms()&&(M?Tn({messageList:A,text:s,entities:i,attachments:(0,C.V)(e,t)}):dn({messageList:A,text:s,entities:i,scheduledAt:o,isSilent:a,shouldUpdateStickerSetOrder:Yt,attachments:(0,C.V)(e,t),shouldGroupMessages:n}),Fn.current=(0,v.bp)(),mn({chatId:k,isLocalOnly:!0}),(0,r.i$)((()=>{Wo()})))})),hs=(0,Y.Z)(((e,t,n,a)=>{us({attachments:ua,sendCompressed:e,sendGrouped:t,isSilent:n,scheduledAt:a})})),ps=(0,Y.Z)((async(e=!1,t)=>{if(!A&&!x)return;let n=ua;if(lo){const e=await ro(),t=po?i.jfZ:void 0;if(e){const{blob:a,duration:o,waveform:s}=e;n=[await(0,C.Z)("wonderful-voice-message.ogg",a,{voice:{duration:o,waveform:s},ttlSeconds:t})]}}const{text:a,entities:o}=(0,g.ZP)(On());if(n.length)return void us({attachments:n,scheduledAt:t,isSilent:e});if(!a&&!je)return;if(!ds(a))return;const s=document.querySelector(Xt);if(a){if(!ms())return;dn({messageList:A,text:a,entities:o,scheduledAt:t,isSilent:e,shouldUpdateStickerSetOrder:Yt})}je&&hn({scheduledAt:t,isSilent:e}),Fn.current=(0,v.bp)(),mn({chatId:k,isLocalOnly:!0}),P.cj&&s&&s===document.activeElement&&b(s),(0,r.i$)((()=>{Wo()}))})),Zs=(0,Y.Z)((()=>{"webApp"===Vt?.type&&bn({chatId:k,url:Vt.url,threadId:T})})),gs=(0,Y.Z)((()=>{Xa(),Wa()})),fs=(0,Y.Z)(((e,t,n)=>{if(e&&"queryId"in e){const{id:a,queryId:o,isSilent:s}=e;return void Pn({id:a,queryId:o,scheduledAt:t,isSilent:s,messageList:n})}const{isSilent:a,...o}=e||{};if(e&&0!==Object.keys(o).length)if(void 0!==e.sendCompressed||void 0!==e.sendGrouped){const{sendCompressed:n=!1,sendGrouped:o=!1}=e;hs(n,o,a,t)}else dn({...e,messageList:n,scheduledAt:t});else ps(Boolean(a),t)}));(0,H.Z)((([e])=>{A&&rt&&rt!==e&&la((e=>{fs(rt,e,A)}))}),[rt,A,fs,la]),(0,a.d4)((()=>{jt&&(Ln(function(e){const t=document.createElement("div"),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(jt)),yn(),(0,r.Yq)((()=>{const e=document.getElementById(Kt);(0,p.Z)(e,!0)})))}),[Kt,jt,yn,Ln]),(0,a.d4)((()=>{_t?.length&&($a(_t),yn())}),[$a,_t,yn]);const vs=(0,Y.Z)(((e,t)=>{const n="id"in e.stickerSetInfo&&e.stickerSetInfo.id;e.isFree||ke||Ae||n===ia?Aa(e,t):Jo()})),Ps=(0,Y.Z)((e=>{vs(e,i.nYf)})),Es=(0,Y.Z)(((e,t,n)=>{(A||x)&&(l||n?(qn(),la((n=>{Gn(),fs({gif:e,isSilent:t},n,A),(0,r.i$)((()=>{Wo(!0)}))}))):(dn({messageList:A,gif:e,isSilent:t}),(0,r.i$)((()=>{Wo(!0)}))))})),ys=(0,Y.Z)(((e,t,n,a=!1,o)=>{(A||x)&&(e={...e,isPreloadedGlobally:!0},l||n?(qn(),la((n=>{Gn(),fs({sticker:e,isSilent:t},n,A),(0,r.i$)((()=>{Wo(a)}))}))):(dn({messageList:A,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:Yt&&o}),(0,r.i$)((()=>{Wo(a)}))))})),bs=(0,Y.Z)(((e,t,n)=>{if(!A&&!x)return;l||n?la((n=>{fs({id:e.id,queryId:e.queryId,isSilent:t},n,A)})):Pn({id:e.id,queryId:e.queryId,isSilent:t,messageList:A});const a=document.querySelector(Xt);P.cj&&a&&a===document.activeElement&&b(a),mn({chatId:k,isLocalOnly:!0}),(0,r.i$)((()=>{Wo()}))})),Cs=(0,Y.Z)((()=>{mn({chatId:k,isLocalOnly:!0}),(0,r.i$)((()=>{Wo()}))})),Ss=(0,Y.Z)((e=>{A&&(l?(la((t=>{fs({poll:e},t,A)})),Zn()):(dn({messageList:A,poll:e}),Zn()))})),ws=(0,Y.Z)((e=>{if(l)la((t=>{fs({...e,isSilent:!0},t,A)}));else if(e&&("sendCompressed"in e||"sendGrouped"in e)){const{sendCompressed:t=!1,sendGrouped:n=!1}=e;hs(t,n,!0)}else ps(!0)})),Is=(0,a.I4)((()=>{window?.sendCrypto?.postMessage(JSON.stringify({chatId:k}))}),[k]),Ns=(0,a.I4)((()=>(0,o.Rd)().chats.byId[k].lastMessage?.id),[k]),Ms=(0,a.I4)((()=>{window?.sendNFTViaLink?.postMessage(JSON.stringify({chatId:k,threadId:T}))}),[k,T]),ks=(0,a.I4)((()=>{window?.sendNFT?.postMessage(JSON.stringify({chatId:k,threadId:T}))}),[k,T]),Ts=(0,a.I4)((()=>{window?.createPOAP?.postMessage({chatId:k});const e=Ns();e&&(At=setInterval((()=>{const t=Ns();e!==t&&t&&(kn({chatId:k,messageId:t}),window.dispatchEvent(new Event("cleanup-interval")))}),5e3))}),[k,Ns]),xs=(0,a.I4)((()=>{window?.sendCryptoViaLink?.postMessage(JSON.stringify({chatId:k,threadId:T}))}),[k,T]),As=(0,Y.Z)((()=>{const e=document.querySelector(Xt);if(!S||e!==document.activeElement)return qa(),Xa(),void Ja();e?.blur(),setTimeout((()=>{qa(),Xa(),Ja()}),100)}));(0,a.d4)((()=>{Ma&&Ln("")}),[Ma,Ln,ua]);const Rs=(0,Y.Z)((e=>{Ta(e,i.nYf)})),Os=(0,Y.Z)(((e=Kt)=>{const t=window.getSelection();if(t.rangeCount){const n=t.getRangeAt(0);if((0,D.R)(n,e))return void document.execCommand("delete",!1)}Ln(function(e){const t=document.createElement("div");t.contentEditable="true",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.innerHTML=e,t.className="allow-selection",document.body.appendChild(t);let n=t.lastChild;if(n.lastChild)for(;n.lastChild;)n=n.lastChild;const a=n.textContent.length,o=document.createRange(),s=window.getSelection();o.setStart(n,a),o.setEnd(n,a),s.removeAllRanges(),s.addRange(o),document.execCommand("delete",!1);const i=t.innerHTML;return document.body.removeChild(t),i}(On()))})),Ls=(0,Y.Z)((()=>{Os(i.nYf)})),Bs=(0,Y.Z)((()=>{fn({chatId:k,threadId:T,type:"scheduled",noForumTopicPanel:!0})}));(0,a.d4)((()=>{De&&S&&Xa()}),[De,Xa,S]),(0,a.d4)((()=>{y&&(Fe?oo():setTimeout((()=>{so()}),200))}),[Fe,so,oo,y]);const Ds=xe&&"webApp"===Vt?.type&&!M,$s=(0,z.Z)((()=>Ds&&!On()&&!lo),[Ds,On,lo]),[Fs,Us]=(0,a.Ye)((()=>Gt?.nextSendDate?["SlowModeWait",Gt.nextSendDate]:rn?.activeUntil&&Vn?["StealthModeActiveHint",rn.activeUntil]:[]),[Vn,Gt?.nextSendDate,rn?.activeUntil]),js=_a||Ga||Eo||Ka||To||Oo||eo||Ha||Qn||Mo||Vo||wo||$s||ts||Boolean(lo)||ua.length>0||Xn,_s=js&&!Ue&&Vn&&!Qn&&!Ga,Vs=L?.isForum&&L?.isForumAsMessages&&T===s._f?ce?xn("Chat.InputPlaceholderReplyInTopic",ce.title):xn("Message.Placeholder.MessageInGeneral"):void 0;(0,a.d4)((()=>{js?I?.():N?.()}),[js,N,I]);const{shouldRender:zs,transitionClassNames:Hs}=(0,Q.Z)(_s),Ws=!(Qo!==xt.Record||Pa&&Te&&ba),qs=(0,Y.Z)((()=>{switch(Qo){case xt.Forward:ln?.();break;case xt.Send:ps();break;case xt.Record:Ws?Te?ba||wn({chatId:k}):Sn({message:xn("VoiceMessagesRestrictedByPrivacy",L?.title)}):(Zo(!1),io());break;case xt.Edit:qo();break;case xt.Schedule:if(lo&&co(),!A)return;la((e=>{fs({},e,A)}))}})),Gs=(0,X.Z)(M,!0),Ys=M||Gs,Xs=new Date;Xs.setSeconds(0),Xs.setMilliseconds(0);const Ks=new Date;Ks.setFullYear(Ks.getFullYear()+1);let Js="SendMessage";switch(Qo){case xt.Forward:Js="Forward";break;case xt.Edit:Js="Save edited message";break;case xt.Record:Js=Pa?"AccDescrVoiceMessage":"Conversation.DefaultRestrictedMedia"}const Qs=(0,m.Z)("Composer",!Fe&&"shown",ao&&"hover-disabled",Bn&&"mounted",Qt),ei=(0,Y.Z)((e=>{let t,n;if("emoticon"in e)t=e.emoticon;else{const a=(0,o.Rd)().customEmojis.byId[e.documentId];if(!a)return;if(!a.isFree&&!ke&&!Ae)return void Jo();const s=(0,g.ZP)((0,B.yR)(a));t=s.text,n=s.entities}dn({text:t,entities:n,isReaction:!0}),Nn()})),ti=(0,Y.Z)((e=>{In({peerId:k,storyId:x,position:e,sendAsMessage:!0})})),ni=(0,Y.Z)((()=>{const e=sn?void 0:i.mzt;Mn({peerId:k,storyId:x,containerId:(0,c.hl)(k,x),reaction:e})})),ai=(0,Y.Z)((()=>{la((e=>{fs({},e,A)}))})),oi=(0,Y.Z)((()=>{ws()})),si=(0,Y.Z)((()=>{fs({},i.t4X,A)})),ii=(0,Y.Z)(((e,t)=>{la((n=>{fs({sendCompressed:e,sendGrouped:t},n,A)}))})),ri=(0,Y.Z)(((e,t)=>{ws({sendCompressed:e,sendGrouped:t})})),ci=(0,a.Ye)((()=>{switch(Qo){case xt.Edit:return qo;case xt.Schedule:return ai;default:return ps}}),[Qo,qo]),li=xe&&"commands"===Vt?.type&&!M&&!1!==Bt&&!lo;return a.ZP.createElement("div",{className:Qs},_n&&Pa&&y&&a.ZP.createElement(pt,{isOpen:n!==ht.t.None,withQuick:n===ht.t.QuickFile||Un===ht.t.QuickFile,onHide:w,onFileSelect:$a,editingMessage:M}),zs&&a.ZP.createElement(It.Z,{topReactions:tn,allAvailableReactions:en,onToggleReaction:ei,isPrivate:!0,isReady:y,canBuyPremium:nn,isCurrentUserPremium:ke,isInSavedMessages:Ae,isInStoryViewer:Vn,canPlayAnimatedEmojis:an,onShowMore:ti,className:Hs}),a.ZP.createElement($e,{chatId:k,threadId:T,canShowCustomSendMenu:es,attachments:ua,getHtml:On,isReady:y,shouldSuggestCompression:Oa,shouldForceCompression:La,shouldForceAsFile:Ba,isForCurrentMessageList:ve,isForMessage:_n,shouldSchedule:l,forceDarkTheme:Vn,onCaptionUpdate:Fa,onSendSilent:ri,onSend:hs,onSendScheduled:ii,onFileAppend:Da,onClear:Ua,onAttachmentsUpdate:ja,onCustomEmojiSelect:Ps,onRemoveSymbol:Ls,onEmojiSelect:Rs,editingMessage:M}),a.ZP.createElement(Pt,{isOpen:_e.isOpen,isQuiz:_e.isQuiz,shouldBeAnonymous:Re,onClear:Zn,onSend:Ss}),Ys&&a.ZP.createElement(kt,{isOpen:eo,isSchedule:"scheduled"===R,onClose:no,message:Ys}),a.ZP.createElement(Et,{isOpen:Ka,onClose:Qa,chatId:k,selectedSendAsId:Ft,sendAsPeerIds:zn,isCurrentUserPremium:ke}),a.ZP.createElement(ft,{isOpen:To,filteredUsers:Ro,onInsertUserName:Ao,onClose:xo}),a.ZP.createElement(tt,{isOpen:Vo,withUsername:Boolean(sa),botCommands:Ho,getHtml:On,onClick:Cs,onClose:zo}),a.ZP.createElement("div",{className:(0,m.Z)("composer-wrapper",Vn&&"with-story-tweaks")},a.ZP.createElement("svg",{className:"svg-appendix",width:"9",height:"20"},a.ZP.createElement("defs",null,a.ZP.createElement("filter",{x:"-50%",y:"-14.7%",width:"200%",height:"141.2%",filterUnits:"objectBoundingBox",id:"composerAppendix"},a.ZP.createElement("feOffset",{dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1"}),a.ZP.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1"}),a.ZP.createElement("feColorMatrix",{values:"0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0",in:"shadowBlurOuter1"}))),a.ZP.createElement("g",{fill:"none","fill-rule":"evenodd"},a.ZP.createElement("path",{d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z",fill:"#000",filter:"url(#composerAppendix)"}),a.ZP.createElement("path",{d:"M6 17H0V0c.193 2.84.876 5.767 2.05 8.782.904 2.325 2.446 4.485 4.625 6.48A1 1 0 016 17z",fill:"#FFF",className:"corner"}))),_n&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(gt,{isOpen:Oo,botId:Lo,isGallery:Bo,inlineBotResults:Fo,switchPm:Do,switchWebview:$o,loadMore:_o,isSavedMessages:Ae,canSendGifs:va,isCurrentUserPremium:ke,onSelectResult:bs,onClose:Uo}),a.ZP.createElement(dt,{onClear:ls,shouldForceShowEditing:Boolean(Yo&&M)}),a.ZP.createElement(wt,{chatId:k,threadId:T,getHtml:On,isDisabled:!ya||pa})),a.ZP.createElement("div",{className:(0,m.Z)("message-input-wrapper",(0,$.D)(st))},_n&&a.ZP.createElement(a.ZP.Fragment,null,Ds&&a.ZP.createElement(ot,{isOpen:$s,text:Vt.text,isDisabled:Boolean(lo),onClick:Zs}),li&&a.ZP.createElement(We.Z,{className:(0,m.Z)("bot-commands",Ha&&"activated"),round:!0,disabled:void 0===Bt,color:"translucent",onActivate:gs,ariaLabel:"Open bot command keyboard"},a.ZP.createElement("i",{className:"icon icon-bot-commands-filled"})),Hn&&(Dt||$t)&&a.ZP.createElement(nt.Z,{round:!0,color:"translucent",onClick:Ka?Qa:As,ariaLabel:xn("SendMessageAsTitle"),className:(0,m.Z)("send-as-button",ma.current&&"appear-animation")},a.ZP.createElement(Mt.Z,{peer:Dt||$t,size:"tiny"}))),(!Ma||va||fa)&&a.ZP.createElement(bt.Z,{chatId:k,threadId:T,isMobile:S,isReady:y,isSymbolMenuOpen:Ga,openSymbolMenu:Ya,closeSymbolMenu:Xa,canSendStickers:fa,canSendGifs:va,isMessageComposer:_n,onGifSelect:Es,onStickerSelect:ys,onCustomEmojiSelect:vs,onRemoveSymbol:Os,onEmojiSelect:Ta,closeBotCommandMenu:qa,closeSendAsMenu:Qa,isSymbolMenuForced:Wn,canSendPlainText:!Ma,inputCssSelector:Xt,idPrefix:e,forceDarkTheme:Vn}),a.ZP.createElement(vt.Z,{ref:An,id:Jt,editableInputId:Kt,customEmojiPrefix:e,isStoryInput:Vn,chatId:k,canSendPlainText:!Ma,threadId:T,isReady:y,isActive:!pa,getHtml:On,placeholder:lo&&jn<=600?"":Ma?xn("Chat.PlaceholderTextNotAllowed"):He||qe||xn(Vs||"Message"),timedPlaceholderDate:Us,timedPlaceholderLangKey:Fs,forcedPlaceholder:jo,canAutoFocus:y&&ve&&!pa&&_n,noFocusInterception:pa,shouldSuppressFocus:S&&Ga,shouldSuppressTextFormatter:Eo||To||Oo,onUpdate:Ln,onSend:ci,onSuppressedFocus:Xa,onFocus:Kn,onBlur:Jn}),_n&&a.ZP.createElement(a.ZP.Fragment,null,Lt&&Boolean(Lo)&&a.ZP.createElement(Nt.Z,{color:"gray"}),Ge&&a.ZP.createElement(nt.Z,{round:!0,faded:!0,className:"scheduled-button",color:"translucent",onClick:Bs,ariaLabel:"Open scheduled messages"},a.ZP.createElement("i",{className:"icon icon-schedule"})),Boolean(ze)&&!lo&&!M&&a.ZP.createElement(We.Z,{className:_a?"activated":"",round:!0,color:"translucent",onActivate:Va,ariaLabel:"Open bot command keyboard"},a.ZP.createElement("i",{className:"icon icon-bot-command"}))),lo&&Boolean(mo)&&a.ZP.createElement("span",{className:"recording-state"},(0,u.rM)(mo-ho.current)),a.ZP.createElement(Qe,{chatId:k,threadId:T,editingMessage:M,hasReplaceableMedia:na,isButtonVisible:!lo,canAttachMedia:Pa,canAttachPolls:Ea,canSendPhotos:Ia,canSendVideos:wa,canSendDocuments:Na,canSendAudios:Sa,onFileSelect:$a,onPollCreate:pn,isScheduled:l,attachBots:_n?zt:void 0,peerType:Ht,shouldCollectDebugLogs:on,isChatWithBot:(xe||Ae)??!1,handleSendCrypto:Is,handleCreatePOAP:Ts,handleSendNFT:ks,handleSendCryptoViaLink:xs,handleSendNTFViaLink:Ms,theme:qt,onMenuOpen:ea,onMenuClose:ta}),_n&&Boolean(ze)&&a.ZP.createElement(at,{messageId:ze,isOpen:_a,onClose:za}),_n&&Bt&&a.ZP.createElement(et,{isOpen:Ha,botCommands:Bt,onClose:qa}),a.ZP.createElement(mt.Z,{key:`custom-emoji-tooltip-${Kt}`,chatId:k,isOpen:wo,onCustomEmojiSelect:No,addRecentCustomEmoji:Cn,onClose:Io}),a.ZP.createElement(yt,{key:`sticker-tooltip-${Kt}`,chatId:k,threadId:T,isOpen:Mo,onStickerSelect:ys,onClose:ko}),a.ZP.createElement(Zt.Z,{key:`emoji-tooltip-${Kt}`,isOpen:Eo,emojis:bo,customEmojis:Co,addRecentEmoji:vn,addRecentCustomEmoji:Cn,onEmojiSelect:So,onCustomEmojiSelect:So,onClose:yo}))),cn&&lo&&a.ZP.createElement(nt.Z,{className:(0,m.Z)("view-once",po&&"active"),round:!0,color:"secondary",ariaLabel:xn("Chat.PlayOnceVoiceMessageTooltip"),onClick:go},a.ZP.createElement(Ve.Z,{name:"view-once"}),a.ZP.createElement(Ve.Z,{name:"one-filled"})),lo&&a.ZP.createElement(nt.Z,{round:!0,color:"danger",className:"cancel",onClick:ro,ariaLabel:"Cancel voice recording"},a.ZP.createElement("i",{className:"icon icon-delete"})),Vn&&!lo&&a.ZP.createElement(nt.Z,{round:!0,className:"story-reaction-button",color:"secondary",onClick:ni,onContextMenu:is,onMouseDown:rs,ariaLabel:xn("AccDescrLike"),ref:Rn},sn&&a.ZP.createElement(Tt.Z,{key:"documentId"in sn?sn.documentId:sn.emoticon,containerId:(0,c.hl)(k,x),reaction:sn,withEffectOnly:ra}),(!sn||ra)&&a.ZP.createElement("i",{className:(0,m.Z)("icon","icon-heart",ra&&"story-reaction-heart"),"aria-hidden":!0})),a.ZP.createElement(nt.Z,{ref:uo,round:!0,color:"secondary",className:(0,m.Z)(Qo,"main-button",!y&&"not-ready",lo&&"recording"),disabled:Ws,allowDisabledClick:!0,noFastClick:!0,ariaLabel:xn(Js),onClick:qs,onContextMenu:Qo===xt.Send&&es?ns:void 0},a.ZP.createElement("i",{className:"icon icon-send"}),a.ZP.createElement("i",{className:"icon icon-microphone-alt"}),ln&&a.ZP.createElement("i",{className:"icon icon-forward"}),_n&&a.ZP.createElement("i",{className:"icon icon-schedule"}),_n&&a.ZP.createElement("i",{className:"icon icon-check"})),es&&a.ZP.createElement(ut.Z,{isOpen:ts,canSchedule:_n&&!po,canScheduleUntilOnline:d&&!po,onSendSilent:Ae?void 0:oi,onSendSchedule:l?void 0:ai,onSendWhenOnline:si,onClose:as,onCloseAnimationEnd:os,isSavedMessages:Ae}),da)})))},40329:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(60748),o=n(33555),s=n(4463),i=n(7054),r=n(32340),c=n(59107),l=n(231),d=n(34563),m=n(70172);const u=(0,a.X$)((0,o.c$)(((e,{chat:t,isSavedDialog:n})=>{const a=(0,s.YC)(t.id),o=(0,i.FM1)(e,t.id),r=a&&(0,i.dyD)(e,(0,s.zX)(t)),c=r&&(0,s.cS)(r)&&!t.isSupport,l=a&&!o&&!c&&!n,d=a?(0,s.Vl)((0,i.dyD)(e,(0,s.zX)(t))):void 0;return{isPrivateChat:a,isChatWithSelf:o,isBot:c,isChannel:(0,s.eA)(t),isBasicGroup:(0,s.G9)(t),isSuperGroup:(0,s.ZV)(t),currentUserId:e.currentUserId,canDeleteForAll:l,contactName:d}}))((({isOpen:e,chat:t,isSavedDialog:n,isChannel:i,isPrivateChat:u,isChatWithSelf:h,isBot:p,isBasicGroup:Z,isSuperGroup:g,currentUserId:f,canDeleteForAll:v,contactName:P,onClose:E,onCloseAnimationEnd:y})=>{const{leaveChannel:b,deleteHistory:C,deleteSavedHistory:S,deleteChannel:w,deleteChatUser:I,blockUser:N}=(0,o.Sv)(),M=(0,c.Z)(),k=(0,s.U)(M,t),T=(0,a.I4)((()=>{C({chatId:t.id,shouldDeleteForAll:!0}),E()}),[t.id,E]),x=(0,a.I4)((()=>{C({chatId:t.id,shouldDeleteForAll:!0}),N({userId:t.id}),E()}),[t.id,E]),A=(0,a.I4)((()=>{n?S({chatId:t.id}):u?C({chatId:t.id,shouldDeleteForAll:!1}):Z?(I({chatId:t.id,userId:f}),C({chatId:t.id,shouldDeleteForAll:!1})):!i&&!g||t.isCreator?(i||g)&&t.isCreator&&w({chatId:t.id}):b({chatId:t.id}),E()}),[u,Z,i,g,f,t.isCreator,t.id,n,E]),R=(0,a.I4)((()=>{i||g?(b({chatId:t.id}),E()):A()}),[t.id,A,i,g,b,E]);return a.ZP.createElement(d.Z,{isOpen:e,className:"DeleteChatModal",header:a.ZP.createElement("div",{className:"modal-header",dir:M.isRtl?"rtl":void 0},a.ZP.createElement(m.Z,{size:"tiny",peer:t,isSavedMessages:h}),a.ZP.createElement("h3",{className:"modal-title"},M(n?h?"ClearHistoryMyNotesTitle":"ClearHistoryTitleSingle2":i&&!t.isCreator?"LeaveChannel":i&&t.isCreator?"ChannelDelete":Z||g?"Group.LeaveGroup":"DeleteChatUser"))),onClose:E,onCloseAnimationEnd:y},n?a.ZP.createElement("p",null,(0,r.Z)(h?M("ClearHistoryMyNotesMessage"):M("ClearHistoryMessageSingle",k),["simple_markdown","emoji"])):i&&t.isCreator?a.ZP.createElement("p",null,(0,r.Z)(M("ChatList.DeleteAndLeaveGroupConfirmation",k),["simple_markdown","emoji"])):i&&!t.isCreator||Z||g?a.ZP.createElement("p",null,(0,r.Z)(M("ChannelLeaveAlertWithName",k),["simple_markdown","emoji"])):a.ZP.createElement("p",null,(0,r.Z)(M("ChatList.DeleteChatConfirmation",P),["simple_markdown","emoji"])),a.ZP.createElement("div",{className:"dialog-buttons-column"},p&&!n&&a.ZP.createElement(l.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:x},M("DeleteAndStop")),v&&a.ZP.createElement(l.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:T},P?(0,r.Z)(M("ChatList.DeleteForEveryone",P)):M("DeleteForAll")),!u&&t.isCreator&&!n&&a.ZP.createElement(l.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:A},M("DeleteForAll")),a.ZP.createElement(l.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:u||n?A:R},M(n?"Delete":i&&!t.isCreator?"LeaveChannel":i&&t.isCreator?"Chat.Input.Delete":Z||g?"Group.LeaveGroup":v?"ChatList.DeleteForCurrentUser":"Delete")),a.ZP.createElement(l.Z,{className:"confirm-dialog-button",isText:!0,onClick:E},M("Cancel"))))})))},82535:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(60748),o=n(33555),s=n(83716),i=n(4463),r=n(15376),c=n(60706),l=n(3657),d=n(59107),m=n(25190),u=n(6202),h=n(6701),p=n(14605),Z=n(17551),g=n(47002);const f=new Set(["svg","svgz"]),v=(0,a.X$)((({message:e,observeIntersection:t,smaller:n,canAutoLoad:v,autoLoadFileMaxSizeMb:P,uploadProgress:E,withDate:y,datetime:b,className:C,sender:S,isSelected:w,isSelectable:I,shouldWarnAboutSvg:N,isDownloading:M,onCancelUpload:k,onMediaClick:T,onDateClick:x})=>{const{cancelMessageMediaDownload:A,downloadMessageMedia:R,setSettingOption:O}=(0,o.Sv)(),L=(0,a.sO)(null),B=(0,d.Z)(),[D,$,F]=(0,c.Z)(),[U,j]=(0,a.eJ)(!1),_=e.content.document||(0,i.N4)(e),{fileName:V,size:z,timestamp:H}=_,W=(0,r.K2)(_)||"",q=(0,l.Op)(L,t),[G,Y]=(0,c.Z)();(0,a.d4)((()=>{q&&Y()}),[q,Y]);const[X,K]=(0,a.eJ)(v&&(!P||z<=1048576*P)),J=Boolean(M||X&&G),Q=(0,i.Ti)(e,"download"),{loadProgress:ee,mediaData:te}=(0,h.Z)(Q,!J,(0,i.kG)(e,"download"),void 0,!0),ne=Boolean(te),{isUploading:ae,isTransferring:oe,transferProgress:se}=(0,i.Sc)(e,E||ee,J&&!ne,void 0!==E),ie=(0,r.v6)(_),re=ie?(0,i.DH)(e):void 0,ce=ie?_.previewBlobUrl:void 0,le=(0,u.Z)((0,i.Ti)(e,"pictogram"),!q),de=T&&Boolean(_.mediaType)&&(s.wGh.has(_.mimeType)||s.oGt.has(_.mimeType)),me=(0,m.Z)((()=>{R({message:e})})),ue=(0,m.Z)((()=>{ae?k&&k():M?A({message:e}):oe?K(!1):de?T():f.has(W)&&N?$():me()})),he=(0,m.Z)((()=>{O({shouldWarnAboutSvg:!U}),F(),me()})),pe=(0,m.Z)((()=>{x(e.id,e.chatId)}));return a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(g.Z,{ref:L,name:V,extension:W,size:z,timestamp:y?b||H:void 0,thumbnailDataUri:re,previewData:ce||le,smaller:n,isTransferring:oe,isUploading:ae,transferProgress:se,className:C,sender:S,isSelectable:I,isSelected:w,actionIcon:de?(0,i.hC)(e)?"play":"eye":"download",onClick:ue,onDateClick:x?pe:void 0}),a.ZP.createElement(Z.Z,{isOpen:D,onClose:F,confirmHandler:he},B("lng_launch_svg_warning"),a.ZP.createElement(p.Z,{className:"dialog-checkbox",checked:U,label:B("lng_launch_exe_dont_ask"),onCheck:j})))}))},78780:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(46752),s=n(32340),i=n(59107);const r=({content:e,className:t})=>{const n=(0,i.Z)();return a.ZP.createElement("span",{className:(0,o.Z)("DotAnimation",t),dir:n.isRtl?"rtl":"auto"},(0,s.Z)(e),a.ZP.createElement("span",{className:"ellipsis"}))}},47002:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(60748),o=n(46752),s=n(790),i=n(97184),r=n(15376),c=n(74399),l=n(32340),d=n(42797),m=n(15866),u=n(59107),h=n(70692),p=n(31212),Z=n(8337),g=n(39196);const f=(0,a.X$)((({ref:e,name:t,size:n,extension:f="",timestamp:v,sender:P,thumbnailDataUri:E,previewData:y,className:b,smaller:C,isTransferring:S,isUploading:w,isSelectable:I,isSelected:N,transferProgress:M,actionIcon:k,onClick:T,onDateClick:x})=>{const A=(0,u.Z)();let R=(0,a.sO)(null);e&&(R=e);const{isMobile:O}=(0,d.ZP)(),[L]=(0,a.eJ)(!y),B=Boolean(y),D=(0,m.Z)(E,B,O&&!i.vX),$=(0,h.Z)(!B),{shouldRender:F,transitionClassNames:U}=(0,p.Z)(S,void 0,!0),j=(0,r.Oh)(f),_=(0,r.yW)(n),V=(0,a.Ye)((()=>S&&M?`${(0,r.yW)(n*M)} / ${_}`:_),[S,n,_,M]),{width:z,height:H}=(0,c.lE)(C),W=(0,o.Z)("File",b,C&&"smaller",T&&!w&&"interactive",N&&"file-is-selected");return a.ZP.createElement("div",{ref:R,className:W,dir:A.isRtl?"rtl":void 0},I&&a.ZP.createElement("div",{className:"message-select-control"},N&&a.ZP.createElement("i",{className:"icon icon-select"})),a.ZP.createElement("div",{className:"file-icon-container",onClick:w?void 0:T},E||y?a.ZP.createElement("div",{className:"file-preview media-inner"},a.ZP.createElement("img",{src:y,className:"full-media",width:z,height:H,draggable:!1,alt:""}),L&&a.ZP.createElement("canvas",{ref:D,className:(0,o.Z)("thumbnail",$)})):a.ZP.createElement("div",{className:`file-icon ${j}`},f.length<=4&&a.ZP.createElement("span",{className:"file-ext",dir:"auto"},f)),F&&a.ZP.createElement("div",{className:(0,o.Z)("file-progress",j,U)},a.ZP.createElement(g.Z,{progress:M,size:C?"s":"m",onClick:w?T:void 0})),T&&a.ZP.createElement("i",{className:(0,o.Z)("action-icon","icon",k?`icon-${k}`:"icon-download",F&&"hidden")})),a.ZP.createElement("div",{className:"file-info"},a.ZP.createElement("div",{className:"file-title",dir:"auto",title:t},(0,l.Z)(t)),a.ZP.createElement("div",{className:"file-subtitle",dir:"auto"},a.ZP.createElement("span",null,V),P&&a.ZP.createElement("span",{className:"file-sender"},(0,l.Z)(P)),!P&&Boolean(v)&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("span",{className:"bullet"}),a.ZP.createElement(Z.Z,{onClick:x},(0,s.ZK)(A,1e3*v,!0))))),P&&Boolean(v)&&a.ZP.createElement(Z.Z,{onClick:x},(0,s.VX)(A,1e3*v)))}))},98799:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(60748),o=n(33555),s=n(91713),i=n(4463),r=n(7054),c=n(46752),l=n(74399),d=n(32340),m=n(59107),u=n(25190),h=n(2255),p=n(70172),Z=n(78780),g=n(2153),f=n(65979),v=n(2995),P=n(68729);const E=2.5*l.Gw,y=(0,a.X$)((0,o.c$)(((e,{chatId:t,threadId:n})=>{const a=(0,r.Z1J)(e,t),o=n?(0,r.tZg)(e,t,n):void 0,s=a?(0,r.YK0)(e,a):void 0,i=Boolean((0,r.Zwk)(e,t)),c=n?a?.topics?.[n]:void 0;return{chat:a,threadInfo:o,onlineCount:s,topic:c,areMessagesLoaded:i,messagesCount:c&&(0,r.xxG)(e,t,n),self:(0,r.dyD)(e,e.currentUserId)}}))((({typingStatus:e,className:t,statusIcon:n,avatarSize:r="medium",noAvatar:l,status:y,withDots:b,withMediaViewer:C,withUsername:S,withFullInfo:w,withUpdatingStatus:I,withChatType:N,threadInfo:M,noRtl:k,chat:T,onlineCount:x,areMessagesLoaded:A,topic:R,messagesCount:O,noStatusOrTyping:L,withStory:B,storyViewerOrigin:D,noEmojiStatus:$,emojiStatusSize:F,isSavedDialog:U,self:j,onClick:_,onEmojiStatusClick:V})=>{const{loadFullChat:z,openMediaViewer:H,loadProfilePhotos:W}=(0,o.Sv)(),q=(0,m.Z)(),G=T&&(0,i.ZV)(T),Y=Boolean(T?.isForum&&M&&R),{id:X,isMin:K,isRestricted:J}=T||{};(0,a.d4)((()=>{X&&!K&&(w&&z({chatId:X}),C&&W({profileId:X}))}),[X,K,w,z,W,G,C]);const Q=(0,u.Z)(((e,t)=>{T&&t&&(e.stopPropagation(),H({avatarOwnerId:T.id,mediaId:0,origin:"jumbo"===r?s.bZ.ProfileAvatar:s.bZ.MiddleHeaderAvatar}))})),ee=(0,a.Ye)((()=>T&&S&&(0,i.WS)(T)),[T,S]);if(T)return a.ZP.createElement("div",{className:(0,c.Z)("ChatInfo",t),dir:!k&&q.isRtl?"rtl":void 0,onClick:_},!l&&!Y&&a.ZP.createElement(a.ZP.Fragment,null,U&&j&&a.ZP.createElement(p.Z,{key:"saved-messages",size:r,peer:j,isSavedMessages:!0,className:"saved-dialog-avatar"}),a.ZP.createElement(p.Z,{key:T.id,className:(0,c.Z)(U&&"overlay-avatar"),size:r,peer:T,withStory:B,storyViewerOrigin:D,storyViewerMode:"single-peer",isSavedDialog:U,onClick:C?Q:void 0})),Y&&a.ZP.createElement(v.Z,{topic:R,className:"topic-header-icon",size:E}),a.ZP.createElement("div",{className:"info"},R?a.ZP.createElement("h3",{dir:"auto",className:"fullName"},(0,d.Z)(R.title)):a.ZP.createElement(g.Z,{peer:T,emojiStatusSize:F,withEmojiStatus:!$,isSavedDialog:U,onEmojiStatusClick:V}),!L&&function(){if(y)return b?a.ZP.createElement(Z.Z,{className:"status",content:y}):a.ZP.createElement("span",{className:"status",dir:"auto"},n&&a.ZP.createElement(f.Z,{className:"status-icon",name:n}),(0,d.Z)(y));if(I&&!A&&!J)return a.ZP.createElement(Z.Z,{className:"status",content:q("Updating")});if(!T)return;if(e)return a.ZP.createElement(P.Z,{typingStatus:e});if(Y)return a.ZP.createElement("span",{className:"status",dir:"auto"},a.ZP.createElement(h.ZP,{name:"fade",shouldRestoreHeight:!0,activeKey:void 0!==O?1:2,className:"message-count-transition"},void 0!==O&&q("messages",O,"i")));if(N)return a.ZP.createElement("span",{className:"status",dir:"auto"},q((0,i.l6)(T)));const t=function(e,t){const n=e((0,i.l6)(t)),{membersCount:a}=t;return t.isRestricted?"Channel"===n?"channel is inaccessible":"group is inaccessible":a?e("Channel"===n?"Subscribers":"Members",a,"i"):n}(q,T),o=x?`, ${q("OnlineCount",x,"i")}`:void 0;return a.ZP.createElement("span",{className:"status"},ee&&a.ZP.createElement("span",{className:"handle withStatus"},ee),a.ZP.createElement("span",{className:"group-status"},t),o&&a.ZP.createElement("span",{className:"online-status"},o))}()))})))},76844:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(790),s=n(59107),i=n(8018);const r=(0,a.X$)((({message:e,outgoingStatus:t,draftDate:n})=>{const r=(0,s.Z)(),c=n&&n>e.date;return a.ZP.createElement("div",{className:"LastMessageMeta"},t&&!c&&a.ZP.createElement(i.Z,{status:t}),a.ZP.createElement("span",{className:"time"},(0,o.VX)(r,1e3*(c?n:e.date))))}))},12007:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(60748),o=n(33555),s=n(46752),i=n(64319),r=n(42797),c=n(59107),l=n(25190),d=n(231),m=n(53106),u=n(58964),h=n(65979);const p=(0,a.X$)((({title:e,link:t,isDisabled:n,className:p,withShare:Z,onRevoke:g})=>{const f=(0,c.Z)(),{showNotification:v,openChatWithDraft:P}=(0,o.Sv)(),{isMobile:E}=(0,r.ZP)(),y=!g,b=(0,l.Z)((()=>{(0,i.TE)(t),v({message:f("LinkCopied")})})),C=(0,l.Z)((()=>{n||b()})),S=(0,l.Z)((()=>{P({text:t})})),w=(0,a.Ye)((()=>({onTrigger:e,isOpen:t})=>a.ZP.createElement(d.Z,{round:!0,ripple:!E,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:f("AccDescrOpenMenu2")},a.ZP.createElement("i",{className:"icon icon-more"}))),[E,f]);return a.ZP.createElement("div",{className:p},a.ZP.createElement("p",{className:"vCMpiQTJ"},f(e||"InviteLink.InviteLink")),a.ZP.createElement("div",{className:"xNjJHI7j"},a.ZP.createElement("input",{className:(0,s.Z)("form-control","Ag6k_p7b"),value:t,readOnly:!0,onClick:C}),y?a.ZP.createElement(d.Z,{color:"translucent",className:"obuPXobw",size:"smaller",round:!0,disabled:n,onClick:C},a.ZP.createElement(h.Z,{name:"copy"})):a.ZP.createElement(m.Z,{className:"p7t3macG",trigger:w,positionX:"right"},a.ZP.createElement(u.Z,{icon:"copy",onClick:C,disabled:n},f("Copy")),g&&a.ZP.createElement(u.Z,{icon:"delete",onClick:g,destructive:!0},f("RevokeButton")))),Z&&a.ZP.createElement(d.Z,{size:"smaller",disabled:n,onClick:S},f("FolderLinkScreen.LinkActionShare")))}))},13709:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(60748),o=n(4463),s=n(46752),i=n(790),r=n(3858),c=n(60706),l=n(3657),d=n(25190),m=n(6202),u=n(70692),h=n(62230);const p=(0,a.X$)((({message:e,idPrefix:t="shared-media",isProtected:n,observeIntersection:p,onClick:Z})=>{const g=(0,a.sO)(null),f=(0,l.Op)(g,p),v=(0,o.DH)(e),P=(0,m.Z)((0,o.Ti)(e,"pictogram"),!f),E=(0,u.Z)(P),y=(0,o.b7)(e),b=(0,o.NE)(e),[C,,S]=(0,c.Z)(b),w=(0,d.Z)((()=>{S(),Z(e.id,e.chatId)}));return a.ZP.createElement("div",{ref:g,id:`${t}${(0,o.d0)(e.id)}`,className:"Media scroll-item",onClick:Z?w:void 0},a.ZP.createElement("img",{src:v,className:"media-miniature",alt:"",draggable:!n,decoding:"async",onContextMenu:n?r.Z:void 0}),a.ZP.createElement("img",{src:P,className:(0,s.Z)("full-media","media-miniature",E),alt:"",draggable:!n,decoding:"async",onContextMenu:n?r.Z:void 0}),b&&a.ZP.createElement(h.Z,{thumbDataUri:P||v,isVisible:C,className:"media-spoiler"}),y&&a.ZP.createElement("span",{className:"video-duration"},y.isGif?"GIF":(0,i.k9)(y.duration)),n&&a.ZP.createElement("span",{className:"protector"}))}))},62230:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(46752),s=n(15866),i=n(25190),r=n(31212);const c=(0,a.X$)((({isVisible:e,withAnimation:t,thumbDataUri:n,className:c,width:l,height:d})=>{const m=(0,a.sO)(null),{shouldRender:u,transitionClassNames:h}=(0,r.Z)(e,void 0,!0,!t&&void 0,void 0,500),p=(0,s.Z)(n,!u,void 0,25,l,d),Z=(0,i.Z)((e=>{if(!m.current)return;const t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top,o=n-t.width/2,s=a-t.height/2;m.current.setAttribute("style",`--click-shift-x: ${o}px; --click-shift-y: ${s}px`)}));if(u)return a.ZP.createElement("div",{className:(0,o.Z)("qF2WgYVg",h,c,t&&"pNM3cgkY"),ref:m,onClick:t?Z:void 0},a.ZP.createElement("canvas",{ref:p,className:"eULqS2yR",width:l,height:d}),a.ZP.createElement("div",{className:"XBor45hE"}))}))},8018:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(2255),s=function(e){return e[e.failed=0]="failed",e[e.pending=1]="pending",e[e.succeeded=2]="succeeded",e[e.read=3]="read",e}(s||{});const i=(0,a.X$)((({status:e})=>a.ZP.createElement("div",{className:"MessageOutgoingStatus"},a.ZP.createElement(o.ZP,{name:"reveal",activeKey:s[e]},"failed"===e?a.ZP.createElement("div",{className:"MessageOutgoingStatus--failed"},a.ZP.createElement("i",{className:"icon icon-message-failed"})):a.ZP.createElement("i",{className:`icon icon-message-${e}`})))))},47262:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(46752),s=n(32340),i=n(59107),r=n(31212);const c=(0,a.X$)((({text:e="Nothing found.",description:t})=>{const n=(0,i.Z)(),{transitionClassNames:c}=(0,r.Z)(!0);return a.ZP.createElement("div",{className:(0,o.Z)("NothingFound",c,t&&"with-description")},e,t&&a.ZP.createElement("p",{className:"description"},(0,s.Z)(n(t),["br"])))}))},99364:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(60748),o=n(83716),s=n(57710),i=n(46752),r=n(3858),c=n(97184),l=n(49488),d=n(42797),m=n(59107),u=n(231);const h=(0,a.X$)((({isLoading:e=!1,isPasswordVisible:t,error:n,hint:h,placeholder:p="Password",submitLabel:Z="Next",description:g,shouldShowSubmit:f,shouldResetValue:v,shouldDisablePasswordManager:P=!1,noRipple:E=!1,clearError:y,onChangePasswordVisibility:b,onInputChange:C,onSubmit:S})=>{const w=(0,a.sO)(null),I=(0,m.Z)(),{isMobile:N}=(0,d.ZP)(),[M,k]=(0,a.eJ)(""),[T,x]=(0,a.eJ)(!1),A=N?550:400;return(0,a.d4)((()=>{v&&k("")}),[v]),(0,l.Z)((()=>{c.$b||w.current.focus()}),A),(0,a.d4)((()=>{n&&(0,s.WM)((()=>{w.current.focus(),w.current.select()}))}),[n]),a.ZP.createElement("form",{action:"",onSubmit:S?function(t){t.preventDefault(),e||T&&S(M)}:r.Z,autoComplete:"off"},a.ZP.createElement("div",{className:(0,i.Z)("input-group password-input",M&&"touched",n&&"error"),dir:I.isRtl?"rtl":void 0},P&&a.ZP.createElement("input",{type:"password",id:"prevent_autofill",autoComplete:"off",className:"visually-hidden",tabIndex:-2}),a.ZP.createElement("input",{ref:w,className:"form-control",type:t?"text":"password",id:"sign-in-password",value:M||"",autoComplete:P?"one-time-code":"current-password",onChange:function(e){n&&y();const{target:t}=e;k(t.value),x(t.value.length>=o.loe),C&&C(t.value)},maxLength:256,dir:"auto"}),a.ZP.createElement("label",null,n||h||p),a.ZP.createElement("div",{className:"div-button toggle-password",onClick:function(){b(!t)},role:"button",tabIndex:0,title:"Toggle password visibility","aria-label":"Toggle password visibility"},a.ZP.createElement("i",{className:(0,i.Z)("icon",t?"icon-eye":"icon-eye-closed")}))),g&&a.ZP.createElement("p",{className:"description"},g),S&&(T||f)&&a.ZP.createElement(u.Z,{type:"submit",ripple:!E,isLoading:e,disabled:!T},Z))}))},11820:(e,t,n)=>{n.d(t,{Z:()=>P});var a=n(60748),o=n(57710),s=n(4463),i=n(46752),r=n(70735),c=n(27407),l=n(59107),d=n(25190),m=n(14605),u=n(21273),h=n(97687),p=n(31876),Z=n(34288),g=n(98799),f=n(49187),v=n(6058);const P=(0,a.X$)((({className:e,itemIds:t,selectedIds:n,filterValue:P,filterPlaceholder:E,notFoundText:y,searchInputId:b,isLoading:C,noScrollRestore:S,isSearchable:w,isRoundCheckbox:I,lockedIds:N,forceShowSelf:M,isViewOnly:k,onSelectedIdsChange:T,onFilterChange:x,onDisabledClick:A,onLoadMore:R})=>{const O=(0,a.sO)(null),L=n.length>10;(0,a.d4)((()=>{w&&setTimeout((()=>{(0,o.i$)((()=>{O.current.focus()}))}),500)}),[w]);const[B,D]=(0,a.Ye)((()=>{if(!N?.length)return[r.D,n];const e=n.filter((e=>!N.includes(e)));return[N,e]}),[n,N]),$=(0,a.Ye)((()=>new Set(N)),[N]),F=(0,a.Ye)((()=>t.sort(((e,t)=>{const n=$.has(e),a=$.has(t);return n&&!a?-1:!n&&a?1:0}))),[t,$]),U=(0,d.Z)((e=>{if($.has(e))return void A?.(e);const t=n.slice();t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),T?.(t),x?.("")})),j=(0,d.Z)((e=>{const{value:t}=e.currentTarget;x?.(t)})),[_,V]=(0,c.Z)(R,F,Boolean(P)),z=(0,l.Z)();return a.ZP.createElement("div",{className:(0,i.Z)("Picker",e)},w&&a.ZP.createElement("div",{className:"picker-header custom-scroll",dir:z.isRtl?"rtl":void 0},B.map(((e,t)=>a.ZP.createElement(f.Z,{peerId:e,isMinimized:L&&t<n.length-5,forceShowSelf:M,onClick:U,clickArg:e}))),D.map(((e,t)=>a.ZP.createElement(f.Z,{peerId:e,isMinimized:L&&t+B.length<n.length-5,canClose:!0,onClick:U,clickArg:e}))),a.ZP.createElement(h.Z,{id:b,ref:O,value:P,onChange:j,placeholder:E||z("SelectChat")})),_?.length?a.ZP.createElement(u.Z,{className:(0,i.Z)("picker-list","custom-scroll",I&&"withRoundedCheckbox"),items:_,onLoadMore:V,noScrollRestore:S},_.map((e=>{const t=()=>k?void 0:a.ZP.createElement(m.Z,{label:"",disabled:$.has(e),checked:n.includes(e),round:I});return a.ZP.createElement(p.Z,{key:e,className:(0,i.Z)("chat-item-clickable picker-list-item",I&&"chat-item"),disabled:$.has(e),inactive:k,allowDisabledClick:Boolean(A),onClick:()=>U(e),ripple:!0},I?void 0:t(),(0,s.YC)(e)?a.ZP.createElement(v.Z,{forceShowSelf:M,userId:e}):a.ZP.createElement(g.Z,{chatId:e}),I?t():void 0)}))):C||!_||_.length?a.ZP.createElement(Z.Z,null):a.ZP.createElement("p",{className:"no-results"},y||"Sorry, nothing found."))}))},49187:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(60748),o=n(33555),s=n(4463),i=n(7054),r=n(46752),c=n(33780),l=n(32340),d=n(59107),m=n(70172);const u=(0,a.X$)((0,o.c$)(((e,{peerId:t,forceShowSelf:n})=>{if(!t)return{};const a=(0,i.Z1J)(e,t),o=(0,i.dyD)(e,t);return{chat:a,user:o,isSavedMessages:!n&&o&&o.isSelf}}))((({icon:e,title:t,isMinimized:n,canClose:o,clickArg:i,chat:u,user:h,className:p,fluid:Z,isSavedMessages:g,withPeerColors:f,onClick:v})=>{const P=(0,d.Z)();let E,y;if(e&&t)E=a.ZP.createElement("div",{className:"item-icon"},a.ZP.createElement("i",{className:(0,r.Z)("icon",`icon-${e}`)})),y=t;else if(h||u){E=a.ZP.createElement(m.Z,{peer:h||u,size:"small",isSavedMessages:g});const e=!u||h&&!g?(0,s.Vl)(h):(0,s.U)(P,u,g);y=e?(0,l.Z)(e):void 0}const b=(0,r.Z)("PickerSelectedItem",p,u?.isForum&&"forum-avatar",n&&"minimized",o&&"closeable",Z&&"fluid",f&&(0,c.D)(u||h));return a.ZP.createElement("div",{className:b,onClick:()=>v(i),title:n?y:void 0,dir:P.isRtl?"rtl":void 0},E,!n&&a.ZP.createElement("div",{className:"item-name",dir:"auto"},y),o&&a.ZP.createElement("div",{className:"item-remove"},a.ZP.createElement("i",{className:"icon icon-close"})))})))},66:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(60748),o=n(46752),s=n(80036),i=n(59107),r=n(65979);const c="_b5HgBXr",l="P6mch4bB",d=(0,a.X$)((({leftText:e,rightText:t,floatingBadgeText:n,floatingBadgeIcon:d,progress:m,className:u})=>{const h=(0,i.Z)(),p=Boolean(d||n),Z=Boolean(m)&&m>.99,g=m&&(m<.1?0:m>.9?1:.5);return a.ZP.createElement("div",{className:(0,o.Z)("nY2ggBsF",p&&"RYtVQAjM",u),style:(0,s.Z)(void 0!==m&&`--progress: ${m}`,void 0!==g&&`--tail-position: ${g}`)},p&&a.ZP.createElement("div",{className:"dhigNjAq"},a.ZP.createElement("div",{className:"cOpfCGPh"},a.ZP.createElement("div",{className:"uNwBLNOy"},d&&a.ZP.createElement(r.Z,{name:d,className:"MJ7MTmxi"}),n&&a.ZP.createElement("div",{className:"MwzZt3Qo",dir:h.isRtl?"rtl":void 0},n)),a.ZP.createElement("div",{className:"qRwO7SZm"},a.ZP.createElement("svg",{width:"28",height:"28",viewBox:"0 0 28 28",fill:"none"},a.ZP.createElement("path",{d:"m 28,4 v 9 c 0.0089,7.283278 -3.302215,5.319646 -6.750951,8.589815 l -5.8284,5.82843 c -0.781,0.78105 -2.0474,0.78104 -2.8284,0 L 6.7638083,21.589815 C 2.8288652,17.959047 0.04527024,20.332086 0,13 V 4 C 0,4 0.00150581,0.97697493 3,1 5.3786658,1.018266 22.594519,0.9142007 25,1 c 2.992326,0.1067311 3,3 3,3 z",fill:"#7E85FF"}))))),a.ZP.createElement("div",{className:c},a.ZP.createElement("span",null,e)),a.ZP.createElement("div",{className:l},a.ZP.createElement("span",null,t)),a.ZP.createElement("div",{className:(0,o.Z)("sZZV0yoe",Z&&"m8ie8IxL")},a.ZP.createElement("div",{className:c},a.ZP.createElement("span",null,e)),a.ZP.createElement("div",{className:l},a.ZP.createElement("span",null,t))))}))},6058:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(60748),o=n(33555),s=n(91713),i=n(4463),r=n(7054),c=n(46752),l=n(32340),d=n(59107),m=n(25190),u=n(68512),h=n(70172),p=n(78780),Z=n(2153),g=n(65979),f=n(68729);const v=(0,a.X$)((0,o.c$)(((e,{userId:t,forceShowSelf:n})=>{const a=(0,r.dyD)(e,t),o=(0,r.ssc)(e,t),s=!n&&a&&a.isSelf,i=s?a:(0,r.dyD)(e,e.currentUserId);return{user:a,userStatus:o,isSavedMessages:s,areMessagesLoaded:Boolean((0,r.Zwk)(e,t)),self:i}}))((({typingStatus:e,avatarSize:t="medium",status:n,statusIcon:r,withDots:v,withMediaViewer:P,withUsername:E,withStory:y,withFullInfo:b,withUpdatingStatus:C,emojiStatusSize:S,noStatusOrTyping:w,noEmojiStatus:I,noRtl:N,user:M,userStatus:k,self:T,isSavedMessages:x,isSavedDialog:A,areMessagesLoaded:R,adminMember:O,ripple:L,className:B,storyViewerOrigin:D,onEmojiStatusClick:$})=>{const{loadFullUser:F,openMediaViewer:U,loadProfilePhotos:j}=(0,o.Sv)(),_=(0,d.Z)(),{id:V}=M||{};(0,a.d4)((()=>{V&&(b&&F({userId:V}),P&&j({profileId:V}))}),[V,b,P]);const z=(0,m.Z)(((e,n)=>{M&&n&&(e.stopPropagation(),U({avatarOwnerId:M.id,mediaId:0,origin:"jumbo"===t?s.bZ.ProfileAvatar:s.bZ.MiddleHeaderAvatar}))})),H=(0,a.Ye)((()=>M&&E&&(0,i.WS)(M)),[M,E]);if(!M)return;const W=O?O.customTitle||_(O.isOwner?"GroupInfo.LabelOwner":"GroupInfo.LabelAdmin"):void 0;return a.ZP.createElement("div",{className:(0,c.Z)("ChatInfo",B),dir:!N&&_.isRtl?"rtl":void 0},A&&T&&a.ZP.createElement(h.Z,{key:"saved-messages",size:t,peer:T,isSavedMessages:!0,className:"saved-dialog-avatar"}),a.ZP.createElement(h.Z,{key:M.id,size:t,peer:M,className:(0,c.Z)(A&&"overlay-avatar"),isSavedMessages:x,isSavedDialog:A,withStory:y,storyViewerOrigin:D,storyViewerMode:"single-peer",onClick:P?z:void 0}),a.ZP.createElement("div",{className:"info"},W?a.ZP.createElement("div",{className:"info-name-title"},a.ZP.createElement(Z.Z,{peer:M,withEmojiStatus:!I,emojiStatusSize:S,isSavedMessages:x,isSavedDialog:A,onEmojiStatusClick:$}),W&&a.ZP.createElement("span",{className:"custom-title"},W)):a.ZP.createElement(Z.Z,{peer:M,withEmojiStatus:!I,emojiStatusSize:S,isSavedMessages:x,isSavedDialog:A,onEmojiStatusClick:$}),(n||!x&&!w)&&function(){if(n)return v?a.ZP.createElement(p.Z,{className:"status",content:n}):a.ZP.createElement("span",{className:"status",dir:"auto"},r&&a.ZP.createElement(g.Z,{className:"status-icon",name:r}),(0,l.Z)(n));if(C&&!R)return a.ZP.createElement(p.Z,{className:"status",content:_("Updating")});if(!M)return;if(e)return a.ZP.createElement(f.Z,{typingStatus:e});const t=(0,i.Tq)(_,M,k),o=(0,c.Z)("handle",t&&"withStatus");return a.ZP.createElement("span",{className:(0,c.Z)("status",(0,i.kM)(M,k,!0)&&"online")},H&&a.ZP.createElement("span",{className:o},H),t&&a.ZP.createElement("span",{className:"user-status",dir:"auto"},t))}()),L&&a.ZP.createElement(u.Z,null))})))},16568:(e,t,n)=>{n.d(t,{Z:()=>U});var a=n(60748),o=n(33555),s=n(91713),i=n(4463),r=n(7054),c=n(46752),l=n(64963),d=n(70735),m=n(97184),u=n(32340),h=n(59107),p=n(25190),Z=n(87204),g=n(70971),f=n(59187),v=n(40647),P=n(2255),E=n(70172),y=n(2153),b=n(2155),C=n(33780),S=n(42797),w=n(15866),I=n(60706),N=n(6202),M=n(70692),k=n(57080),T=n(49204),x=n(65979);const A=(0,a.X$)((({chat:e,user:t,photo:n,isSavedMessages:o,isSavedDialog:s,canPlayVideo:r,onClick:l})=>{const d=(0,a.sO)(null),p=(0,h.Z)(),{isMobile:Z}=(0,S.ZP)(),g=t&&(0,i.NB)(t),f=e&&(0,i.pK)(e.id),v=e&&(0,i.wo)(e.id),P=t||e,E=P&&!o&&!g&&!f&&!v,{isVideo:y}=n||{},A=E&&(0,i.RT)(P,"normal"),R=(0,N.Z)(A),O=E&&n&&!y&&`photo${n.id}?size=c`,L=(0,N.Z)(O),B=E&&n&&y&&(0,i.Dk)(n),D=(0,N.Z)(B)||L,[$,F]=(0,I.Z)(),U=Boolean(D&&(!y||$)),j=(0,M.Z)(U),_=E&&!U&&!R&&n?.thumbnail?.dataUri,V=(0,w.Z)(n?.thumbnail?.dataUri,!_,Z&&!m.vX),z=n||R||_;(0,a.d4)((()=>{d.current&&!r&&(d.current.currentTime=0)}),[r]);const H=(0,a.Ye)((()=>o?s?"my-notes":"avatar-saved-messages":g?"avatar-deleted-account":f?"reply-filled":v?"author-hidden":void 0),[v,g,s,f,o]);let W;if(H)W=a.ZP.createElement(x.Z,{name:H,role:"img"});else if(z)W=a.ZP.createElement(a.ZP.Fragment,null,_?a.ZP.createElement("canvas",{ref:V,className:"thumb"}):a.ZP.createElement("img",{src:R,draggable:!1,className:"thumb",alt:""}),n&&(y?a.ZP.createElement(k.Z,{canPlay:r,ref:d,src:D,className:(0,c.Z)("avatar-media",j),muted:!0,disablePictureInPicture:!0,loop:!0,playsInline:!0,onReady:F}):a.ZP.createElement("img",{src:D,className:(0,c.Z)("avatar-media",j),alt:""})));else if(t){const e=(0,i.Js)(t);W=e?(0,b.Xv)(e,2):void 0}else if(e){const t=(0,i.U)(p,e);W=t&&(0,b.Xv)(t,(0,i.YC)(e.id)?2:1)}else W=a.ZP.createElement("div",{className:"spinner-wrapper"},a.ZP.createElement(T.Z,{color:"white"}));const q=(0,c.Z)("ProfilePhoto",(0,C.D)(P),o&&"saved-messages",v&&"anonymous-forwards",g&&"deleted-account",f&&"replies-bot-account",!o&&!z&&"no-photo");return a.ZP.createElement("div",{className:q,onClick:z?l:void 0},"string"==typeof W?(0,u.Z)(W,["hq_emoji"]):W)}));var R=n(2995);const O="cpyXyZDl",L="Wm9Ygb23",B="nflKKT3R",D="tFkRrvxe",$="GBGLnrA7",F="ZZRcBh8v",U=(0,a.X$)((0,o.c$)(((e,{userId:t})=>{const{connectionState:n}=e,a=(0,r.dyD)(e,t),o=(0,i.YC)(t),s=(0,r.ssc)(e,t),c=(0,r.Z1J)(e,t),{mediaId:l,avatarOwnerId:d}=(0,r.jUK)(e).mediaViewer,m=c?.isForum,{threadId:u}=(0,r.Btg)(e)||{},h=m&&u?c?.topics?.[u]:void 0,p=o?(0,r.ccz)(e,t):void 0,Z=o?void 0:(0,r.x67)(e,t),g=(a||c)?.emojiStatus,f=g?e.customEmojis.byId[g.documentId]:void 0;return{connectionState:n,user:a,userStatus:s,chat:c,userPersonalPhoto:p?.personalPhoto,userProfilePhoto:p?.profilePhoto,userFallbackPhoto:p?.fallbackPhoto,chatProfilePhoto:Z?.profilePhoto,mediaId:l,avatarOwnerId:d,emojiStatusSticker:f,...h&&{topic:h,messagesCount:(0,r.xxG)(e,t,u)}}}))((({forceShowSelf:e,canPlayVideo:t,user:n,userStatus:r,chat:b,connectionState:C,mediaId:S,avatarOwnerId:w,topic:I,messagesCount:N,userPersonalPhoto:M,userProfilePhoto:k,userFallbackPhoto:T,chatProfilePhoto:x,emojiStatusSticker:U})=>{const{loadFullUser:j,openMediaViewer:_,openPremiumModal:V,openStickerSet:z,openPrivacySettingsNoticeModal:H}=(0,o.Sv)(),W=(0,h.Z)(),{id:q}=n||{},{id:G}=b||{},Y=n?.photos||b?.photos||d.D,X=(0,Z.Z)(S),K=(0,Z.Z)(w),J=(0,g.Y)(S),[Q,ee]=(0,a.eJ)(!0),te=Q?W.isRtl?"slideRtl":"slide":"none",[ne,ae]=(0,a.eJ)(0),oe=Y.length<=1||0===ne,se=Y.length<=1||ne===Y.length-1;(0,a.d4)((()=>{K&&void 0!==X&&void 0===S&&(ee(!1),ae(X))}),[S,X,K]),(0,a.d4)((()=>{ee(!1),ae(J.current||0)}),[J,Y]),(0,a.d4)((()=>{ne>Y.length&&(ee(!1),ae(Math.max(0,Y.length-1)))}),[ne,Y.length]),(0,a.d4)((()=>{"connectionStateReady"===C&&q&&!e&&j({userId:q})}),[q,j,C,e]),function(e,t){(0,a.d4)((()=>{e.slice(t,t+4).forEach((e=>{v.UV(`photo${e.id}?size=c`)||v.he(`photo${e.id}?size=c`,f.IU.BlobUrl)}))}),[t,e])}(Y,ne);const ie=(0,p.Z)((()=>{_({avatarOwnerId:q||G,mediaId:ne,origin:e?s.bZ.SettingsAvatar:s.bZ.ProfileAvatar})})),re=(0,p.Z)((()=>{q?V({fromUserId:q}):z({stickerSetInfo:U.stickerSetInfo})})),ce=(0,p.Z)((()=>{oe||(ee(!0),ae(ne-1))})),le=(0,p.Z)((()=>{se||(ee(!0),ae(ne+1))})),de=(0,p.Z)((()=>{H({chatId:b.id,isReadDate:!1})}));if((0,a.d4)((()=>{const e=document.querySelector(`.${$}`);if(e)return(0,l.sf)(e,{selectorToPreventScroll:".Profile, .settings-content",onSwipe:m.$b?(e,t)=>t===l.eM.Right?(ce(),!0):t===l.eM.Left&&(le(),!0):void 0})}),[le,ce]),n||b)return I?a.ZP.createElement("div",{className:"yzg267rr"},a.ZP.createElement(R.Z,{topic:I,size:120,className:"ZCxp0_t4",letterClassName:"lkfZNWOm",noLoopLimit:!0}),a.ZP.createElement("h3",{className:"umOuiu3K",dir:W.isRtl?"rtl":void 0},(0,u.Z)(I.title)),a.ZP.createElement("p",{className:"tLTzQ2ks"},N?W("Chat.Title.Topic",N,"i"):W("lng_forum_no_messages"))):a.ZP.createElement("div",{className:(0,c.Z)("ProfileInfo",e&&"DnvLcTfv"),dir:W.isRtl?"rtl":void 0},a.ZP.createElement("div",{className:$},function(){if(Y&&!(Y.length<=1))return a.ZP.createElement("div",{className:"uyvKpR3B"},Y.map(((e,t)=>a.ZP.createElement("span",{className:(0,c.Z)("wB4yjvei",t===ne&&"aZmp9FLh")}))))}(),!e&&M&&a.ZP.createElement("div",{className:(0,c.Z)(L,oe&&D)},a.ZP.createElement("div",{className:B},W(M.isVideo?"UserInfo.CustomVideo":"UserInfo.CustomPhoto"))),e&&T&&a.ZP.createElement("div",{className:(0,c.Z)(L,(oe||se)&&D)},a.ZP.createElement("div",{className:B,onClick:function(){oe&&(ee(!0),ae(Y.length-1))}},!se&&a.ZP.createElement(E.Z,{photo:T,className:"R7w3H5eC",size:"mini"}),W(T.isVideo?"UserInfo.PublicVideo":"UserInfo.PublicPhoto"))),a.ZP.createElement(P.ZP,{activeKey:ne,name:te},me),!oe&&a.ZP.createElement("button",{type:"button",dir:W.isRtl?"rtl":void 0,className:(0,c.Z)(F,"RQITz4WQ"),"aria-label":W("AccDescrPrevious"),onClick:ce}),!se&&a.ZP.createElement("button",{type:"button",dir:W.isRtl?"rtl":void 0,className:(0,c.Z)(F,"_0F1Txru"),"aria-label":W("Next"),onClick:le})),a.ZP.createElement("div",{className:"UcyW7tVh",dir:W.isRtl?"rtl":"auto"},(n||b)&&a.ZP.createElement(y.Z,{peer:n||b,withEmojiStatus:!0,emojiStatusSize:24,onEmojiStatusClick:re,noLoopLimit:!0,canCopyTitle:!0}),function(){const e=G||q;if(!(0,i.wo)(e))return n?a.ZP.createElement("div",{className:(0,c.Z)(O,"status",(0,i.kM)(n,r)&&"online")},a.ZP.createElement("span",{className:"_HDVUj4P",dir:"auto"},(0,i.Tq)(W,n,r)),r?.isReadDateRestrictedByMe&&a.ZP.createElement("span",{className:"Qga38M20",onClick:de},a.ZP.createElement("span",null,W("StatusHiddenShow")))):a.ZP.createElement("span",{className:(0,c.Z)(O,"status"),dir:"auto"},(0,i.eA)(b)?W("Subscribers",b.membersCount??0,"i"):W("Members",b.membersCount??0,"i"))}()));function me(e){const o=(Y.length>0?Y[ne]:void 0)||M||k||x||T;return a.ZP.createElement(A,{key:ne,user:n,chat:b,photo:o,canPlayVideo:Boolean(e&&t),onClick:ie})}})))},48198:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(60748),o=n(59187),s=n(4463),i=n(46752),r=n(6202),c=n(70692),l=n(96459),d=n(69123);const m=(0,a.X$)((({reaction:e,availableReactions:t,className:n,size:m,withIconHeart:u,observeIntersection:h})=>{const p="documentId"in e,Z=(0,a.Ye)((()=>t?.find((t=>(0,s.Hl)(t.reaction,e)))),[t,e]),g=Z?.staticIcon?.id,f=(0,r.Z)(`document${g}`,!g,o.IU.BlobUrl),v=(0,c.Z)(f),P="emoticon"in e&&"🦄"===e.emoticon,E=u&&"emoticon"in e&&"❤"===e.emoticon;return p?a.ZP.createElement(l.Z,{documentId:e.documentId,className:(0,i.Z)("ReactionStaticEmoji",n),size:m,observeIntersectionForPlaying:h}):E?a.ZP.createElement("i",{className:"ReactionStaticEmoji icon icon-heart",style:`font-size: ${m}px; width: ${m}px`}):a.ZP.createElement("img",{className:(0,i.Z)("ReactionStaticEmoji",P&&"with-unicorn-fix",v,n),style:m?`width: ${m}px; height: ${m}px`:void 0,src:f||d,alt:Z?.title,draggable:!1})}))},66534:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(60748),o=n(33555),s=n(46752),i=n(59107),r=n(25190),c=n(231),l=n(97687),d=n(34563),m=n(14434);const u=(0,a.X$)((({isOpen:e,subject:t="messages",peerId:n,photo:u,messageIds:h,storyId:p,onClose:Z,onCloseAnimationEnd:g})=>{const{reportMessages:f,reportPeer:v,reportProfilePhoto:P,reportStory:E,exitMessageSelectMode:y}=(0,o.Sv)(),[b,C]=(0,a.eJ)("spam"),[S,w]=(0,a.eJ)(""),I=(0,r.Z)((()=>{switch(t){case"messages":f({messageIds:h,reason:b,description:S}),y();break;case"peer":v({chatId:n,reason:b,description:S});break;case"media":P({chatId:n,photo:u,reason:b,description:S});break;case"story":E({peerId:n,storyId:p,reason:b,description:S})}Z()})),N=(0,r.Z)((e=>{C(e)})),M=(0,r.Z)((e=>{w(e.target.value)})),k=(0,i.Z)(),T=(0,a.Ye)((()=>[{value:"spam",label:k("lng_report_reason_spam")},{value:"violence",label:k("lng_report_reason_violence")},{value:"pornography",label:k("lng_report_reason_pornography")},{value:"childAbuse",label:k("lng_report_reason_child_abuse")},{value:"copyright",label:k("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:k("lng_report_reason_other")}]),[k]);if("messages"===t&&!h||"peer"===t&&!n||"media"===t&&(!n||!u)||"story"===t&&(!p||!n))return;const x=k("messages"===t?"lng_report_message_title":"ReportPeer.Report");return a.ZP.createElement(d.Z,{isOpen:e,onClose:Z,onEnter:e?I:void 0,onCloseAnimationEnd:g,className:(0,s.Z)("narrow","story"===t&&"component-theme-dark"),title:x},a.ZP.createElement(m.Z,{name:"report-message",options:T,onChange:N,selected:b}),a.ZP.createElement(l.Z,{label:k("lng_report_reason_description"),value:S,onChange:M}),a.ZP.createElement("div",{className:"dialog-buttons"},a.ZP.createElement(c.Z,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:I},k("lng_report_button")),a.ZP.createElement(c.Z,{className:"confirm-dialog-button",isText:!0,onClick:Z},k("Cancel"))))}))},2995:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(96459),s=n(58987);const i=(0,a.X$)((({topic:e,className:t,letterClassName:n,size:i,noLoopLimit:r,observeIntersection:c,onClick:l})=>e.iconEmojiId&&"0"!==e.iconEmojiId?a.ZP.createElement(o.Z,{documentId:e.iconEmojiId,className:t,size:i,observeIntersectionForPlaying:c,loopLimit:r?void 0:2,onClick:l}):a.ZP.createElement(s.Z,{iconColor:e.iconColor,title:e.title,topicId:e.id,className:t,letterClassName:n,onClick:l})))},68729:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(60748),o=n(33555),s=n(4463),i=n(7054),r=n(32340),c=n(59107),l=n(78780);const d=(0,a.X$)((0,o.c$)(((e,{typingStatus:t})=>t.userId?{typingUser:(0,i.dyD)(e,t.userId)}:{}))((({typingStatus:e,typingUser:t})=>{const n=(0,c.Z)(),o=t&&!t.isSelf&&(0,s.Vl)(t),i=n(e.action).replace("{user}","").replace("{emoji}",e.emoji||"").trim();return a.ZP.createElement("p",{className:"typing-status",dir:n.isRtl?"rtl":"auto"},o&&a.ZP.createElement("span",{className:"sender-name",dir:"auto"},(0,r.Z)(o)),a.ZP.createElement(l.Z,{content:i}))})))},45418:(e,t,n)=>{n.d(t,{Z:()=>Z});var a=n(60748),o=n(4463),s=n(46752),i=n(790),r=n(48035),c=n(996),l=n(32340),d=n(59107),m=n(25190),u=n(8337),h=n(13709),p=n(10088);const Z=(0,a.X$)((({message:e,senderTitle:t,isProtected:n,observeIntersection:Z,onMessageClick:g})=>{const f=(0,d.Z)();let v=(0,o.s1)(e);if(!v){const t=(0,o.T7)(e);if(t){const{url:n,domain:a}=t;v={siteName:a.replace(/^www./,""),url:n.includes("://")?n:n.includes("@")?`mailto:${n}`:`http://${n}`,formattedDescription:(0,o.UD)(e)!==n?(0,c.e)(f,e,void 0,void 0,170):void 0}}}const P=(0,m.Z)((()=>{g(e.id,e.chatId)}));if(!v)return;const{siteName:E,url:y,displayUrl:b,title:C,description:S,formattedDescription:w,photo:I,video:N}=v,M=!t&&S&&(0,r.Z)(S,170),k=(0,s.Z)("WebLink scroll-item",!I&&!N&&"without-media"),T=y.replace("mailto:","")||b;return a.ZP.createElement("div",{className:k,"data-initial":(E||b)[0],dir:f.isRtl?"rtl":void 0},I&&a.ZP.createElement(h.Z,{message:e,isProtected:n,observeIntersection:Z}),a.ZP.createElement("div",{className:"content"},a.ZP.createElement(u.Z,{isRtl:f.isRtl,className:"site-title",onClick:P},(0,l.Z)(C||E||b)),(M||w)&&a.ZP.createElement(u.Z,{isRtl:f.isRtl,className:"site-description",onClick:P},w||M&&(0,l.Z)(M)),a.ZP.createElement(p.Z,{url:y,className:"site-name",text:T,isRtl:f.isRtl}),t&&a.ZP.createElement("div",{className:"sender-name"},(0,l.Z)(t))),t&&a.ZP.createElement("div",{className:"message-date"},a.ZP.createElement(u.Z,{className:"date",onClick:P,isRtl:f.isRtl},(0,i.VX)(f,1e3*e.date))))}))},32683:(e,t,n)=>{n.d(t,{Z:()=>S,m:()=>C});var a=n(60748),o=n(4463),s=n(46752),i=n(68368),r=n(74399),c=n(33780),l=n(32340),d=n(4809),m=n(39415),u=n(3657),h=n(59107),p=n(6202),Z=n(2903),g=n(75368),f=n(64261),v=n(65979),P=n(62230),E=n(45370),y=n(41278);const b=({className:e,message:t,replyInfo:n,sender:i,senderChat:b,forwardSender:C,title:S,customText:w,isProtected:I,isInComposer:N,noUserColors:M,chatTranslations:k,requestedChatTranslationLanguage:T,observeIntersectionForLoading:x,observeIntersectionForPlaying:A,onClick:R})=>{const O=(0,a.sO)(null),L=(0,u.Op)(O,x),B=(0,a.Ye)((()=>{const e="message"===n?.type&&n.replyMedia;if(e)return{content:e}}),[n]),D=(0,p.Z)(t&&(0,o.Ti)(t,"pictogram"),!L),$=(0,Z.Z)(t||B),F=Boolean(t&&(0,o.Y5)(t)),U=Boolean(t&&(0,o.NE)(t)),j=Boolean("message"===n?.type&&n.isQuote),_="message"===n?.type?n.replyFrom:void 0,V=t&&(0,o.cT)(t),{translatedText:z}=(0,g.Z)(k,t?.chatId,V?t?.id:void 0,T),H=(0,h.Z)(),W=i?(0,o.OU)(H,i):_?.hiddenUserName||t?.forwardInfo?.hiddenUserName,q=b?(0,o.OU)(H,b):void 0,G=C?(0,o.OU)(H,C):t?.forwardInfo?.hiddenUserName,Y=i&&i.id===C?.id,{handleClick:X,handleMouseDown:K}=(0,m.m)(R);return a.ZP.createElement("div",{ref:O,className:(0,s.Z)("EmbeddedMessage",e,(0,c.D)(i,M,!0),j&&"is-quote",$&&"with-thumb"),dir:H.isRtl?"rtl":void 0,onClick:X,onMouseDown:K},$&&function(e,t,n,o,i){const{width:c,height:l}=(0,r.W7)(),d=t||e;return a.ZP.createElement("div",{className:(0,s.Z)("embedded-thumb",n&&"round")},!i&&a.ZP.createElement("img",{src:d,width:c,height:l,alt:"",className:"pictogram",draggable:!1}),a.ZP.createElement(P.Z,{thumbDataUri:d,isVisible:Boolean(i),width:c,height:l}),o&&a.ZP.createElement("span",{className:"protector"}))}($,D,F,I,U),i?.color?.backgroundEmojiId&&a.ZP.createElement(y.Z,{emojiDocumentId:i.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),a.ZP.createElement("div",{className:"message-text"},a.ZP.createElement("p",{className:(0,s.Z)("embedded-text-wrapper",j&&"multiline")},"message"===n?.type&&n.quoteText?(0,d.H)({text:n.quoteText.text,entities:n.quoteText.entities,noLineBreaks:N}):t?(0,o.FT)(t)?a.ZP.createElement(f.Z,{message:t,isEmbedded:!0,observeIntersectionForLoading:x,observeIntersectionForPlaying:A}):a.ZP.createElement(E.Z,{lang:H,message:t,noEmoji:Boolean($),translatedText:z,observeIntersectionForLoading:x,observeIntersectionForPlaying:A,emojiSize:17}):w||" "),a.ZP.createElement("div",{className:"message-title"},function(){if(S)return(0,l.Z)(S);if(!W)return" ";let e;b&&((0,o.eA)(b)&&(e="channel-filled"),(0,o.Bf)(b)&&(e="group-filled"));const t=b&&b.id===i?.id,s=N&&Boolean(n&&"quoteText"in n&&n?.quoteText);return a.ZP.createElement(a.ZP.Fragment,null,!t&&a.ZP.createElement("span",{className:"embedded-sender"},(0,l.Z)(s?H("ReplyToQuote",W):W)),e&&a.ZP.createElement(v.Z,{name:e,className:"embedded-chat-icon"}),e&&q&&(0,l.Z)(q))}(),G&&!Y&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(v.Z,{name:C?"share-filled":"forward",className:"embedded-origin-icon"}),(0,l.Z)(G)))))},C=(0,i.Z)(b),S=b},41278:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(60748),o=n(57710),s=n(4463),i=n(46752),r=n(71394),c=n(74399),l=n(92085),d=n(59107),m=n(25190),u=n(6202),h=n(78722),p=n(38146),Z=n(60422);const g=[{inline:22,block:38,opacity:.35,scale:.75},{inline:32,block:12,opacity:.3,scale:1},{inline:60,block:22,opacity:.25,scale:.75},{inline:75,block:44,opacity:.25,scale:1},{inline:75,block:2,opacity:.2,scale:.625},{inline:95,block:18,opacity:.2,scale:1},{inline:115,block:38,opacity:.2,scale:.625},{inline:125,block:12,opacity:.1,scale:.75}],f=c.Gw,v=(0,a.X$)((({emojiDocumentId:e,className:t})=>{const n=(0,a.sO)(null),c=(0,a.sO)(null),[v,P]=(0,a.eJ)(),E=(0,p.Z)(),y=(0,d.Z)(),{customEmoji:b}=(0,Z.Z)(e),C=b?(0,s.RK)(b.id):void 0,S=(0,u.Z)(C),w=(0,l.Z)(c);(0,a.d4)((()=>{S&&(0,r.pt)(S).then(P)}),[S]);const I=(0,m.Z)((()=>{const e=n.current;if(!e||!v||!w)return;const t=e.getContext("2d"),{width:a,height:o}=e;t.clearRect(0,0,a,o),g.forEach((({inline:e,block:n,opacity:o,scale:s})=>{const i=(y.isRtl?e:a/E-e)*E,r=n*E,c=f*E;t.save(),t.globalAlpha=o,t.translate(i,r),t.scale(s,s),t.drawImage(v,-c/2,-c/2,c,c),t.restore()}));const s=`${w}${b.isLottie?"ff":"bb"}`;t.save(),t.fillStyle=s,t.globalCompositeOperation="source-atop",t.fillRect(0,0,a,o),t.restore()}));(0,a.d4)((()=>{I()}),[v,y.isRtl,w]);const N=(0,m.Z)(((e,t)=>{const a=n.current;a&&(a.width=e*E,a.height=t*E,a.style.width=`${e}px`,a.style.height=`${t}px`,I())})),M=(0,m.Z)((e=>{const{width:t,height:n}=e.contentRect;(0,o.WM)((()=>{N(t,n)}))}));return(0,h.Z)(c,M),(0,a.d4)((()=>{const e=c.current;if(!e)return;const{width:t,height:n}=e.getBoundingClientRect();(0,o.WM)((()=>{N(t,n)}))}),[E]),a.ZP.createElement("div",{className:(0,i.Z)("pTWe_CYU",t),ref:c},a.ZP.createElement("canvas",{ref:n}))}))},4830:(e,t,n)=>{function a(e,t){const{level:n,boosts:a,currentLevelBoosts:o,nextLevelBoosts:s,hasMyBoost:i}=e,r=t&&a===o&&i;return{currentLevel:r?n-1:n,hasNextLevel:Boolean(s),boosts:a,levelProgress:!s||r?1:(a-o)/(s-o),remainingBoosts:s?s-a:0,isMaxLevel:void 0===s}}n.d(t,{k:()=>a})},996:(e,t,n)=>{n.d(t,{X:()=>l,e:()=>d});var a=n(59187),o=n(4463),s=n(490),i=n(48035),r=n(32340),c=n(4809);function l({message:e,highlight:t,emojiSize:n,isSimple:a,truncateLength:r,isProtected:l,forcePlayback:d,shouldRenderAsHtml:m,isForMediaViewer:u}){const{text:h,entities:p}=e.content.text||{};if(!h){const t=(0,o.UD)(e);return t?[(0,i.Z)(t,r)]:void 0}const Z=(0,s.Tp)(e);return(0,c.H)({text:(0,i.Z)(h,r),entities:p,highlight:t,emojiSize:n,shouldRenderAsHtml:m,containerId:`${u?"mv-":""}${Z}`,isSimple:a,isProtected:l,forcePlayback:d})}function d(e,t,n=!1,s,c=o.lN){const{entities:d}=t.content.text||{},m=d?.some((e=>e.type===a.Vv.Spoiler)),u=d?.some((e=>e.type===a.Vv.CustomEmoji));if(!m&&!u){const a=(0,i.Z)((0,o.MK)(e,t,n),c);return s?(0,r.Z)(a,["emoji","highlight"],{highlight:s}):(0,r.Z)(a)}const h=!n&&(0,o.Eb)(t),p=h?`${h} `:"",Z=l({message:t,highlight:s,isSimple:!0,truncateLength:c}),g=(0,o.Kk)(e,t,Z);return[...(0,r.Z)(p),...Array.isArray(g)?g:[g]].filter(Boolean)}},67263:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(33555),o=n(7054),s=n(60782);const i=3e9,r=3e8;function c(e,t=!1,n){const c=(0,a.Rd)();return(0,s.Xo)(e,(e=>{const a=(0,o.Z1J)(c,e);if(!a)return 0;let s=0;const l=(0,o._If)(c,e);return l&&(s+=l.date),t&&a.isVerified&&(s+=i),n&&n.includes(e)&&(s=Date.now()+r+(n.length-n.indexOf(e))),s}),"desc")}},67427:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(60748),o=n(4463),s=n(46752),i=n(80036),r=n(97184),c=n(6202),l=n(96459);const d="PZAuNVZH",m=(0,a.X$)((({reaction:e,isLottie:t,className:n,particleSize:m,onEnded:u})=>{const h=(0,o.RK)(e.documentId),p=(0,c.Z)(t?void 0:h),Z=(0,a.Ye)((()=>r._G?Array.from({length:7}).map((()=>function(e=20){const t=(e/2+Math.random()*e*3)*(Math.random()>.5?1:-1),n=e+Math.random()*e*4;return`M 0 0 C 0 0 ${t} ${-n-e} ${t} ${n}`}(m))):[]),[m]);if(p||t)return a.ZP.createElement("div",{className:(0,s.Z)("aInga6VW",n),style:(0,i.Z)(Boolean(m)&&`--particle-size: ${m}px`)},Z.map(((n,o)=>{const s=`--offset-path: path('${n}');`;return t?a.ZP.createElement(l.Z,{documentId:e.documentId,className:d,style:s,withSharedAnimation:!0,size:m,onAnimationEnd:0===o?u:void 0}):a.ZP.createElement("img",{src:p,alt:"",className:d,style:s,draggable:!1,onAnimationEnd:0===o?u:void 0})})))}))},36368:(e,t,n)=>{n.d(t,{Z:()=>S});var a=n(60748),o=n(33555),s=n(4463),i=n(7054),r=n(46752),c=n(28712),l=n(74399),d=n(60706),m=n(3657),u=n(25190),h=n(6202),p=n(31212),Z=n(60422),g=n(97799),f=n(96459),v=n(48198),P=n(67427);const E={root:"O9uCTt5C","animated-icon":"HiI6SMxF",animatedIcon:"HiI6SMxF",effect:"NhFcTGja",animating:"ikfZ6Igz",withEffectOnly:"jjRJmHCg"},y=1.5*l.Gw,b=6.5*l.Gw,C=l.Gw,S=(0,a.X$)((0,o.c$)(((e,{containerId:t})=>{const{genericEmojiEffects:n,reactions:a}=e,{activeReactions:o}=(0,i.jUK)(e),s=(0,i.$Yd)(e,"reactionEffects");return{activeReactions:o?.[t],availableReactions:a.availableReactions,genericEffects:n,withEffects:s}}))((({containerId:e,reaction:t,className:n,size:i=y,effectSize:l=b,activeReactions:S,availableReactions:w,genericEffects:I,withEffects:N,withEffectOnly:M,shouldPause:k,shouldLoop:T,loopLimit:x,observeIntersection:A})=>{const{stopActiveReaction:R}=(0,o.Sv)(),O=(0,a.sO)(null),L="documentId"in t,B=(0,a.Ye)((()=>w?.find((e=>(0,s.Hl)(e.reaction,t)))),[w,t]),D=B?.centerIcon?.id,{customEmoji:$}=(0,Z.Z)(L?t.documentId:void 0),F=(0,a.Ye)((()=>{if(!L)return B?.aroundAnimation?.id;if(!$)return;const e=w?.find((e=>e.reaction.emoticon===$.emoji))?.aroundAnimation?.id;return e}),[B,w,$,L]),U=(0,a.Ye)((()=>{if(F)return F;if(!I?.stickers)return;const{stickers:e}=I;return e[Math.floor(Math.random()*e.length)].id}),[F,I]),j=(0,m.Op)(O,A),_=D&&`sticker${D}`,V=U&&`sticker${U}`,z=(0,h.Z)(_,!D),H=(0,h.Z)(V,!U),W=(0,a.Ye)((()=>S?.find((e=>(0,s.Hl)(e,t)))),[S,t]),q=Boolean(N&&W&&(L||z)&&H),G=j&&(q&&!M||T),{shouldRender:Y,transitionClassNames:X}=(0,p.Z)(q,void 0,!0,"slow"),{shouldRender:K,transitionClassNames:J}=(0,p.Z)(G,void 0,!0,"slow"),Q=(0,u.Z)((()=>{R({containerId:e,reaction:t})})),[ee,te,ne]=(0,d.Z)(),ae=!(L||G&&ee),{shouldRender:oe,transitionClassNames:se}=(0,p.Z)(ae,void 0,!0),ie=(0,r.Z)(E.root,Y&&E.animating,M&&E.withEffectOnly,n);return a.ZP.createElement("div",{className:ie,ref:O},!M&&oe&&a.ZP.createElement(v.Z,{className:se,reaction:t,availableReactions:w,size:i,observeIntersection:A}),!M&&L&&a.ZP.createElement(f.Z,{documentId:t.documentId,className:E.customEmoji,size:i,noPlay:k,loopLimit:x,forceAlways:!0,observeIntersectionForPlaying:A}),K&&!L&&a.ZP.createElement(g.Z,{key:`${D}-${i}`,className:(0,r.Z)(E.animatedIcon,J),size:(0,c.gO)(1.9*i),tgsUrl:z,play:j&&!k,noLoop:!T,forceAlways:!0,onLoad:te,onEnded:ne}),Y&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(g.Z,{key:`${U}-${l}`,className:(0,r.Z)(E.effect,X),size:l,tgsUrl:H,play:j,noLoop:!0,forceAlways:!0,onEnded:Q}),L&&!F&&j&&a.ZP.createElement(P.Z,{reaction:t,className:X,particleSize:Math.max(.5*i,C),onEnded:Q})))})))},50742:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"ChatFolderModal",!t);return n?a.ZP.createElement(n,e):void 0}},79347:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"MuteChatModal",!t);return n?a.ZP.createElement(n,e):void 0}},77699:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(60748),o=n(46752),s=n(19369),i=n(2155),r=n(86203),c=n(34076),l=n(40126);const d=(0,a.X$)((({topic:e,chat:t,isPinned:n,isMuted:d,shouldShowOnlyMostImportant:m,wasTopicOpened:u,forceHidden:h,isSavedDialog:p})=>{const{unreadMentionsCount:Z=0,unreadReactionsCount:g=0}=t.isForum?{}:t,f=!n&&e&&!u,v=t.isForum&&!e,P=(0,a.Ye)((()=>v&&t?.topics?Object.values(t.topics).filter((({unreadCount:e})=>e)):void 0),[t,v]),E=(0,a.Ye)((()=>v?d&&P?.filter((e=>!1===e.isMuted)).length||P?.length:(e||t).unreadCount),[t,e,P,v,d]),y=(0,a.Ye)((()=>{const e=t.topics&&Object.values(t.topics).some((e=>!e.isMuted&&e.unreadCount));return d||t.topics&&!e}),[t,d]),b=!e&&t.hasUnreadMark,C=!(0,r.Z)((()=>(0,s.$Z)(h)?h():h),[h])&&Boolean(E||Z||b||n||g||f),S=Boolean((E||b)&&!p),w=(0,o.Z)("ChatBadge",y&&"muted",!S&&n&&"pinned",S&&"unread");return a.ZP.createElement(l.Z,{isCustom:!0,className:"ChatBadge-transition",isOpen:C},function(){const e=g&&a.ZP.createElement("div",{className:(0,o.Z)("ChatBadge reaction",y&&"muted")},a.ZP.createElement("i",{className:"icon icon-heart"})),t=Z&&a.ZP.createElement("div",{className:"ChatBadge mention"},a.ZP.createElement("i",{className:"icon icon-mention"})),s=f&&a.ZP.createElement("div",{className:(0,o.Z)("ChatBadge unopened",y&&"muted")}),r=b||E?a.ZP.createElement("div",{className:w},!b&&a.ZP.createElement(c.Z,{text:(0,i.bi)(E)})):void 0,l=n&&a.ZP.createElement("div",{className:w},a.ZP.createElement("i",{className:"icon icon-pinned-chat"})),d=[s,e,t,r,!r&&!t&&!e&&l].filter(Boolean);return p?l:0!==d.length?1===d.length?d[0]:m?[t,r,e,l].filter(Boolean)[0]:a.ZP.createElement("div",{className:"ChatBadge-wrapper"},d):void 0}())}))},59148:(e,t,n)=>{n.d(t,{Z:()=>de});var a=n(60748),o=n(33555),s=n(91713),i=n(83716),r=n(46752),c=n(16974),l=n(82267),d=n(26103),m=n(97184),u=n(13995),h=n(57710),p=n(87675),Z=n(67360),g=n(25190),f=n(95616),v=n(73541),P=n(27407),E=n(3657),y=n(61204),b=n(21273),C=n(34288),S=n(4463),w=n(60782),I=n(2155),N=n(32340),M=n(59107),k=n(95481),T=n(31876);const x={root:"sG8AAzvK",minimized:"lTOui0dp",button:"bNkLqJf1",title:"rMTpNazX","unread-count":"O7esHjyC",unreadCount:"O7esHjyC",info:"OS2LWzdu",name:"bkCtPuPQ",icon:"f4LUPgr4",avatarWrapper:"RMY__Znz",avatar:"qeb0Aox1",chatsPreview:"_1817Hwgd",unread:"SS39xuL3"},A=(0,a.X$)((({archiveSettings:e,onDragEnter:t,onClick:n})=>{const{updateArchiveSettings:s}=(0,o.Sv)(),c=(0,M.Z)(),l=(0,f.d7)(i.WSp),d=(0,f.yi)(),m=d[i.WSp]?.chatsCount,u=(0,a.Ye)((()=>{if(!l?.length)return c("Loading");const e=(0,o.Rd)().chats.byId;return l.slice(0,5).map(((t,n,o)=>{const s=n===o.length-1,i=e[t];if(!i)return;const l=(0,S.U)(c,i);return a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("span",{className:(0,r.Z)(x.chat,m&&i.unreadCount&&x.unread)},(0,N.Z)(l)),s?"":", ")}))}),[l,c,m]),h=(0,a.Ye)((()=>{const t=!e.isMinimized&&{title:c("lng_context_archive_collapse"),icon:"collapse",handler:()=>{s({isMinimized:!0})}},n=e.isMinimized&&{title:c("lng_context_archive_expand"),icon:"expand",handler:()=>{s({isMinimized:!1})}};return(0,w.oA)([t,n])}),[e.isMinimized,c,s]),p=(0,a.I4)((e=>{e.preventDefault(),t?.()}),[t]);return a.ZP.createElement(T.Z,{onClick:n,onDragEnter:p,className:(0,r.Z)(x.root,e.isMinimized&&x.minimized,"chat-item-clickable","chat-item-archive","padding-top-56px"),buttonClassName:x.button,contextActions:h,withPortalForMenu:!0},e.isMinimized?a.ZP.createElement("div",{className:(0,r.Z)(x.info,"info")},a.ZP.createElement("div",{className:"info-row"},a.ZP.createElement("div",{className:(0,r.Z)("title",x.title)},a.ZP.createElement("h3",{dir:"auto",className:(0,r.Z)(x.name,"fullName")},a.ZP.createElement("i",{className:(0,r.Z)(x.icon,"icon","icon-archive-filled")}),c("ArchivedChats"))),a.ZP.createElement(k.Z,{className:x.unreadCount,text:m?(0,I.bi)(m):void 0}))):a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("div",{className:(0,r.Z)("status",x.avatarWrapper)},a.ZP.createElement("div",{className:(0,r.Z)("Avatar",x.avatar)},a.ZP.createElement("i",{className:"icon icon-archive-filled"}))),a.ZP.createElement("div",{className:(0,r.Z)(x.info,"info")},a.ZP.createElement("div",{className:"info-row"},a.ZP.createElement("div",{className:(0,r.Z)("title",x.title)},a.ZP.createElement("h3",{dir:"auto",className:(0,r.Z)(x.name,"fullName")},c("ArchivedChats")))),a.ZP.createElement("div",{className:"subtitle"},a.ZP.createElement("div",{className:(0,r.Z)("status",x.chatsPreview)},u),a.ZP.createElement(k.Z,{className:x.unreadCount,text:m?(0,I.bi)(m):void 0})))))}));var R=n(59187),O=n(26646),L=n(7054),B=n(15780),D=n(42797),$=n(41470),F=n(75790),U=n(60706),j=n(65116),_=n(19369),V=n(7792);const z=new Map;(0,j.ll)((e=>{for(const[t,{setter:n}]of z)n(t(e))}));var H=n(31212),W=n(44499),q=n(70172),G=n(40329),Y=n(2153),X=n(76844),K=n(66534),J=n(50742),Q=n(79347),ee=n(77699);const te="AA5s1Pu4",ne=(0,a.X$)((({isSelected:e,isActive:t,isMobile:n})=>a.ZP.createElement("div",{className:(0,r.Z)("byPckqUT",t&&"IsUWP16T",e&&!n&&"qy2i51dM")},a.ZP.createElement("div",{className:"nl36F75B"},a.ZP.createElement("div",{className:te}),a.ZP.createElement("div",{className:te}),a.ZP.createElement("div",{className:te}))))),ae=(0,a.X$)((0,o.c$)(((e,{chatId:t,isSavedDialog:n})=>{const a=(0,L.Z1J)(e,t);if(!a)return{currentUserId:e.currentUserId};const o=(0,L.xMv)(e,t,n?"saved":"all"),s=(0,L._If)(e,t,n?"saved":"all"),{senderId:i,isOutgoing:r,forwardInfo:c}=s||{},l=n?c?.fromId:i,d=s&&(0,O.H)(s)?.replyToMsgId,m=l?(0,L.RGZ)(e,l):void 0,u=s?(0,S.N5)(s):void 0,h=u&&d?(0,L.hjO)(e,a.id,d):void 0,{targetUserIds:p,targetChatId:Z}=u||{},g=(0,S.zX)(a),{chatId:f,threadId:v,type:P}=(0,L.Btg)(e)||{},E=t===f&&(n?t===v:v===R._f),y=a.isForum&&t===f||t===(0,L.jUK)(e).forumPanelChatId,b=g?(0,L.dyD)(e,g):void 0,C=g?(0,L.ssc)(e,g):void 0,w=s&&(0,L.p$s)(e,s),I=(0,L.WPz)(e,t,R._f,"typingStatus");return{chat:a,isMuted:(0,S.i4)(a,(0,L.dZI)(e),(0,L.NJL)(e)),lastMessageSender:m,actionTargetUserIds:p,actionTargetChatId:Z,actionTargetMessage:h,draft:(0,L.Mst)(e,t,R._f),isSelected:E,isSelectedForum:y,isForumPanelOpen:(0,L.nd)(e),canScrollDown:E&&"thread"===P,canChangeFolder:(e.chatFolders.orderedIds?.length||0)>1,...r&&s&&{lastMessageOutgoingStatus:(0,L.dTW)(e,s)},user:b,userStatus:C,lastMessageTopic:w,typingStatus:I,withInterfaceAnimations:(0,L.FOo)(e),lastMessage:s,lastMessageId:o,currentUserId:e.currentUserId}}))((({chatId:e,folderId:t,orderDiff:n,animationType:i,isPinned:c,observeIntersection:l,chat:d,isMuted:u,user:h,userStatus:p,actionTargetUserIds:Z,lastMessageSender:f,lastMessageOutgoingStatus:v,actionTargetMessage:P,actionTargetChatId:y,offsetTop:b,draft:C,withInterfaceAnimations:w,isSelected:I,isSelectedForum:N,isForumPanelOpen:M,canScrollDown:k,canChangeFolder:x,lastMessageTopic:A,typingStatus:O,lastMessageId:j,lastMessage:te,isSavedDialog:ae,currentUserId:oe,onDragEnter:se})=>{const{openChat:ie,openSavedDialog:re,toggleChatInfo:ce,focusLastMessage:le,loadTopics:de,openForumPanel:me,closeForumPanel:ue}=(0,o.Sv)(),{isMobile:he}=(0,D.ZP)(),[pe,Ze,ge]=(0,U.Z)(),[fe,ve,Pe]=(0,U.Z)(),[Ee,ye,be]=(0,U.Z)(),[Ce,Se,we]=(0,U.Z)(),[Ie,Ne,Me]=(0,U.Z)(),[ke,Te,xe]=(0,U.Z)(),[Ae,Re,Oe]=(0,U.Z)(),[Le,Be,De]=(0,U.Z)(),{isForum:$e,isForumAsMessages:Fe}=d||{};(0,F.Z)(ae?oe:e,j,te);const{renderSubtitle:Ue,ref:je}=(0,W.Z)({chat:d,chatId:e,lastMessage:te,typingStatus:O,draft:C,actionTargetMessage:P,actionTargetUserIds:Z,actionTargetChatId:y,lastMessageTopic:A,lastMessageSender:f,observeIntersection:l,animationType:i,withInterfaceAnimations:w,orderDiff:n,isSavedDialog:ae}),_e=function(e){let t=z.get(e);if(!t){const[n,a]=(0,_.gQ)(e((0,o.Rd)()));t={clientsCount:0,getter:n,setter:a},z.set(e,t)}return(0,V.Z)((()=>(t.clientsCount++,()=>{t.clientsCount--,t.clientsCount||z.delete(e)}))),t.getter}(L.hqL),Ve=(0,g.Z)((()=>{const t=he&&Fe;if(ae)return re({chatId:e,noForumTopicPanel:!0},{forceOnHeavyAnimation:!0}),void(he&&ce({force:!1}));if($e){if(M)return void ue(void 0,{forceOnHeavyAnimation:!0});if(t||me({chatId:e},{forceOnHeavyAnimation:!0}),!Fe)return}ie({id:e,noForumTopicPanel:t,shouldReplaceHistory:!0},{forceOnHeavyAnimation:!0}),I&&k&&le()})),ze=(0,g.Z)((t=>{t.preventDefault(),se?.(e)})),He=(0,g.Z)((()=>{Ne(),Ze()})),We=(0,g.Z)((()=>{Te(),ve()})),qe=(0,g.Z)((()=>{Re(),ye()})),Ge=(0,g.Z)((()=>{Be(),Se()})),Ye=(0,$.Z)({chat:d,user:h,handleDelete:He,handleMute:We,handleChatFolderChange:qe,handleReport:Ge,folderId:t,isPinned:c,isMuted:u,canChangeFolder:x,isSavedDialog:ae,currentUserId:oe}),Xe=(0,E.Op)(je,d?l:void 0);(0,a.d4)((()=>{Xe&&$e&&d&&void 0===d.listedTopicIds&&de({chatId:e})}),[d,e,$e,Xe]);const Ke=h&&p&&(0,S.kM)(h,p),{hasShownClass:Je}=(0,H.Z)(Ke),Qe=(0,a.Ye)((()=>{if(m.IT)return ae?`#${(0,B.tB)(oe,"thread",e)}`:`#${(0,B.tB)(e,"thread",R._f)}`}),[e,oe,ae]);if(!d)return;const et=h||d,tt=(0,r.Z)("Chat chat-item-clickable",(0,S.YC)(e)?"private":"group",$e&&"forum",I&&"selected",N&&"selected-forum");return a.ZP.createElement(T.Z,{ref:je,className:tt,href:Qe,style:`top: ${b}px`,ripple:!$e&&!he,contextActions:Ye,onClick:Ve,onDragEnter:ze,withPortalForMenu:!0},a.ZP.createElement("div",{className:(0,r.Z)("status","status-clickable")},a.ZP.createElement(q.Z,{peer:et,isSavedMessages:h?.isSelf,isSavedDialog:ae,withStory:!h?.isSelf,withStoryGap:Je,storyViewerOrigin:s.ze.ChatList,storyViewerMode:"single-peer"}),a.ZP.createElement("div",{className:"avatar-badge-wrapper"},a.ZP.createElement("div",{className:(0,r.Z)("avatar-online",Je&&"avatar-online-shown")}),a.ZP.createElement(ee.Z,{chat:d,isMuted:u,shouldShowOnlyMostImportant:!0,forceHidden:_e})),d.isCallActive&&d.isCallNotEmpty&&a.ZP.createElement(ne,{isMobile:he,isSelected:I,isActive:w})),a.ZP.createElement("div",{className:"info"},a.ZP.createElement("div",{className:"info-row"},a.ZP.createElement(Y.Z,{peer:et,withEmojiStatus:!0,isSavedMessages:e===h?.id&&h?.isSelf,isSavedDialog:ae,observeIntersection:l}),u&&!ae&&a.ZP.createElement("i",{className:"icon icon-muted"}),a.ZP.createElement("div",{className:"separator"}),te&&a.ZP.createElement(X.Z,{message:te,outgoingStatus:ae?void 0:v,draftDate:C?.date})),a.ZP.createElement("div",{className:"subtitle"},Ue(),a.ZP.createElement(ee.Z,{chat:d,isPinned:c,isMuted:u,isSavedDialog:ae}))),Ie&&a.ZP.createElement(G.Z,{isOpen:pe,onClose:ge,onCloseAnimationEnd:Me,chat:d,isSavedDialog:ae}),ke&&a.ZP.createElement(Q.Z,{isOpen:fe,onClose:Pe,onCloseAnimationEnd:xe,chatId:e}),Ae&&a.ZP.createElement(J.Z,{isOpen:Ee,onClose:be,onCloseAnimationEnd:Oe,chatId:e}),Le&&a.ZP.createElement(K.Z,{isOpen:Ce,onClose:we,onCloseAnimationEnd:De,peerId:e,subject:"peer"}))})));var oe=n(45601),se=n(231);const ie=(0,a.X$)((0,o.c$)(((e,{folderId:t,folderType:n})=>({chatFolder:t&&"folder"===n?(0,L.MwT)(e,t):void 0,animatedEmoji:(0,L.zB_)(e,"📂")})))((({chatFolder:e,animatedEmoji:t,foldersDispatch:n,onSettingsScreenSelect:o})=>{const i=(0,M.Z)(),{isMobile:r}=(0,D.ZP)(),c=(0,a.I4)((()=>{n({type:"editFolder",payload:e}),o(s.MT.FoldersEditFolderFromChatList)}),[e,n,o]);return a.ZP.createElement("div",{className:"yftKUVDQ"},a.ZP.createElement("div",{className:"UCBfMOiz"},t&&a.ZP.createElement(oe.Z,{sticker:t,size:96})),a.ZP.createElement("h3",{className:"dB9cHelg",dir:"auto"},i("FilterNoChatsToDisplay")),a.ZP.createElement("p",{className:"TJ_liZcJ",dir:"auto"},i(e?"ChatList.EmptyChatListFilterText":"Chat.EmptyChat")),e&&a.ZP.createElement(se.Z,{ripple:!r,fluid:!0,pill:!0,onClick:c,size:"smaller",isRtl:i.isRtl},a.ZP.createElement("i",{className:"icon icon-settings"}),a.ZP.createElement("div",{className:"aL7e0w4t"},i("ChatList.EmptyChatListEditFilter"))))}))),re=new Set(["9","0"]),ce=56;let le;const de=(0,a.X$)((({className:e,folderType:t,folderId:n,isActive:S,isForumPanelOpen:w,canDisplayArchive:I,archiveSettings:N,sessions:M,foldersDispatch:k,onSettingsScreenSelect:T,onLeftColumnContentChange:x,allowAbsoluteHeader:R=!1})=>{const{openChat:O,openNextChat:L,closeForumPanel:B,toggleStoryRibbon:D}=(0,o.Sv)(),$=(0,a.sO)(null),F=(0,a.sO)(!1),U=(0,a.sO)(!0),[j,_]=(0,a.eJ)(0),V="archived"===t,z="all"===t,H="saved"===t,W=z?i.NfV:V?i.WSp:H?i.aV7:n,q=z&&I&&N,G=(0,f.d7)(W);(0,u.Z)(G);const Y=(G?.length||0)*i.rSj,X=q?N?.isMinimized?i.RBO:i.rSj:0,{orderDiffById:K,getAnimationType:J}=(0,y.Z)(G),Q=sessionStorage.getItem("isExpandHeader"),[ee,te]=(0,P.Z)(void 0,G,void 0,i.t_F);(0,a.d4)((()=>{$.current&&setTimeout((()=>{"archived"===t&&$.current?.scrollTo({top:0})}),500)}),[$,Q,t]);const ne=(0,a.Ye)((()=>{const e=Object.values(M||{}),t=e.find((e=>e.isCurrent));return!(!t||(0,l.bp)()-t.dateCreated<i.I0B)&&z&&e.some((e=>e.isUnconfirmed))}),[z,M]);(0,a.d4)((()=>{ne||_(0)}),[ne]),(0,v.y)(S&&G?.length?{"Alt+ArrowUp":e=>{e.preventDefault(),L({targetIndexDelta:-1,orderedIds:G})},"Alt+ArrowDown":e=>{e.preventDefault(),L({targetIndexDelta:1,orderedIds:G})}}:void 0),(0,a.d4)((()=>{if(S&&!H&&G&&m.RM)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){if((m.jm&&e.metaKey||!m.jm&&e.ctrlKey)&&e.code.startsWith("Digit")){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t||re.has(t))return;const n=q&&N&&!N.isMinimized,a=n?-1:0,o=Number(t)+a-1;if(n&&-1===o)return void x?.(s.du.Archived);if(o>G.length-1)return;O({id:G[o],shouldReplaceHistory:!0})}}}),[N,H,S,x,O,L,G,q]);const{observe:oe}=(0,E.S1)({rootRef:$,throttleMs:200}),se=(0,g.Z)((()=>{(0,o.Rd)().isArchivePrevious=!0,x(s.du.Archived),B()})),de=(0,g.Z)((()=>{F.current?F.current=!1:se()})),me=(0,Z.Z)((e=>{F.current?F.current=!1:O({id:e,shouldReplaceHistory:!0})}),[O],500,!0),ue=(0,g.Z)((e=>{const t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top;n<t.width||a<t.y||(F.current=!0)})),he=(0,g.Z)((()=>{D({isShown:!0,isArchived:V})})),pe=(0,g.Z)((()=>{D({isShown:!1,isArchived:V})})),Ze=function(e,t,n,o){const s=(0,a.sO)(null),i=(0,a.sO)(!1),r=(0,a.sO)(0),c=(0,a.sO)(!1),l=(0,a.sO)(!0),d=(0,a.sO)(0),u=(0,a.sO)(!1),f=(0,g.Z)(((t=!1)=>{c.current||s.current&&e.current&&(s.current.style.display="block",e.current.scrollTop=1,m.s$||t||(0,p.n)(e.current),i.current=!0,r.current=1,c.current=!0,l.current=!0)})),v=(0,g.Z)((()=>{c.current&&s.current&&(s.current.style.display="none",c.current=!1)})),P=(0,g.Z)((()=>{if(!e.current)return;if(i.current)return void(i.current=!1);const a=e.current.scrollTop,o=a>r.current,m=a<r.current,p=0===a,Z=Date.now()-d.current;if(s.current){if(p&&!c.current)return void(0,h.x4)(f,[e.current,s.current]);(0,h.x4)(v,s.current)}m&&(l.current&&Z>100||a<0&&u.current)?t?.():o&&a>0&&n?.(),r.current=a,l.current=p,d.current=Date.now(),u.current=o&&a<0})),E=(0,Z.Z)((a=>{if(!e.current)return;const o=e.current;o.scrollHeight>o.offsetHeight||0===a.deltaY||(a.deltaY<0?t?.():n?.())}),[e,t,n],250);return(0,a.d4)((()=>{const t=e.current;if(t)return 0===t.scrollTop&&(0,h.WM)((()=>{f(!0)})),t.addEventListener("scroll",P,{passive:!0}),t.addEventListener("wheel",E,{passive:!0}),()=>{t.removeEventListener("scroll",P),t.removeEventListener("wheel",E)}}),[e,E]),m.cj||o?void 0:a.ZP.createElement("div",{ref:s,className:"overscroll-trigger",key:"overscroll-trigger"})}($,he,pe,H);return a.ZP.createElement(b.Z,{id:"custom-id-chat-list-inf-scroll",className:(0,r.Z)("chat-list custom-scroll",w&&"forum-panel-open",e),ref:$,items:ee,itemSelector:".ListItem:not(.chat-item-archive)",preloadBackwards:i.t_F,withAbsolutePositioning:!0,beforeChildren:Ze,maxHeight:Y+X+j+ce,onLoadMore:te,onDragLeave:ue,onScroll:function(e){if(U.current)return void(0,d.Kf)();clearTimeout(le);const t=document.documentElement,n=e.currentTarget.scrollTop,a=Math.min(100,Math.round(n/ce*100)),o=n>=66||100===a?0:1-.01*a,s=n>=ce||100===a?0:Math.min(ce,(100-a)*ce/100);t.style.setProperty("--disable-tab-click","none"),le=setTimeout((()=>{t.style.setProperty("--disable-tab-click","auto")}),150),sessionStorage.setItem("isExpandHeader",1===o?"true":"false"),t.style.setProperty("--header-translate",`-${a}%`),t.style.setProperty("--tab-folder-translate",`${s}px`),t.style.setProperty("--show-header-opacity",`${o}`)}},q&&a.ZP.createElement(A,{key:"archive",archiveSettings:N,onClick:se,onDragEnter:de}),ee?.length?function(){const e=G.indexOf(ee[0]),t=(0,c.aE)(W)||0;return setTimeout((()=>{if($.current&&U.current&&R){const e=document.getElementById("tl-chat-folders");if(e)e.style.paddingTop=`${window.tlPaddingTop}px`;else{const e=document.querySelector("#custom-id-chat-list-inf-scroll.Transition_slide-active")??document.getElementById("custom-id-chat-list-inf-scroll");e&&(e.style.paddingTop=`${window.tlPaddingTop}px`)}const t=document.getElementById("left-main-header");t&&(t.style.paddingTop=`${window.tlPaddingTop}px`),setTimeout((()=>{$.current&&($.current.scrollTo({top:ce}),setTimeout((()=>{U.current=!1}),200))}),0)}}),0),ee.map(((o,s)=>{const r=e+s<t,l=j+X+(e+s)*i.rSj+(R?ce:0);return a.ZP.createElement(ae,{key:o,teactOrderKey:r?s:(0,c.jK)(o,H),chatId:o,isPinned:r,folderId:n,isSavedDialog:H,animationType:J(o),orderDiff:K[o],offsetTop:l,observeIntersection:oe,onDragEnter:me})}))}():!ee||ee.length||H?a.ZP.createElement(C.Z,{key:"loading"}):a.ZP.createElement(ie,{folderId:n,folderType:t,foldersDispatch:k,onSettingsScreenSelect:T}))}))},59690:(e,t,n)=>{n.d(t,{Z:()=>G});var a=n(60748),o=n(33555),s=n(59187),i=n(83716),r=n(57710),c=n(4463),l=n(7054),d=n(46752),m=n(23989),u=n(64963),h=n(1279),p=n(97184),Z=n(42797),g=n(18674),f=n(46590),v=n(27407),P=n(3657),E=n(59107),y=n(25190),b=n(87204),C=n(61204),S=n(4794),w=n(98799),I=n(59188),N=n(231),M=n(21273),k=n(34288),T=n(74399),x=n(45601);const A={root:"Ky16H_sV","button-text":"W01t9CIf",buttonText:"W01t9CIf",sticker:"c8lE3XW5",title:"wlwD1B1Q",description:"V8OCFHmp","is-ios":"IxW_z_r0",isIos:"IxW_z_r0","is-macos":"OFxKGCEJ",isMacos:"OFxKGCEJ"},R=7*T.Gw,O=(0,a.X$)((0,o.c$)(((e,{chatId:t})=>{const n=(0,l.Z1J)(e,t),a=n&&(n.isCreator||(0,c.VE)(n,"manageTopics"));return{animatedEmoji:(0,l.zB_)(e,"🐣"),canManageTopics:a}}))((({chatId:e,animatedEmoji:t,canManageTopics:n})=>{const{openCreateTopicPanel:s}=(0,o.Sv)(),i=(0,E.Z)(),{isMobile:r}=(0,Z.ZP)(),c=(0,a.I4)((()=>{s({chatId:e})}),[e,s]);return a.ZP.createElement("div",{className:A.root},a.ZP.createElement("div",{className:A.sticker},t&&a.ZP.createElement(x.Z,{sticker:t,size:R})),a.ZP.createElement("h3",{className:A.title,dir:"auto"},i("ChatList.EmptyTopicsTitle")),a.ZP.createElement("p",{className:(0,d.Z)(A.description,A.centered),dir:"auto"},i("ChatList.EmptyTopicsDescription")),n&&a.ZP.createElement(N.Z,{ripple:!r,fluid:!0,onClick:c,size:"smaller",isRtl:i.isRtl},a.ZP.createElement("div",{className:A.buttonText},i("ChatList.EmptyTopicsCreate"))))})));var L=n(26646),B=n(15780),D=n(32340),$=n(60706),F=n(44499),U=n(60782),j=n(76844),_=n(2995),V=n(17551),z=n(31876),H=n(79347),W=n(77699);const q=(0,a.X$)((0,o.c$)(((e,{chatId:t,topic:n,isSelected:a})=>{const o=(0,l.Z1J)(e,t),s=(0,l.hjO)(e,t,n.lastMessageId),{senderId:i,isOutgoing:r}=s||{},d=s&&(0,L.H)(s)?.replyToMsgId,m=i?(0,l.dyD)(e,i)||(0,l.Z1J)(e,i):void 0,u=s?(0,c.N5)(s):void 0,h=u&&d?(0,l.hjO)(e,t,d):void 0,{targetUserIds:p,targetChatId:Z}=u||{},g=(0,l.WPz)(e,t,n.id,"typingStatus"),f=(0,l.Mst)(e,t,n.id),v=(0,l.tZg)(e,t,n.id),P=Boolean(v?.lastReadInboxMessageId),{chatId:E,threadId:y}=(0,l.Btg)(e)||{};return{chat:o,lastMessage:s,actionTargetUserIds:p,actionTargetChatId:Z,actionTargetMessage:h,lastMessageSender:m,typingStatus:g,canDelete:(0,l.nt7)(e,t,n.id),withInterfaceAnimations:(0,l.FOo)(e),draft:f,...r&&s&&{lastMessageOutgoingStatus:(0,l.dTW)(e,s)},canScrollDown:a&&o?.id===E&&y===n.id,wasTopicOpened:P}}))((({topic:e,isSelected:t,chatId:n,chat:s,style:i,lastMessage:r,canScrollDown:l,lastMessageOutgoingStatus:m,observeIntersection:u,canDelete:h,actionTargetMessage:Z,actionTargetUserIds:g,actionTargetChatId:f,lastMessageSender:v,animationType:P,withInterfaceAnimations:b,orderDiff:C,typingStatus:S,draft:w,wasTopicOpened:I})=>{const{openThread:N,deleteTopic:M,focusLastMessage:k,setViewForumAsMessages:T}=(0,o.Sv)(),x=(0,E.Z)(),[A,R,O]=(0,$.Z)(),[L,q,G]=(0,$.Z)(),[Y,X,K]=(0,$.Z)(),[J,Q,ee]=(0,$.Z)(),{isPinned:te,isClosed:ne}=e,ae=e.isMuted||void 0===e.isMuted&&s.isMuted,oe=(0,y.Z)((()=>{X(),R()})),se=(0,y.Z)((()=>{M({chatId:s.id,topicId:e.id})})),ie=(0,y.Z)((()=>{Q(),q()})),{renderSubtitle:re,ref:ce}=(0,F.Z)({chat:s,chatId:n,lastMessage:r,draft:w,actionTargetMessage:Z,actionTargetUserIds:g,actionTargetChatId:f,lastMessageSender:v,lastMessageTopic:e,observeIntersection:u,isTopic:!0,typingStatus:S,animationType:P,withInterfaceAnimations:b,orderDiff:C}),le=(0,y.Z)((()=>{N({chatId:n,threadId:e.id,shouldReplaceHistory:!0}),T({chatId:n,isEnabled:!1}),l&&k()})),de=function({topic:e,chat:t,wasOpened:n,canDelete:s,handleDelete:i,handleMute:r}){const l=(0,E.Z)();return(0,a.Ye)((()=>{const{isPinned:a,isMuted:d,isClosed:m,id:u}=e,h=t.id,{editTopic:p,toggleTopicPinned:Z,markTopicRead:g,updateTopicMutedState:f,openChatInNewTab:v}=(0,o.Sv)(),P=(0,c.GU)(t,e),E=t.isCreator||(0,c.VE)(t,"manageTopics"),y=e.unreadCount||!n?{title:l("MarkAsRead"),icon:"readchats",handler:()=>{g({chatId:h,topicId:u})}}:void 0,b=E?a?{title:l("UnpinFromTop"),icon:"unpin",handler:()=>Z({chatId:h,topicId:u,isPinned:!1})}:{title:l("PinToTop"),icon:"pin",handler:()=>Z({chatId:h,topicId:u,isPinned:!0})}:void 0,C=t.isMuted&&!1!==d||!0===d?{title:l("ChatList.Unmute"),icon:"unmute",handler:()=>f({chatId:h,topicId:u,isMuted:!1})}:{title:`${l("ChatList.Mute")}...`,icon:"mute",handler:r},S=P?m?{title:l("lng_forum_topic_reopen"),icon:"reopen-topic",handler:()=>p({chatId:h,topicId:u,isClosed:!1})}:{title:l("lng_forum_topic_close"),icon:"close-topic",handler:()=>p({chatId:h,topicId:u,isClosed:!0})}:void 0,w=s?{title:l("lng_forum_topic_delete"),icon:"delete",destructive:!0,handler:i}:void 0;return(0,U.oA)([b,y,C,S,w])}),[e,t,n,l,s,i,r])}({topic:e,chat:s,wasOpened:I,canDelete:h,handleDelete:oe,handleMute:ie});return a.ZP.createElement(z.Z,{className:(0,d.Z)("Fn34Vu_9","Chat",t&&"selected","chat-item-clickable"),onClick:le,style:i,href:p.IT?`#${(0,B.tB)(n,"thread",e.id)}`:void 0,contextActions:de,withPortalForMenu:!0,ref:ce},a.ZP.createElement("div",{className:"info"},a.ZP.createElement("div",{className:"info-row"},a.ZP.createElement("div",{className:(0,d.Z)("title")},a.ZP.createElement(_.Z,{topic:e,className:"oXJl4tra",observeIntersection:u}),a.ZP.createElement("h3",{dir:"auto",className:"fullName"},(0,D.Z)(e.title))),e.isMuted&&a.ZP.createElement("i",{className:"icon icon-muted"}),a.ZP.createElement("div",{className:"separator"}),ne&&a.ZP.createElement("i",{className:(0,d.Z)("icon","icon-lock-badge","MB7Gomjn")}),r&&a.ZP.createElement(j.Z,{message:r,outgoingStatus:m})),a.ZP.createElement("div",{className:"subtitle"},re(),a.ZP.createElement(W.Z,{chat:s,isPinned:te,isMuted:ae,topic:e,wasTopicOpened:I}))),Y&&a.ZP.createElement(V.Z,{isOpen:A,onClose:O,onCloseAnimationEnd:K,confirmIsDestructive:!0,confirmHandler:se,text:x("lng_forum_topic_delete_sure"),confirmLabel:x("Delete")}),J&&a.ZP.createElement(H.Z,{isOpen:L,onClose:G,onCloseAnimationEnd:ee,chatId:n,topicId:e.id}))}))),G=(0,a.X$)((0,o.c$)((e=>{const t=(0,l.jUK)(e).forumPanelChatId,n=t?(0,l.Z1J)(e,t):void 0,{chatId:a,threadId:o}=(0,l.Btg)(e)||{};return{chat:n,currentTopicId:t===a?Number(o):void 0,withInterfaceAnimations:(0,l.FOo)(e)}}),(e=>(0,l.nd)(e)))((({chat:e,currentTopicId:t,isOpen:n,isHidden:l,onTopicSearch:T,onCloseAnimationEnd:x,onOpenAnimationStart:A,withInterfaceAnimations:R})=>{const{closeForumPanel:L,openChatWithInfo:B,loadTopics:D}=(0,o.Sv)(),$=(0,a.sO)(null),F=(0,a.sO)(null),U=(0,a.sO)(null),{isMobile:j}=(0,Z.ZP)();(0,a.d4)((()=>{e&&!e.topics&&D({chatId:e.id})}),[e,D]);const[_,V]=(0,a.eJ)(!1),z=(0,E.Z)(),H=(0,y.Z)((()=>{L()}));(0,a.d4)((()=>{R||n||x?.()}),[R,n,x]);const W=(0,y.Z)((()=>{e&&B({id:e.id,shouldReplaceHistory:!0})})),{observe:G}=(0,P.S1)({rootRef:F,throttleMs:200});(0,P._N)(U,G,(({isIntersecting:e})=>{V(!e)}));const Y=(0,a.Ye)((()=>e?.topics?(0,c.AY)(Object.values(e.topics),e.orderedPinnedTopicIds).map((({id:e})=>e)):[]),[e]),{orderDiffById:X,getAnimationType:K}=(0,C.Z)(Y,e?.id),[J,Q]=(0,v.Z)((()=>{e&&D({chatId:e.id})}),Y,!e?.topicsCount||Y.length>=e.topicsCount,i.C1M),ee=(0,a.sO)(!1),te=n&&!l,ne=(0,b.Z)(te);ne!==te&&(ee.current=!1),(0,f.Z)({isActive:te,onBack:H}),(0,a.d4)((()=>te?(0,m.Z)(H):void 0),[H,te]),(0,a.d4)((()=>{ne!==te&&(0,r.Yq)((()=>{if(!$.current)return;const e=(0,g.YW)();(0,h.L)($.current,e),A?.(),te?(ee.current=!0,$.current.style.transform="none"):(ee.current=!1,$.current.style.transform="")}))}),[te,A,ne]),(0,a.d4)((()=>{if(p.$b)return(0,u.sf)($.current,{selectorToPreventScroll:".chat-list",onSwipe:(e,t)=>t===(z.isRtl?u.eM.Left:u.eM.Right)&&(L(),!0)})}),[L,z.isRtl]);const ae=void 0===e?.topics;return a.ZP.createElement("div",{ref:$,className:(0,d.Z)("MlF2n1nb",_&&"SZ24u3cn",z.isRtl&&"Xs2y1fCE",!R&&"kmDMv6D8"),onTransitionEnd:n?void 0:x},a.ZP.createElement("div",{id:"TopicListHeader",className:"left-header"},a.ZP.createElement(N.Z,{round:!0,size:"smaller",color:"translucent",onClick:H,ariaLabel:z("Close")},a.ZP.createElement("i",{className:"icon icon-close"})),e&&a.ZP.createElement(w.Z,{noAvatar:!0,className:"Sf633zAP",chatId:e.id,onClick:W}),e&&a.ZP.createElement(I.Z,{chatId:e.id,threadId:s._f,messageListType:"thread",canExpandActions:!1,isForForum:!0,isMobile:j,onTopicSearch:T})),e&&a.ZP.createElement(S.Z,{chatId:e.id,hasPinnedOffset:!1,className:"wUpRjGJ2"}),a.ZP.createElement("div",{className:"hGeb3TQJ"}),a.ZP.createElement(M.Z,{className:"chat-list custom-scroll",ref:F,items:J,preloadBackwards:i.C1M,withAbsolutePositioning:!0,maxHeight:(Y?.length||0)*i.oDu,onLoadMore:Q,sensitiveArea:i.BtI,beforeChildren:a.ZP.createElement("div",{ref:U,className:"ERz3fcar"})},Boolean(J?.length)&&function(){const n=Y.indexOf(J[0]);return J?.map(((o,s)=>a.ZP.createElement(q,{key:o,chatId:e.id,topic:e.topics[o],style:`top: ${(n+s)*i.oDu}px;`,isSelected:t===o,observeIntersection:G,animationType:K(o),orderDiff:X[o]})))}(),ae&&!J?.length&&a.ZP.createElement(k.Z,{key:"loading"})),!ae&&1===J?.length&&J[0]===i.OxA&&a.ZP.createElement(O,{chatId:e.id}))})))},9950:(e,t,n)=>{n.d(t,{b:()=>o,w:()=>s});var a=n(60748);let o=function(e){return e[e.Move=0]="Move",e[e.Opacity=1]="Opacity",e[e.None=2]="None",e}({});function s(e){return(0,a.Ye)((()=>{const t=Object.values(e),n=t.filter((e=>e<0)).length,a=t.filter((e=>e>0)).length;return t=>{const s=e[t];return 0===s?o.None:s===1/0||s===-1/0||n<=a&&s<0||a<n&&s>0?o.Opacity:o.Move}}),[e])}},44499:(e,t,n)=>{n.d(t,{Z:()=>T});var a=n(60748),o=n(33555),s=n(83716),i=n(57710),r=n(4463),c=n(26646),l=n(46752),d=n(18005),m=n(32340),u=n(4809),h=n(9950),p=n(75790),Z=n(59107),g=n(6202),f=n(74399),v=n(42797),P=n(39415),E=n(2995);const y="CBda1UmC",b="BhS75ocD",C="uWo2dhui",S="g3XnC73g",w=Number(f.Gw),I=(0,a.X$)((({chat:e,renderLastMessage:t,observeIntersection:n})=>{const{openThread:s}=(0,o.Sv)(),i=(0,a.sO)(null),c=(0,a.sO)(null),d=(0,Z.Z)(),[u,...h]=(0,a.Ye)((()=>e.topics?(0,r.AY)(Object.values(e.topics),void 0,!0).slice(0,3):[]),[e.topics]),[p,g]=(0,a.eJ)(!1),[f,I]=(0,a.eJ)(void 0),{handleClick:N,handleMouseDown:M}=(0,P.m)((t=>{0===u.unreadCount||e.isForumAsMessages||(t.stopPropagation(),t.preventDefault(),s({chatId:e.id,threadId:u.id,shouldReplaceHistory:!0,noForumTopicPanel:(0,v.W7)()}))}));return(0,a.d4)((()=>{const e=i.current,t=c.current;if(!e||!t)return;const n=e.offsetWidth,a=t.offsetWidth;Math.abs(n-a)<w?I(Math.max(n,a)):I(void 0),g(n>a)}),[u,t]),a.ZP.createElement("div",{className:(0,l.Z)("Ow6Ij9O5",p&&"U_yhhC0w",f&&"HV0wCR4O"),dir:d.isRtl?"rtl":void 0,style:f?`--overwritten-width: ${f}px`:void 0},u&&a.ZP.createElement("div",{className:y},a.ZP.createElement("div",{className:(0,l.Z)("lEbV6HrI",u.unreadCount&&b),ref:c,onClick:N,onMouseDown:M},a.ZP.createElement(E.Z,{topic:u,observeIntersection:n}),a.ZP.createElement("div",{className:"k3Ch25ZQ"},(0,m.Z)(u.title)),!f&&p&&a.ZP.createElement("div",{className:C},a.ZP.createElement("div",{className:S}))),a.ZP.createElement("div",{className:"IkuCBmvA"},h.map((e=>a.ZP.createElement("div",{className:(0,l.Z)("d0hTIVJn",e.unreadCount&&b),key:e.id},a.ZP.createElement(E.Z,{topic:e,className:"oknhG11L",observeIntersection:n}),a.ZP.createElement("span",{className:"ZUj3xAjs"},(0,m.Z)(e.title)))))),a.ZP.createElement("div",{className:"_m_2xcPW"})),!u&&a.ZP.createElement("div",{className:(0,l.Z)(y,"L4Zk0yMN")},d("Loading")),a.ZP.createElement("div",{className:(0,l.Z)("KJ16dBus",u?.unreadCount&&b),ref:i,onClick:N,onMouseDown:M},t(),!f&&!p&&a.ZP.createElement("div",{className:C},a.ZP.createElement("div",{className:S}))))}));var N=n(45370),M=n(68729);const k=200;function T({chat:e,lastMessage:t,chatId:n,typingStatus:f,draft:v,actionTargetMessage:P,actionTargetUserIds:E,lastMessageTopic:y,lastMessageSender:b,actionTargetChatId:C,observeIntersection:S,animationType:w,orderDiff:T,withInterfaceAnimations:x,isTopic:A,isSavedDialog:R}){const O=(0,Z.Z)(),L=(0,a.sO)(null),B=t&&(0,r.FT)(t),D=t&&(0,c.H)(t)?.replyToMsgId;(0,p.Z)(n,B?D:void 0,P);const $=t&&!(0,r.bf)(t)?(0,r.DH)(t):void 0,F=(0,g.Z)(t?(0,r.Ti)(t,"micro"):void 0),U=Boolean(t&&(0,r.Y5)(t)),j=(0,a.Ye)((()=>{if(!E)return;const e=(0,o.Rd)().users.byId;return E.map((t=>e[t])).filter(Boolean)}),[E]),_=(0,a.I4)((()=>{if(!R&&f&&t&&f.timestamp>1e3*t.date)return a.ZP.createElement(M.Z,{typingStatus:f});const o=v&&v.replyInfo?.replyToMsgId===y?.id,s=v?.replyInfo&&!v.text&&v.isLocal;if(!e?.isForum&&!R&&v&&!s&&(!A||!o))return a.ZP.createElement("p",{className:"last-message",dir:O.isRtl?"auto":"ltr"},a.ZP.createElement("span",{className:"draft"},O("Draft")),(0,u.H)({text:v.text?.text||"",entities:v.text?.entities,isSimple:!0,withTranslucentThumbs:!0}));if(!t)return;if((0,r.DI)(t))return a.ZP.createElement("p",{className:"last-message shared-canvas-container",dir:O.isRtl?"auto":"ltr"},(0,r.o_)(O,t));if(B){const n=e&&((0,r.eA)(e)||t.senderId===t.chatId);return a.ZP.createElement("p",{className:"last-message shared-canvas-container",dir:O.isRtl?"auto":"ltr"},(0,d.D)(O,t,n?void 0:b,n?e:void 0,j,P,C,y,{isEmbedded:!0},void 0,void 0))}const i=(0,r.zF)(O,n,b);return a.ZP.createElement("p",{className:"last-message shared-canvas-container",dir:O.isRtl?"auto":"ltr"},i&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("span",{className:"sender-name"},(0,m.Z)(i)),a.ZP.createElement("span",{className:"colon"},":")),!R&&t.forwardInfo&&a.ZP.createElement("i",{className:"icon icon-share-filled chat-prefix-icon"}),"story"===t.replyInfo?.type&&a.ZP.createElement("i",{className:"icon icon-story-reply chat-prefix-icon"}),function(e,t,n,o,s){const i=a.ZP.createElement(N.Z,{lang:e,message:t,noEmoji:Boolean(o),observeIntersectionForLoading:n,inChatList:!0});if(!o)return i;const c=(0,r.NE)(t);return a.ZP.createElement("span",{className:"media-preview"},a.ZP.createElement("img",{src:o,alt:"",className:(0,l.Z)("media-preview--image",s&&"round",c&&"media-preview-spoiler"),draggable:!1}),(0,r.b7)(t)&&a.ZP.createElement("i",{className:"icon icon-play"}),i)}(O,t,S,F||$,U))}),[C,P,j,e,n,v,B,U,A,O,t,b,y,F,$,S,f,R]);return(0,a.bt)((()=>{const e=L.current;if(x&&e){if(w===h.b.Opacity)e.style.opacity="0",(0,i.WM)((()=>{e.classList.add("animate-opacity"),e.style.opacity="1"}));else{if(w!==h.b.Move)return;e.style.transform=`translate3d(0, ${-T*s.rSj}px, 0)`,(0,i.WM)((()=>{e.classList.add("animate-transform"),e.style.transform=""}))}setTimeout((()=>{(0,i.WM)((()=>{e.classList.remove("animate-opacity","animate-transform"),e.style.opacity="",e.style.transform=""}))}),k+s.fK3)}}),[x,T,w]),{renderSubtitle:function(){return e?.isForum&&!A?a.ZP.createElement(I,{chat:e,renderLastMessage:_,observeIntersection:S}):_()},ref:L}}},73217:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(65326),s=n(87204);function i(e){const t=(0,o.Z)(),n=(0,a.sO)(e),i=(0,s.Z)(e);return!1===e&&i!==e&&(n.current=!1),{shouldDisableDropdownMenuTransitionRef:n,handleDropdownMenuTransitionEnd:function(){n.current=Boolean(e),t()}}}},61204:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(60782),s=n(9950),i=n(87204);function r(e,t){const n=(0,a.Ye)((()=>{if(e)return e.reduce(((e,t,n)=>(e[t]=n,e)),{})}),[e]),r=(0,i.Z)(n),c=(0,i.Z)(t),l=(0,a.Ye)((()=>n&&r&&t===c?(0,o.Q8)(n,((e,t)=>void 0!==r[t]?e-r[t]:-1/0)):{}),[t,n,c,r]);return{orderDiffById:l,getAnimationType:(0,s.w)(l)}}},91:(e,t,n)=>{n.d(t,{F:()=>o});var a=n(4463);function o(e,t,n,o){const{senderId:s}=t;if(!s)return;const i=(0,a.YC)(s)?o[s]:n[s];let r=(0,a.OU)(e,i);const c=n[t.chatId];return c&&("isSelf"in i&&i.isSelf?r=`${e("FromYou")} → ${(0,a.U)(e,c)}`:(0,a.Bf)(c)&&(r+=` → ${(0,a.U)(e,c)}`)),r}},64261:(e,t,n)=>{n.d(t,{Z:()=>G});var a=n(60748),o=n(33555),s=n(4463),i=n(26646),r=n(7054),c=n(46752),l=n(18005),d=n(32340),m=n(30386),u=n(17240),h=n(75790),p=n(60706),Z=n(3657),g=n(59107),f=n(31212),v=n(45277),P=n(45601),E=n(59187),y=n(91713),b=n(40647),C=n(25190),S=n(6202),w=n(70172),I=n(17551),N=n(66735);const M=(0,a.X$)((({message:e,renderContent:t})=>{const{openMediaViewer:n,uploadProfilePhoto:i,showNotification:r}=(0,o.Sv)(),{isOutgoing:c}=e,l=(0,g.Z)(),[d,m]=(0,a.eJ)(),[u,h,Z]=(0,p.Z)(!1),f=(0,S.Z)((0,s.Ti)(e,"full")),v=e.content.action.photo?.isVideo,P=(0,C.Z)((()=>{r({title:l("ApplyAvatarHintTitle"),message:l("ApplyAvatarHint"),action:{action:"requestNextSettingsScreen",payload:{screen:y.MT.Main}},actionText:l("Open")})})),M=(0,C.Z)((e=>{m(void 0),i({file:e}),P()})),k=(0,C.Z)((()=>{m(void 0)})),T=(0,C.Z)((async()=>{Z(),P();const t=e.content.action.photo,n=await b.he(`videoAvatar${t.id}?size=u`,E.IU.BlobUrl),a=await fetch(n).then((e=>e.blob()));i({file:new File([a],"avatar.mp4"),isVideo:!0,videoTs:t.videoSizes?.find((e=>void 0!==e.videoStartTs))?.videoStartTs})}));return a.ZP.createElement("span",{className:"action-message-suggested-avatar",tabIndex:0,role:"button",onClick:async()=>{!c&&f?v?h():m(await fetch(f).then((e=>e.blob()))):n({chatId:e.chatId,mediaId:e.id,threadId:E._f,origin:y.bZ.SuggestedAvatar})}},a.ZP.createElement(w.Z,{photo:e.content.action.photo,loopIndefinitely:!0,withVideo:v,size:"jumbo"}),a.ZP.createElement("span",null,t()),a.ZP.createElement("span",{className:"action-message-button"},l(v?"ViewVideoAction":"ViewPhotoAction")),a.ZP.createElement(N.Z,{file:d,onClose:k,onChange:M}),a.ZP.createElement(I.Z,{isOpen:u,title:l("SuggestedVideo"),confirmHandler:T,onClose:Z,textParts:t()}))}));var k=n(97182),T=n(2155),x=n(49488),A=n(75851);var R=n(78781),O=n(65979),L=n(231),B=n(74607);const D="d8axZxyN",$="glDpC2av",F="gqCs9fSo",U="gnYhwnvf",j="HWgwnKui",_="BTNQ4KBH",V="Xl9MVMTn",z="Qizai7yv";function H({channel:e}){const{openChat:t}=(0,o.Sv)(),n=function(e,t="#00000000"){const[n,o]=(0,a.eJ)(t),i=(0,S.Z)((0,s.RT)(e),!1,E.IU.BlobUrl);return(0,a.d4)((()=>{(async()=>{if(!i)return;const e=await(0,A.ix)(i);o(`#${(0,A.CO)(e)}`)})()}),[i]),n}(e,"#3C3C4399");return a.ZP.createElement("div",{className:$,onClick:()=>t({id:e.id})},a.ZP.createElement(w.Z,{className:F,key:e.id,size:"large",peer:e}),a.ZP.createElement("div",{style:`background: ${n}`,className:U},a.ZP.createElement("i",{className:(0,c.Z)(D,"icon icon-user-filled")}),a.ZP.createElement("span",{className:j},(0,T.bi)(e?.membersCount||0))),a.ZP.createElement("span",{className:_},e.title))}function W({channel:e,chatId:t,channelsCount:n,isCurrentUserPremium:s}){const{openPremiumModal:i,openChatWithInfo:r}=(0,o.Sv)(),l=(0,g.Z)();return a.ZP.createElement("div",{className:(0,c.Z)($,"MBChXyXk"),onClick:()=>{s?r({id:t,shouldReplaceHistory:!0,profileTab:"similarChannels",forceScrollProfileTab:!0}):i()}},a.ZP.createElement(w.Z,{className:F,key:e.id,size:"large",peer:e}),a.ZP.createElement("div",{className:V},a.ZP.createElement("div",{className:z})),a.ZP.createElement("div",{className:(0,c.Z)(V,"JxSmtOFi")},a.ZP.createElement("div",{className:z})),a.ZP.createElement("div",{className:U},a.ZP.createElement("span",{className:j},`+${n}`),!s&&a.ZP.createElement(O.Z,{name:"lock-badge",className:D})),a.ZP.createElement("span",{className:_},l("MoreSimilar")))}const q=(0,a.X$)((0,o.c$)(((e,{chatId:t})=>{const{similarChannelIds:n,shouldShowInChat:a,count:o}=(0,r.D2x)(e,t)||{};return{similarChannelIds:n,shouldShowInChat:a,count:o,isCurrentUserPremium:(0,r.wVz)(e)}}))((({chatId:e,similarChannelIds:t,shouldShowInChat:n,count:s,isCurrentUserPremium:i})=>{const l=(0,g.Z)(),{toggleChannelRecommendations:d}=(0,o.Sv)(),[m,u,h]=(0,p.Z)(!1),[Z,f,v]=(0,p.Z)(!1),P=(0,a.sO)(null),E=(0,a.Ye)((()=>{if(!t)return;const e=(0,o.Rd)();return t.map((t=>(0,r.Z1J)(e,t))).filter(Boolean)}),[t]),[y,b]=(0,a.eJ)(!t),S=(0,a.Ye)((()=>E?.slice(0,10)),[E]),w=Boolean(S?.length);(0,R.Z)(P,!w||!n||y,!0);const I=Boolean(!y&&(n||Z||m)&&w);(0,x.Z)((()=>b(!1)),2e3),(0,a.d4)((()=>{if(y&&E&&n){const e=setTimeout((()=>{b(!1)}),300);return()=>clearTimeout(e)}}),[E,n,y]);const N=(0,C.Z)((()=>{d({chatId:e}),n?(h(),f()):(u(),v())}));return a.ZP.createElement("div",{className:(0,c.Z)("V3RHiOJR")},a.ZP.createElement("div",{className:"join-text"},a.ZP.createElement("span",{className:(0,c.Z)(w&&"UHAMd4fI"),onClick:w?N:void 0},l("ChannelJoined"))),y&&a.ZP.createElement(B.Z,{className:"xKVZv7KE"}),I&&a.ZP.createElement("div",{className:(0,c.Z)(m&&"eb8rX09E",Z&&"XR6_qLCc")},a.ZP.createElement("div",{className:"tfG_BSDt"},a.ZP.createElement("svg",{width:"19",height:"7",viewBox:"0 0 19 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.ZP.createElement("path",{className:"HVbeGv4t","fill-rule":"evenodd","clip-rule":"evenodd",d:"M19 7C16.8992 7 13.59 3.88897 11.5003 1.67424C10.7648 0.894688 10.397 0.50491 10.0434 0.385149C9.70568 0.270811 9.4225 0.270474 9.08456 0.38401C8.73059 0.50293 8.36133 0.892443 7.62279 1.67147C5.52303 3.88637 2.18302 7 0 7L19 7Z",fill:"white"}))),a.ZP.createElement("div",{className:"njAC8dR9"},a.ZP.createElement("div",{className:"s7QOi22Q"},a.ZP.createElement("span",{className:"JstcOhAN"},l("SimilarChannels")),a.ZP.createElement(L.Z,{className:"meewH7t_",color:"translucent",onClick:N},a.ZP.createElement(O.Z,{name:"close"}))),a.ZP.createElement("div",{ref:P,className:(0,c.Z)("h4gWlNen","no-scrollbar")},S?.map(((t,n)=>9===n?a.ZP.createElement(W,{channel:t,chatId:e,channelsCount:s-10+1,isCurrentUserPremium:i}):a.ZP.createElement(H,{channel:t})))))))}))),G=(0,a.X$)((0,o.c$)(((e,{message:t,threadId:n})=>{const{chatId:a,senderId:o,content:c}=t,l=o,{targetUserIds:d,targetChatId:m}=c.action||{},u=(0,i.H)(t)?.replyToMsgId,h=u?(0,r.hjO)(e,a,u):void 0,p=!!n&&(0,r._XY)(e,t,n),{direction:Z,noHighlight:g}=p&&(0,r.jUK)(e).focusedMessage||{},f=(0,r.Z1J)(e,a),v=f&&((0,s.eA)(f)||l===a),P=!v&&l?(0,r.dyD)(e,l):void 0,E=v?f:void 0,y=m?(0,r.Z1J)(e,m):void 0,b=c.action?.months;return{senderUser:P,senderChat:E,targetChat:y,targetChatId:m,targetUserIds:d,targetMessage:h,isFocused:p,premiumGiftSticker:(0,r.PGA)(e,b),topic:(0,r.p$s)(e,t),canPlayAnimatedEmojis:(0,r.W9H)(e),...p&&{focusDirection:Z,noFocusHighlight:g}}}))((({message:e,isEmbedded:t,appearanceOrder:n=0,isJustAdded:i,isLastInList:r,senderUser:E,senderChat:y,targetUserIds:b,targetMessage:C,targetChatId:S,targetChat:w,isFocused:I,focusDirection:N,noFocusHighlight:T,premiumGiftSticker:x,isInsideTopic:A,topic:R,memoFirstUnreadIdRef:O,canPlayAnimatedEmojis:L,observeIntersectionForReading:B,observeIntersectionForLoading:D,observeIntersectionForPlaying:$,onPinnedIntersectionChange:F})=>{const{openPremiumModal:U,requestConfetti:j,checkGiftCode:_}=(0,o.Sv)(),V=(0,g.Z)(),z=(0,a.sO)(null);(0,Z._N)(z,B),(0,h.Z)(e.chatId,"message"===e.replyInfo?.type?e.replyInfo.replyToMsgId:void 0,C),(0,v.Z)(z,e.chatId,I,N,T,i),(0,a.d4)((()=>{if(e.isPinned)return()=>{F?.({viewportPinnedIdsToRemove:[e.id],isUnmount:!0})}}),[F,e.isPinned,e.id]);const H=n<=0,[W,G]=(0,p.Z)(H),Y=Boolean(e.content.action?.text.startsWith("ActionGift")),X=Boolean(e.content.action?.text.startsWith("BoostingReceivedGift")),K="suggestProfilePhoto"===e.content.action?.type&&e.content.action.photo,J=(0,s.Pt)(e);(0,a.d4)((()=>{H||setTimeout(G,10*n)}),[n,G,H]);const Q=(0,Z.Op)(z,$),ee=(0,a.sO)((()=>{const t=O?.current&&e.id>=O.current;return Y&&!e.isOutgoing&&t})());(0,a.d4)((()=>{Q&&ee.current&&(ee.current=!1,j({}))}),[Q,j]);const{transitionClassNames:te}=(0,f.Z)(W,void 0,H,!1),ne=(0,o.Rd)().users.byId,ae=(0,a.Ye)((()=>b?b.map((e=>ne?.[e])).filter(Boolean):void 0),[b,ne]),oe=(0,a.I4)((()=>(0,l.D)(V,e,E,y,ae,C,S,R,{isEmbedded:t},D,$)),[t,V,e,D,$,y,E,S,C,ae,R]),{isContextMenuOpen:se,contextMenuPosition:ie,handleBeforeContextMenu:re,handleContextMenu:ce,handleContextMenuClose:le,handleContextMenuHide:de}=(0,u.Z)(z),me=void 0!==ie,ue=()=>{const t=e.content.action?.slug;t&&_({slug:t,message:{chatId:e.chatId,messageId:e.id}})};if(A&&"TopicWasCreatedAction"===e.content.action?.text)return a.ZP.createElement("span",{ref:z});if(t)return a.ZP.createElement("span",{ref:z,className:"embedded-action-message"},oe());const he=(0,c.Z)("ActionMessage message-list-item",I&&!T&&"focused",(Y||K)&&"centered-action",me&&"has-menu-open",r&&"last-in-list",te);return a.ZP.createElement("div",{ref:z,id:(0,s.d0)(e.id),className:he,"data-message-id":e.id,"data-is-pinned":e.isPinned||void 0,onMouseDown:e=>{(0,m.q)(e),re(e)},onContextMenu:ce},!K&&!X&&!J&&a.ZP.createElement("span",{className:"action-message-content"},oe()),Y&&a.ZP.createElement("span",{className:"action-message-gift",tabIndex:0,role:"button",onClick:()=>{U({isGift:!0,fromUserId:E?.id,toUserId:b?.[0],monthsAmount:e.content.action?.months||0})}},a.ZP.createElement(P.Z,{key:e.id,sticker:x,play:L,noLoop:!0,nonInteractive:!0}),a.ZP.createElement("strong",null,V("ActionGiftPremiumTitle")),a.ZP.createElement("span",null,V("ActionGiftPremiumSubtitle",V("Months",e.content.action?.months,"i"))),a.ZP.createElement("span",{className:"action-message-button"},V("ActionGiftPremiumView"))),X&&function(){const t=e.content.action?.isGiveaway,n=e.content.action?.isUnclaimed;return a.ZP.createElement("span",{className:"action-message-gift action-message-gift-code",tabIndex:0,role:"button",onClick:ue},a.ZP.createElement(P.Z,{key:e.id,sticker:x,play:L,noLoop:!0,nonInteractive:!0}),a.ZP.createElement("strong",null,V(n?"BoostingUnclaimedPrize":"BoostingCongratulations")),a.ZP.createElement("span",{className:"action-message-subtitle"},(0,d.Z)(V(t?"BoostingReceivedGiftFrom":n?"BoostingReceivedPrizeFrom":"BoostingYouHaveUnclaimedPrize",(0,s.U)(V,w)),["simple_markdown"])),a.ZP.createElement("span",{className:"action-message-subtitle"},(0,d.Z)(V("BoostingUnclaimedPrizeDuration",V("Months",e.content.action?.months,"i")),["simple_markdown"])),a.ZP.createElement("span",{className:"action-message-button"},V("BoostingReceivedGiftOpenBtn")))}(),K&&a.ZP.createElement(M,{message:e,renderContent:oe}),J&&a.ZP.createElement(q,{chatId:S}),ie&&a.ZP.createElement(k.Z,{isOpen:se,anchor:ie,message:e,messageListType:"thread",onClose:le,onCloseAnimationEnd:de}))})))},59188:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(60748),o=n(33555),s=n(59187),i=n(91713),r=n(57710),c=n(4463),l=n(7054),d=n(97184),m=n(73541),u=n(59107),h=n(25190),p=n(231),Z=n(53106),g=n(58964),f=n(66902),v=n(99203),P=n(48778);const E=e=>{const{isOpen:t}=e,n=(0,P.Z)(v.gl.Extra,"HeaderMenuContainer",!t);return n?a.ZP.createElement(n,e):void 0},y=(0,a.X$)((0,o.c$)(((e,{chatId:t,threadId:n,messageListType:a,isMobile:o})=>{const i=(0,l.Z1J)(e,t),r=Boolean(i&&(0,c.eA)(i)),m=Boolean(i&&(0,c.ZV)(i)),u=(0,l.rB0)(e),h=(0,l.Mc4)(e),p=(0,c.YC)(t),{doNotTranslate:Z}=e.settings.byKey;if(!i||i.isRestricted||(0,l.CAb)(e))return{noMenu:!0,language:u,translationLanguage:h,doNotTranslate:Z};const g=(0,l.kBx)(e,t),f=p?void 0:(0,l.x67)(e,t),v=p?(0,l.ccz)(e,t):void 0,P=f||v,E=(0,l.FM1)(e,t),y="thread"===a&&n===s._f,b="thread"===a&&n!==s._f,C=(0,l.Jf5)(e,o),S=(0,c._o)(t,n,e.currentUserId),w=!!p&&(0,l.s4q)(e,t),I=Boolean(g&&w),N=!I&&Boolean((0,l.pkN)(e,t)),M=w&&!g,k=Boolean((y||i.isForum)&&(r||m)&&i.isNotJoined),T=y||b,x=d.Bi&&(0,c.YC)(i.id)&&!E&&!g&&!i.isSupport&&!(0,c.wo)(i.id),A=y&&!E&&!k,R=S||y&&!k,O=d.Bi&&y&&i.isCallActive,L=d.Bi&&y&&!i.isCallActive&&(i.adminRights?.manageCall||i.isCreator&&(0,c.G9)(i)),B=y&&f?.canViewStatistics,D=y&&r&&(B||(0,c.VE)(i,"postStories")),$=!D&&(m||r),F=y?f?.requestsPending:void 0,U=Boolean(i?.isNotJoined&&i.isJoinToSend),j=Boolean(i?.isNotJoined&&i.isJoinRequest),_=!(0,l.FOo)(e),V=Boolean((0,l.lpX)(e,t));return{noMenu:!1,isChannel:r,isRightColumnShown:C,canStartBot:N,canRestartBot:I,canSubscribe:k,canSearch:T,canCall:x,canMute:A,canViewStatistics:B,canViewBoosts:D,canShowBoostModal:$,canLeave:R,canEnterVoiceChat:O,canCreateVoiceChat:L,pendingJoinRequests:F,shouldJoinToSend:U,shouldSendJoinRequest:j,noAnimation:_,canTranslate:(0,l.GDM)(e,t)&&!P?.isTranslationDisabled,isTranslating:V,translationLanguage:h,language:u,doNotTranslate:Z,detectedChatLanguage:i.detectedLanguage,canUnblock:M}}))((({chatId:e,threadId:t,noMenu:n,isMobile:s,isChannel:c,canStartBot:l,canRestartBot:v,canUnblock:P,canSubscribe:y,canSearch:C,canCall:S,canMute:w,canViewStatistics:I,canViewBoosts:N,canShowBoostModal:M,canLeave:k,canEnterVoiceChat:T,canCreateVoiceChat:x,pendingJoinRequests:A,isRightColumnShown:R,isForForum:O,canExpandActions:L,shouldJoinToSend:B,shouldSendJoinRequest:D,noAnimation:$,canTranslate:F,isTranslating:U,translationLanguage:j,language:_,detectedChatLanguage:V,doNotTranslate:z,onTopicSearch:H})=>{const{joinChannel:W,sendBotCommand:q,openLocalTextSearch:G,restartBot:Y,requestMasterAndRequestCall:X,requestNextManagementScreen:K,showNotification:J,openChat:Q,requestChatTranslation:ee,togglePeerTranslations:te,openChatLanguageModal:ne,setSettingOption:ae,unblockUser:oe,setViewForumAsMessages:se}=(0,o.Sv)(),ie=(0,a.sO)(null),re=(0,u.Z)(),[ce,le]=(0,a.eJ)(!1),[de,me]=(0,a.eJ)(void 0),ue=(0,h.Z)((()=>{le(!0);const e=ie.current.getBoundingClientRect();me({x:e.right,y:e.bottom})})),he=(0,h.Z)((()=>{le(!1)})),pe=(0,h.Z)((()=>{me(void 0)})),Ze=(0,h.Z)((()=>{W({chatId:e}),D&&J({message:re(c?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})})),ge=(0,h.Z)((()=>{q({command:"/start"})})),fe=(0,h.Z)((()=>{Y({chatId:e})})),ve=(0,h.Z)((()=>{oe({userId:e})})),Pe=(0,h.Z)((()=>{ee(U?{chatId:e,toLanguageCode:void 0}:{chatId:e,toLanguageCode:j})})),Ee=(0,h.Z)((()=>{K({screen:i.u1.JoinRequests})})),ye=(0,h.Z)((()=>{O?H?.():(G(),s?document.querySelector("#MobileSearch input").focus():$?(0,r.i$)((()=>{(0,r.Yq)(b)})):setTimeout(b,320))})),be=(0,h.Z)((()=>{Q({id:e}),se({chatId:e,isEnabled:!0})})),Ce=(0,h.Z)((()=>{X({userId:e})})),Se=(0,h.Z)((e=>{C&&d.RM&&!e.shiftKey&&(e.preventDefault(),ye())})),we=(0,h.Z)(((e,t)=>{const n=`TranslateLanguage${t.split("-")[0].toUpperCase()}`,a=re(n);if(a!==n)return re(e,a);const o=new Intl.DisplayNames([_],{type:"language"}).of(t);return re(`${e}Other`,o)})),Ie=(0,a.Ye)((()=>U?re("ShowOriginalButton"):we("TranslateToButton",j)),[j,we,U,re]),Ne=(0,a.Ye)((()=>{if(V)return we("DoNotTranslateLanguage",V)}),[we,V]),Me=(0,h.Z)((()=>{te({chatId:e,isEnabled:!1}),ee({chatId:e,toLanguageCode:void 0})})),ke=(0,h.Z)((()=>{ne({chatId:e})})),Te=(0,h.Z)((()=>{V&&(ae({doNotTranslate:[...z,V]}),ee({chatId:e,toLanguageCode:void 0}),J({message:we("AddedToDoNotTranslate",V)}))}));(0,m.y)({"Mod+F":Se});const xe=(0,a.Ye)((()=>({onTrigger:e,isOpen:t})=>a.ZP.createElement(p.Z,{round:!0,ripple:R,color:"translucent",size:"smaller",className:t?"active":"",onClick:e,ariaLabel:re("TranslateMessage")},a.ZP.createElement("i",{className:"icon icon-language","aria-hidden":!0}))),[R,re]);return a.ZP.createElement("div",{className:"HeaderActions"},!O&&F&&a.ZP.createElement(Z.Z,{className:"stickers-more-menu with-menu-transitions",trigger:xe,positionX:"right"},a.ZP.createElement(g.Z,{icon:"language",onClick:Pe},Ie),a.ZP.createElement(g.Z,{icon:"replace",onClick:ke},re("Chat.Translate.Menu.To")),a.ZP.createElement(f.Z,null),V&&a.ZP.createElement(g.Z,{icon:"hand-stop",onClick:Te},Ne),a.ZP.createElement(g.Z,{icon:"close-circle",onClick:Me},re("Hide"))),!s&&a.ZP.createElement(a.ZP.Fragment,null,L&&!D&&(y||B)&&a.ZP.createElement(p.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:Ze},re(c?"ProfileJoinChannel":"ProfileJoinGroup")),L&&D&&a.ZP.createElement(p.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:Ze},re("ChannelJoinRequest")),L&&l&&a.ZP.createElement(p.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:ge},re("BotStart")),L&&v&&a.ZP.createElement(p.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:fe},re("BotRestart")),L&&P&&a.ZP.createElement(p.Z,{size:"tiny",ripple:!0,fluid:!0,onClick:ve},re("Unblock")),C&&a.ZP.createElement(p.Z,{round:!0,ripple:R,color:"translucent",size:"smaller",onClick:ye,ariaLabel:re("Conversation.SearchPlaceholder")},a.ZP.createElement("i",{className:"icon icon-search","aria-hidden":!0})),S&&a.ZP.createElement(p.Z,{round:!0,color:"translucent",size:"smaller",onClick:Ce,ariaLabel:"Call"},a.ZP.createElement("i",{className:"icon icon-phone","aria-hidden":!0}))),!O&&Boolean(A)&&a.ZP.createElement(p.Z,{round:!0,className:"badge-button",ripple:R,color:"translucent",size:"smaller",onClick:Ee,ariaLabel:re(c?"SubscribeRequests":"MemberRequests")},a.ZP.createElement("i",{className:"icon icon-user","aria-hidden":!0}),a.ZP.createElement("div",{className:"badge"},A)),a.ZP.createElement(p.Z,{ref:ie,className:ce?"active":"",round:!0,ripple:!s,size:"smaller",color:"translucent",disabled:n,ariaLabel:"More actions",onClick:ue},a.ZP.createElement("i",{className:"icon icon-more","aria-hidden":!0})),de&&a.ZP.createElement(E,{chatId:e,threadId:t,isOpen:ce,anchor:de,withExtraActions:s||!L,isChannel:c,canStartBot:l,canSubscribe:y,canSearch:C,canCall:S,canMute:w,canViewStatistics:I,canViewBoosts:N,canShowBoostModal:M,canLeave:k,canEnterVoiceChat:T,canCreateVoiceChat:x,pendingJoinRequests:A,onJoinRequestsClick:Ee,withForumActions:O,onSubscribeChannel:Ze,onSearchClick:ye,onAsMessagesClick:be,onClose:he,onCloseAnimationEnd:pe}))})));function b(){const e=document.querySelector(".RightHeader .SearchInput input");e?.focus()}},93219:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"CustomEmojiTooltip",!t);return n?a.ZP.createElement(n,e):void 0}},67146:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"CustomSendMenu",!t);return n?a.ZP.createElement(n,e):void 0}},12420:(e,t,n)=>{n.d(t,{t:()=>f,Z:()=>v});var a=n(60748),o=n(33555),s=n(4463),i=n(46752),r=n(23989),c=n(76087),l=n(21262),d=n(59107),m=n(25190),u=n(87204),h=n(31212),p=n(62898),Z=n(60706);const g=(0,a.X$)((({isQuick:e,isGeneric:t,onFileSelect:n})=>{const[o,s,r]=(0,Z.Z)(),c=(0,i.Z)("DropTarget",o&&"hovered");return a.ZP.createElement("div",{className:c,onDrop:n,onDragEnter:s,onDragLeave:e=>{const{relatedTarget:t}=e;t&&e.stopPropagation(),r()},"data-dropzone":!0},a.ZP.createElement("div",{className:"target-content"},a.ZP.createElement("div",{className:"icon icon-"+(e?"photo":"document")}),a.ZP.createElement("div",{className:"title"},"Drop files here to send them"),!t&&a.ZP.createElement("div",{className:"description"},e?"in a quick way":"without compression")))}));let f=function(e){return e.None="none",e.Document="document",e.QuickFile="quick_file",e}({});const v=(0,a.X$)((({isOpen:e,withQuick:t,onHide:n,onFileSelect:Z,editingMessage:f})=>{const v=(0,d.Z)(),{showNotification:P}=(0,o.Sv)(),E=(0,a.sO)(null),y=(0,u.Z)(t),{shouldRender:b,transitionClassNames:C}=(0,h.Z)(e),S=f&&f?.groupedId;(0,a.d4)((()=>e?(0,r.Z)(n):void 0),[e,n]);const w=(0,m.Z)((async e=>{const{dataTransfer:a}=e;let o=[];if(!(a.files&&a.files.length>0)||a.items&&a.items.length){if(a.items&&a.items.length>0){const e=await(0,l.Z)(a.items),t=e&&await(0,c.Z)(e[0].name,e[0]),n=f&&t&&(0,s.Gy)(f,t),i=t&&(0,s.kT)(t);if(n||i)return void P({message:v(S?"lng_edit_media_album_error":"lng_edit_media_invalid_file")});e?.length&&(o=o.concat(e))}}else o=o.concat(Array.from(a.files));n(),Z(o,!t&&void 0)})),I=(0,m.Z)((e=>{const{dataTransfer:t}=e;t.files&&t.files.length>0&&(n(),Z(Array.from(t.files),!0))})),N=(0,m.Z)((e=>{e.stopPropagation();const{target:t,relatedTarget:a}=e;!t.matches(".DropTarget, .DropArea")||a&&a.matches(".DropTarget, .DropArea")||(E.current=window.setTimeout((()=>{n()}),150))}));if(!b)return;const M=t||y,k=(0,i.Z)("DropArea",C);return a.ZP.createElement(p.Z,{containerId:"#middle-column-portals"},a.ZP.createElement("div",{className:k,onDragLeave:N,onDragOver:()=>{E.current&&window.clearTimeout(E.current)},onDrop:n,onClick:n},a.ZP.createElement(g,{onFileSelect:w,isGeneric:!M}),M&&a.ZP.createElement(g,{onFileSelect:I,isQuick:!0})))}))},19830:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"EmojiTooltip",!t);return n?a.ZP.createElement(n,e):void 0}},76609:(e,t,n)=>{n.d(t,{Z:()=>W});var a=n(60748),o=n(33555),s=n(83716),i=n(57710),r=n(7054),c=n(46752),l=n(517),d=n(98069),m=n(9668),u=n(65723),h=n(69118),p=n(97184),Z=n(32340),g=n(96391),f=n(42797),v=n(86203),P=n(60706),E=n(18674),y=n(59107),b=n(25190),C=n(84089),S=n(74753);function w(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?a:String(a))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class I{constructor(e,t,n){this.container=t,this.options=n,w(this,"video",void 0),w(this,"isPlaying",!1),this.video=document.createElement("video"),this.video.src=e,this.video.disablePictureInPicture=!0,this.video.muted=!0,n.style&&this.video.setAttribute("style",n.style),this.video.style.position="absolute",this.video.load(),this.options.noLoop||(this.video.loop=!0),(0,i.WM)((()=>{this.container.appendChild(this.video),this.recalculatePositionAndSize()}))}play(){!this.isPlaying&&this.video&&(this.recalculatePositionAndSize(),this.video.paused&&(0,S.Z)(this.video),this.isPlaying=!0)}pause(){this.isPlaying&&this.video&&(this.video.paused||this.video.pause(),this.isPlaying=!1)}destroy(){this.pause(),this.video?.remove(),this.video=void 0}updatePosition(e){this.options.position=e,this.recalculatePositionAndSize()}recalculatePositionAndSize(){const{size:e,position:{x:t,y:n}}=this.options;(0,i.i$)((()=>{if(!this.video)return;const a=this.video,{width:o,height:s}=this.container.getBoundingClientRect();(0,i.WM)((()=>{a.style.left=`${Math.round(t*o)}px`,a.style.top=`${Math.round(n*s)}px`,a.style.width=`${e}px`,a.style.height=`${e}px`}))}))}}var N=n(82850),M=n(28712),k=n(27370),T=n(74399),x=n(22268),A=n(92085),R=n(274),O=n(78722),L=n(3927),B=n(13819),D=n(38146);const $=1.25*T.Gw;var F=n(4292),U=n(99203),j=n(48778);const _=e=>{const{isOpen:t}=e,n=(0,j.Z)(U.gl.Extra,"TextFormatter",!t);return n?a.ZP.createElement(n,e):void 0},V="input-scroller",z=140,H=["Esc","Escape","Enter","PageUp","PageDown","Meta","Alt","Ctrl","ArrowDown","ArrowUp","Control","Shift"],W=(0,a.X$)((0,o.c$)(((e,{chatId:t,threadId:n})=>{const{messageSendKeyCombo:a}=e.settings.byKey;return{messageSendKeyCombo:a,replyInfo:t&&n?(0,r.Mst)(e,t,n)?.replyInfo:void 0,isSelectModeActive:(0,r.CAb)(e),canPlayAnimatedEmojis:(0,r.W9H)(e)}}))((({ref:e,id:t,chatId:n,captionLimit:S,isAttachmentModalInput:w,isStoryInput:T,customEmojiPrefix:U,editableInputId:j,isReady:W,isActive:q,getHtml:G,placeholder:Y,timedPlaceholderLangKey:X,timedPlaceholderDate:K,forcedPlaceholder:J,canSendPlainText:Q,canAutoFocus:ee,noFocusInterception:te,shouldSuppressFocus:ne,shouldSuppressTextFormatter:ae,replyInfo:oe,isSelectModeActive:se,canPlayAnimatedEmojis:ie,messageSendKeyCombo:re,onUpdate:ce,onSuppressedFocus:le,onSend:de,onScroll:me,onFocus:ue,onBlur:he})=>{const{editLastMessage:pe,replyToNextMessage:Ze,showAllowedMessageTypesNotification:ge}=(0,o.Sv)();let fe=(0,a.sO)(null);e&&(fe=e);const ve=(0,a.sO)(null),Pe=(0,a.sO)(null),Ee=(0,a.sO)(null),ye=(0,a.sO)(null),be=(0,a.sO)(null),Ce=(0,a.sO)(null),Se=(0,y.Z)(),we=(0,a.sO)(!1),[Ie,Ne,Me]=(0,P.Z)(),[ke,Te]=(0,a.eJ)(),[xe,Ae]=(0,a.eJ)(),[Re,Oe]=(0,a.eJ)(!1),{isMobile:Le}=(0,f.ZP)(),Be=Le&&(p.cj||p.wZ),[De,$e]=(0,a.eJ)(!1);(0,a.d4)((()=>{$e(Boolean(X&&K))}),[K,X]);const Fe=(0,b.Z)((()=>{$e(!1)}));!function(e,t,n,s,c,l,d,m,u){const h=(0,A.Z)(t,!m),p=(0,x.Z)(h,!0),Z=(0,D.Z)(),g=(0,a.sO)(new Map),f=(0,b.Z)((e=>{e.forEach((e=>{const t=g.current.get(e);t&&(t.destroy(),g.current.delete(e))}))})),v=(0,b.Z)((()=>{if(!(m&&t.current&&n.current&&s.current))return;const e=(0,o.Rd)(),a=new Set(g.current.keys());Array.from(t.current.querySelectorAll(".custom-emoji")).forEach((t=>{if(!t.dataset.uniqueId)return;const o=`${l}${t.dataset.uniqueId}${h||""}`,i=t.dataset.documentId;a.delete(o);const m=(0,N.XH)(i);if(!m)return;const u=n.current.getBoundingClientRect(),f=t.getBoundingClientRect(),v=(0,M.NM)((f.left-u.left)/u.width,4),P=(0,M.NM)((f.top-u.top)/u.height,4);if(g.current.has(o))return void g.current.get(o).updatePosition(v,P);const E=e.customEmojis.byId[i];if(!E)return;const y=E?.stickerSetInfo&&(0,r.Si0)(e,E.stickerSetInfo),b=[l,i,h,Z].filter(Boolean).join("_");(async function({customEmoji:e,sharedCanvasRef:t,sharedCanvasHqRef:n,absoluteContainerRef:a,renderId:o,viewId:s,mediaUrl:i,position:r,isHq:c,textColor:l,colorFilter:d}){if(e.isLottie){const a=e.shouldUseTextColor&&l?(0,k.oo)(l):void 0,d=(await(0,C.t)()).init(i,c?n.current:t.current,o,{size:$,coords:r,isLowPriority:!c},s,a?[a.r,a.g,a.b]:void 0);return{play:()=>d.play(),pause:()=>d.pause(),destroy:()=>d.removeView(s),updatePosition:(e,t)=>d.setSharedCanvasCoords(s,{x:e,y:t})}}if(e.isVideo){const t=e.shouldUseTextColor&&d?`filter: ${d};`:void 0,n=new I(i,a.current,{size:$,position:r,style:t});return{play:()=>n.play(),pause:()=>n.pause(),destroy:()=>n.destroy(),updatePosition:(e,t)=>n.updatePosition({x:e,y:t})}}throw new Error("Unsupported custom emoji type")})({customEmoji:E,sharedCanvasRef:n,sharedCanvasHqRef:s,absoluteContainerRef:c,renderId:b,viewId:o,mediaUrl:m,isHq:y,position:{x:v,y:P},textColor:h,colorFilter:p}).then((e=>{d&&e.play(),g.current.set(o,e)}))})),f(Array.from(a))}));(0,a.d4)((()=>(0,N.bn)(v)),[v]),(0,a.d4)((()=>{e()&&t.current&&n.current&&u&&m?(0,i.i$)((()=>{v()})):f(Array.from(g.current.keys()))}),[e,v,t,f,n,u,m]),(0,a.bt)((()=>{document.documentElement.style.setProperty("--input-custom-emoji-filter",p||"none")}),[p]),(0,R.Z)((([e])=>{void 0!==e&&h!==e&&v()}),[h,v]);const P=(0,L.Z)(v,[v],300,!1);(0,O.Z)(n,P),(0,R.Z)((([e])=>{Z!==e&&(f(Array.from(g.current.keys())),v())}),[Z,v]);const E=(0,b.Z)((()=>{g.current.forEach((e=>{e.pause()}))})),y=(0,b.Z)((()=>{d&&g.current?.forEach((e=>{e.play()}))})),S=(0,b.Z)((()=>{(0,i.i$)(y)}));(0,B.Z)(E,S)}(G,fe,ye,be,Ce,U,ie,W,q);const Ue=w?160:T?128:Le?256:416,je=(0,b.Z)(((e=!1)=>{(0,i.lT)((()=>{const t=fe.current.closest(`.${V}`),n=Number(t.style.height.replace("px","")),a=Ee.current,{scrollHeight:o}=a,s=Math.min(o,Ue);if(s===n)return;const r=o>Ue;function c(){const e=Math.round(50*Math.log(Math.abs(s-n)));t.style.height=`${s}px`,t.style.transitionDuration=`${e}ms`,t.classList.toggle("overflown",r)}return e?void(0,i.WM)(c):c}))}));(0,a.bt)((()=>{w&&je(!1)}),[w,je]);const _e=(0,a.sO)(G());(0,a.bt)((()=>{const e=q?G():"";e!==fe.current.innerHTML&&(fe.current.innerHTML=e),e!==Pe.current.innerHTML&&(Pe.current.innerHTML=e),e!==_e.current&&(_e.current=e,je(!e))}),[G,q,je]),(0,a.sO)(n).current=n;const Ve=(0,b.Z)((()=>{fe.current&&((0,E.zG)()?setTimeout(Ve,350):(0,u.Z)(fe.current))})),ze=(0,b.Z)((()=>{Me(),function(){const e=window.getSelection();e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}()}));function He(){if(p.cj)return!1;const e=window.getSelection();if(!e||!e.rangeCount||we.current)return Me(),p.wZ&&Oe(!1),!1;const t=e.getRangeAt(0),n=t.toString().trim();return!(ae||!(0,g.R)(t,j||s.R2F)||!n||(0,m.Z)(n)||!t.START_TO_END)||(Me(),!1)}function We(){if(!He())return;if(Re)return;const e=window.getSelection().getRangeAt(0),t=e.getBoundingClientRect(),n=fe.current.closest(`.${V}`).getBoundingClientRect();let a=t.left+t.width/2-n.left;a<z?a=z:a>n.width-z&&(a=n.width-z),Te({x:a,y:t.top-n.top}),Ae(e),Ne()}function qe(){ve.current&&window.clearTimeout(ve.current),ve.current=window.setTimeout(We,260)}(0,a.d4)((()=>{p.$b||ee&&Ve()}),[n,Ve,oe,ee]),(0,a.d4)((()=>{if(!n||j!==s.R2F||te||Be||se)return;const e=e=>{if((0,d.wT)())return;const{key:t}=e,n=e.target;if(!n||H.includes(t))return;const a=fe.current,o=document.getSelection()?.isCollapsed;if(!((t.startsWith("Arrow")||e.shiftKey&&"Shift"===t)&&!o||"KeyC"===e.code&&(e.ctrlKey||e.metaKey)&&"INPUT"!==n.tagName)&&a&&n!==a&&"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&!n.isContentEditable){(0,u.Z)(a,!0,!0);const t=new KeyboardEvent(e.type,e);a.dispatchEvent(t)}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}}),[n,j,Be,se,te]),(0,a.d4)((()=>{const e=(0,h.Ds)((e=>{"Tab"!==e.key||(0,d.wT)()||(e.preventDefault(),(0,i.WM)(Ve))}),2e3,!0,!1);return(0,l.Z)({onTab:e})}),[Ve]),(0,a.d4)((()=>{const e=fe.current;function t(){e.blur()}return ne&&e.addEventListener("focus",t),()=>{e.removeEventListener("focus",t)}}),[ne]);const Ge=(0,v.Z)((()=>Boolean(q&&G())),[q,G]),Ye=(0,c.Z)("form-control allow-selection",Ge&&"touched",ne&&"focus-disabled");return a.ZP.createElement("div",{id:t,onClick:ne?le:void 0,dir:Se.isRtl?"rtl":void 0},a.ZP.createElement("div",{className:(0,c.Z)("custom-scroll",V),onScroll:me,onClick:w||Q?void 0:function(){w||Q||ge({chatId:n})}},a.ZP.createElement("div",{className:"input-scroller-content"},a.ZP.createElement("div",{ref:fe,id:j||s.R2F,className:Ye,contentEditable:w||Q,role:"textbox",dir:"auto",tabIndex:0,onClick:Ve,onChange:function(e){const{innerHTML:t,textContent:n}=e.currentTarget;if(ce("<br>"===t?"":t),!p.$b&&(!n||!n.length)&&(p.op||!t.includes("emoji-small"))&&!t.includes("custom-emoji")){const e=window.getSelection();e&&(fe.current.blur(),e.removeAllRanges(),(0,u.Z)(fe.current,!0))}},onKeyDown:function(e){const{isComposing:t}=e,n=G();if(!t&&!n&&(e.metaKey||e.ctrlKey)){const t="ArrowDown"===e.key?1:"ArrowUp"===e.key?-1:void 0;if(t)return e.preventDefault(),void Ze({targetIndexDelta:t})}t||"Enter"!==e.key||e.shiftKey?t||"ArrowUp"!==e.key||n||e.metaKey||e.ctrlKey||e.altKey?e.target.addEventListener("keyup",qe,{once:!0}):(e.preventDefault(),pe()):!Be&&("enter"===re&&!e.shiftKey||"ctrl-enter"===re&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),Me(),de())},onMouseDown:function(e){function t(e){e instanceof KeyboardEvent&&"Esc"!==e.key&&"Escape"!==e.key||(setTimeout((()=>{we.current=!1}),100),window.removeEventListener("keydown",t),window.removeEventListener("mousedown",t))}2===e.button?we.current||(we.current=!0,document.addEventListener("mousedown",t),document.addEventListener("keydown",t)):(e.currentTarget.closest(".message-input-wrapper")||e.target).addEventListener("mouseup",qe,{once:!0})},onContextMenu:p.wZ?function(e){He()&&(Oe(!Re),Re?Me():(e.preventDefault(),e.stopPropagation(),We()))}:void 0,onTouchCancel:p.wZ?qe:void 0,"aria-label":Y,onFocus:ue,onBlur:he}),!J&&a.ZP.createElement("span",{className:(0,c.Z)("placeholder-text",!w&&!Q&&"with-icon"),dir:"auto"},!w&&!Q&&a.ZP.createElement("i",{className:"icon icon-lock-badge placeholder-icon"}),De?a.ZP.createElement(F.Z,{langKey:X,endsAt:K,onEnd:Fe}):Y),a.ZP.createElement("canvas",{ref:ye,className:"shared-canvas"}),a.ZP.createElement("canvas",{ref:be,className:"shared-canvas"}),a.ZP.createElement("div",{ref:Ce,className:"absolute-video-container"}))),a.ZP.createElement("div",{ref:Ee,className:(0,c.Z)("custom-scroll",V,"clone")},a.ZP.createElement("div",{className:"input-scroller-content"},a.ZP.createElement("div",{ref:Pe,className:(0,c.Z)(Ye,"clone"),dir:"auto"}))),void 0!==S&&a.ZP.createElement("div",{className:"max-length-indicator",dir:"auto"},S),a.ZP.createElement(_,{isOpen:Ie,anchorPosition:ke,selectedRange:xe,setSelectedRange:Ae,onClose:ze}),J&&a.ZP.createElement("span",{className:"forced-placeholder"},(0,Z.Z)(J)))})))},23522:(e,t,n)=>{n.d(t,{Z:()=>g});var a=n(60748),o=n(33555),s=n(83716),i=n(46752),r=n(60706),c=n(25190),l=n(12644),d=n(231),m=n(43521),u=n(49204),h=n(99203),p=n(48778);const Z=e=>{const{isOpen:t}=e,n=(0,p.Z)(h.gl.Extra,"SymbolMenu",!t);return n?a.ZP.createElement(n,e):void 0},g=(0,a.X$)((({chatId:e,threadId:t,isMobile:n,canSendGifs:h,canSendStickers:p,isMessageComposer:g,isReady:f,isSymbolMenuOpen:v,idPrefix:P,isAttachmentModal:E,canSendPlainText:y,isSymbolMenuForced:b,className:C,forceDarkTheme:S,inputCssSelector:w=s.Edp,openSymbolMenu:I,closeSymbolMenu:N,onCustomEmojiSelect:M,onStickerSelect:k,onGifSelect:T,onRemoveSymbol:x,onEmojiSelect:A,closeBotCommandMenu:R,closeSendAsMenu:O})=>{const{setStickerSearchQuery:L,setGifSearchQuery:B,addRecentEmoji:D,addRecentCustomEmoji:$}=(0,o.Sv)(),F=(0,a.sO)(null),[U,j]=(0,r.Z)(),[_,V]=(0,a.eJ)(void 0),z=(0,i.Z)("mobile-symbol-menu-button",!f&&"not-ready",U?v&&"menu-opened":v&&"is-loading"),H=(0,c.Z)((()=>{R?.(),O?.(),I();const e=F.current;if(!e)return;const{x:t,y:n}=e.getBoundingClientRect();V({x:t,y:n})})),W=(0,c.Z)((e=>{"stickers"===e?(L({query:""}),B({query:void 0})):(B({query:""}),L({query:void 0}))})),q=(0,c.Z)((()=>{const e=document.querySelector(E?s.VEm:w);n&&e===document.activeElement?(e?.blur(),setTimeout((()=>{R?.(),I()}),100)):I()})),G=(0,c.Z)((()=>F.current)),Y=(0,c.Z)((()=>F.current?.closest(".custom-scroll, .no-scrollbar"))),X=(0,c.Z)((()=>document.querySelector("#portals .SymbolMenu .bubble"))),K=(0,c.Z)((()=>({withPortal:!0}))),{positionX:J,positionY:Q,transformOriginX:ee,transformOriginY:te,style:ne}=(0,l.Z)(_,G,Y,X,K);return a.ZP.createElement(a.ZP.Fragment,null,n?a.ZP.createElement(d.Z,{className:z,round:!0,color:"translucent",onClick:v?N:q,ariaLabel:"Choose emoji, sticker or GIF"},a.ZP.createElement("i",{className:"icon icon-smile"}),a.ZP.createElement("i",{className:"icon icon-keyboard"}),v&&!U&&a.ZP.createElement(u.Z,{color:"gray"})):a.ZP.createElement(m.Z,{className:(0,i.Z)("symbol-menu-button",v&&"activated"),round:!0,color:"translucent",onActivate:H,ariaLabel:"Choose emoji, sticker or GIF"},a.ZP.createElement("div",{ref:F,className:"symbol-menu-trigger"}),a.ZP.createElement("i",{className:"icon icon-smile"})),a.ZP.createElement(Z,{chatId:e,threadId:t,isOpen:v||Boolean(b),canSendGifs:h,canSendStickers:p,isMessageComposer:g,idPrefix:P,onLoad:j,onClose:N,onEmojiSelect:A,onStickerSelect:k,onCustomEmojiSelect:M,onGifSelect:T,onRemoveSymbol:x,onSearchOpen:W,addRecentEmoji:D,addRecentCustomEmoji:$,isAttachmentModal:E,canSendPlainText:y,className:(0,i.Z)(C,S&&"component-theme-dark"),positionX:E?J:void 0,positionY:E?Q:void 0,transformOriginX:E?ee:void 0,transformOriginY:E?te:void 0,style:E?ne:void 0}))}))},76087:(e,t,n)=>{n.d(t,{Z:()=>d,V:()=>m});var a=n(83716),o=n(71394),s=n(93447);const i=1280,r=40,c=20,l=/\.[^/.]+$/;async function d(e,t,c){const m=URL.createObjectURL(t),{type:h,size:p}=t;let Z,g,f,v;if(a.oGt.has(h)){const n=await(0,o.pt)(m),{width:p,height:g}=n;v=!u(p,g);const P=Math.max(p,g)>i,E=h===a.s11;if(!v){if(!c?.compressedBlobUrl&&!E&&(P||"image/jpeg"!==h)){const n=await(0,s.j)(m,P?i/Math.max(p,g):1,"image/jpeg");return URL.revokeObjectURL(m),d(e,t,{compressedBlobUrl:n})}"image/jpeg"===h&&(e=e.replace(l,".jpg")),Z={width:p,height:g}}f=Math.max(p,g)>r?await(0,s.j)(m,r/Math.max(p,g),"image/jpeg"):m}else if(a.wGh.has(h)){try{const{videoWidth:e,videoHeight:t,duration:n}=await(0,o.jj)(m);v=!u(e,t),v||(Z={width:e,height:t,duration:n})}catch(e){v=!0}f=await(0,o.ud)(m)}else if(a.e74.has(h)){const{duration:e,title:t,performer:a,coverUrl:o}=await async function(e){const{fetchFromUrl:t,selectCover:a}=await n.e(8505).then(n.t.bind(n,38505,23)),o=await t(e),{common:{title:s,artist:i,picture:r},format:{duration:c}}=o,l=a(r),d=l?new Blob([l.data],{type:l.format}):void 0;return{title:s,performer:i,duration:c,coverUrl:d?URL.createObjectURL(d):void 0}}(m);g={duration:e||0,title:t,performer:a},f=o}return{blobUrl:m,filename:e,mimeType:h,size:p,quick:Z,audio:g,previewBlobUrl:f,shouldSendAsFile:v||void 0,uniqueId:`${Date.now()}-${Math.random()}`,...c}}function m(e,t){return e.map((e=>t?e.compressedBlobUrl?{...e,blobUrl:e.compressedBlobUrl}:e:{...e,shouldSendAsFile:!e.voice||void 0,shouldSendAsSpoiler:void 0}))}function u(e,t){return Math.max(e,t)/Math.min(e,t)<=c}},21262:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(71394);async function o(e){const t=[];function n(e,a){return new Promise((o=>{if(e instanceof File)t.push(e),o(e);else if(e.isFile){const n=a.getAsFile();e.file((e=>{t.push(e),o(e)}),(()=>{n&&t.push(n),o(n)}))}else e.isDirectory&&e.createReader().readEntries((e=>{const t=[];for(let o=0;o<e.length;o++)t.push(n(e[o],a));o(Promise.all(t))}))}))}const o=[];for(let t=0;t<e.length;t++){const a=e[t];if("file"===a.kind){const e=a.webkitGetAsEntry()||a.getAsFile();e&&o.push(n(e,a))}}return await Promise.all(o),(0,a.ox)(t)}},52400:(e,t,n)=>{n.d(t,{_:()=>r});const a=/(<br>|<br\s?\/>)/g,o=/(&nbsp;|\u00A0)/g,s=/(<div>|<\/div>)/gi,i=/\n$/i;function r(e){return e.replace(o," ").replace(a,"\n").replace(s,"").replace(i,"")}},96391:(e,t,n)=>{n.d(t,{R:()=>o});const a=5;function o(e,t){const{commonAncestorContainer:n}=e;let o=n,s=1;for(;o&&o.id!==t&&s<a;)o=o.parentElement,s++;return Boolean(o&&o.id===t)}},60130:(e,t,n)=>{n.d(t,{Z:()=>E});var a=n(60748),o=n(33555),s=n(83716),i=n(57710),r=n(33681),c=n(65723),l=n(41098),d=n(97184),m=n(44139),u=n(11309),h=n(71790),p=n(86203),Z=n(60706),g=n(25190);const f=300,v=new RegExp(`(${r.Z.source})$`,"g"),P=new RegExp(`${s.t8f.source}$`,"g");function E(e,t,n,E,y,b){const{loadCustomEmojiForEmoji:C,clearCustomEmojiForEmoji:S}=(0,o.Sv)(),[w,I,N]=(0,Z.Z)(!1),M=(0,u.CH)((()=>{const n=t();if(!e||!n||!E()?.collapsed)return;if(!n.match(d.op?r.Z:s.t8f))return;const a=(0,l.gJ)(y.current);return a.match(d.op?v:P)?.[0]}),[t,E,y,e],f),k=(0,h.Z)(M,[M,t,E],!0),T=(0,p.Z)((()=>Boolean(k())),[k]),x=Boolean(b?.length);(0,a.d4)((()=>{if(!e||!T)return;const t=k();t?x||C({emoji:d.op?t:t.match(/.+alt="(.+)"/)?.[1]}):S()}),[e,T,k,x,S,C]);const A=(0,g.Z)((t=>{const a=k();if(!e||!a)return;const o=y.current,s=(0,l.gJ)(o),r=d.op?a:a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),u=new RegExp(`(${r})\\1*$`,""),h=s.match(u)[0].length/a.length,p=s.replace(u,(0,m.yR)(t).repeat(h)),Z=o.innerHTML.substring(s.length);n(`${p}${Z}`),(0,i.Yq)((()=>{(0,c.Z)(o,!0,!0)}))}));return(0,a.d4)(N,[N,t]),{isCustomEmojiTooltipOpen:Boolean(T&&x&&!w),closeCustomEmojiTooltip:I,insertCustomEmoji:A}}},28353:(e,t,n)=>{n.d(t,{Z:()=>x});var a=n(60748),o=n(33555),s=n(83716),i=n(57710),r=n(7054),c=n(61463),l=n(65723),d=n(60782),m=n(70735),u=n(16580),h=n(32340),p=n(44139),Z=n(52400),g=n(11309),f=n(71790),v=n(60706),P=n(25190);let E,y,b,C,S;const w=36,I=2,N=300,M=(0,u.Z)((function(e,t,n){return e&&t.length?Object.values((0,d.q0)(e,t)).slice(0,n):m.D})),k=(0,u.Z)((function(e,t,n){const a=Object.values(e),o=(0,d.ee)(a,"native"),s=t?(0,d.Q8)(t,(e=>Object.values((0,d.q0)(o,e)))):{},i=n?(0,d.Q8)(n,(e=>Object.values((0,d.q0)(o,e)))):{},r={...s,...i},c=[].concat(Object.keys(s),Object.keys(i)),l=a.reduce(((e,t)=>(t.names.forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)})),e)),{}),m=Object.keys(l),u=c.reduce(((e,t)=>Math.max(e,t.length)),0);return{byKeyword:r,keywords:c,byName:l,names:m,maxKeyLength:u}})),T=(0,u.Z)((function(e,t,n){const{byKeyword:a,keywords:o,byName:s,names:i,maxKeyLength:r}=e;let c=[];if(t.length>r)return m.D;const l=o.filter((e=>e.startsWith(t))).sort();c=c.concat(Object.values((0,d.q0)(a,l)).flat());const u=i.filter((e=>e.startsWith(t)));return c=c.concat(Object.values((0,d.q0)(s,u)).flat()),c=(0,d.Tw)(c),c.length?c.slice(0,n):m.D}));try{C=/(^|\s):(?!\s)[-+_:'\s\p{L}\p{N}]*$/giu,S=/\p{Ll}/u}catch(e){C=/(^|\s):(?!\s)[-+_:'\s\d\wа-яёґєії]*$/gi,S=/[a-zяёґєії]/}function x(e,t,u,x=s.R2F,A,R,O){const[L,B,D]=(0,v.Z)(!1),[$,F]=(0,a.eJ)(),[U,j]=(0,a.eJ)(m.D),[_,V]=(0,a.eJ)(m.D);(0,a.d4)((()=>{function t(){F(b.emojis)}e&&(b?t():async function(){return E||(E=n.e(7501).then(n.t.bind(n,47501,19)),y=(await E).default,b=(0,c.NM)(y)),E}().then(t))}),[e]);const z=(0,g.CH)((()=>{const n=t();return e&&n.includes(":")?(0,Z._)(n).match(C)?.[0].trim():void 0}),[t,e],N),H=(0,f.Z)(z,[z,t],!0),W=(0,P.Z)((e=>{if(j(e),e===m.D)return void V(m.D);const t=e.map((e=>e.native)),n=(0,d.od)((0,r.iXW)((0,o.Rd)(),t),"id");V(n)})),q=(0,P.Z)(((e,n=!1)=>{const a=t();if(!a)return;const o=a.lastIndexOf(":",n?a.lastIndexOf(":")-1:void 0);if(-1!==o){const t="string"==typeof e?(0,h.Z)(e,["emoji_html"]):(0,p.yR)(e);u(`${a.substring(0,o)}${t}`);const n=x===s.R2F?document.querySelector(s.Edp):document.getElementById(x);(0,i.Yq)((()=>{(0,l.Z)(n,!0,!0)}))}W(m.D)}));return(0,a.d4)((()=>{const e=H();if(!e||!$)return void W(m.D);const t=e.length>2&&e.endsWith(":"),n=e.substring(1,t?1+e.length-2:void 0);let a=m.D;if(n){if(1===n.length&&S.test(n)||n.length>=I){const e=k($,R,O);a=T(e,n.toLowerCase(),w)}}else a=M($,A,w);a.length?t?q(a[0].native,!0):W(a):W(m.D)}),[R,$,H,O,q,A,W]),(0,a.d4)(D,[D,t]),{isEmojiTooltipOpen:Boolean(U.length||_.length)&&!L,closeEmojiTooltip:B,filteredEmojis:U,filteredCustomEmojis:_,insertEmoji:q}}},29295:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(60748),o=n(33555),s=n(59187),i=n(57710),r=n(4463),c=n(65723),l=n(60782),d=n(41098),m=n(52400),u=n(11309),h=n(71790),p=n(60706),Z=n(25190);const g=300;let f;try{f=/(^|\s)@[-_\p{L}\p{M}\p{N}]*$/giu}catch(e){f=/(^|\s)@[-_\d\wа-яёґєії]*$/gi}function v(e,t,n,v,E,y,b,C){const[S,w]=(0,a.eJ)(),[I,N,M]=(0,p.Z)(!1),k=(0,u.CH)((()=>{const n=t();if(!e||!v()?.collapsed||!n.includes("@"))return;const a=(0,d.gJ)(E.current);return(0,m._)(a).match(f)?.[0].trim()}),[e,t,v,E],g),T=(0,h.Z)(k,[k,t,v],!0),x=(0,h.Z)((()=>e&&t().startsWith("@")),[t,e]);(0,a.d4)((()=>{const e=T();if(!e||!y&&!b)return void w(void 0);const t=(0,o.Rd)().users.byId;if(!t)return void w(void 0);const n=y?.reduce(((e,t)=>(t.userId!==C&&e.push(t.userId),e)),[]),a=e.substring(1),s=(0,r.kK)((0,l.Tw)([...x()&&b||[],...n||[]]),t,a);w(Object.values((0,l.q0)(t,s)))}),[C,y,b,T,x]);const A=(0,Z.Z)(((e,t=!1)=>{if(!e.usernames&&!(0,r.Vl)(e))return;const a=(0,r.WS)(e),o=(0,r.Vl)(e)||"",l=a?`@${a}`:`<a\n          class="text-entity-link"\n          data-entity-type="${s.Vv.MentionName}"\n          data-user-id="${e.id}"\n          contenteditable="false"\n          dir="auto"\n        >${o}</a>`,m=E.current,u=P((0,d.gJ)(m)),h=u.lastIndexOf("@"),p=(a?a.length+1:o.length)-(u.length-h);if(-1!==h){const e=`${u.substr(0,h)}${l}&nbsp;`,a=P(m.innerHTML).substring(u.length),o=(0,d.qK)(m);n(`${e}${a}`),(0,i.Yq)((()=>{const e=o+p+1;(0,c.Z)(m,t),e>=0&&(0,d.Mq)(m,e)}))}w(void 0)}));return(0,a.d4)(M,[M,t]),{isMentionTooltipOpen:Boolean(S?.length&&!I),closeMentionTooltip:N,insertMention:A,mentionFilteredUsers:S}}function P(e){return e.replace(/<div>(<br>|<br\s?\/>)?<\/div>/gi,"<br>")}},93609:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(60748),o=n(33555),s=n(4463),i=n(46752),r=n(790),c=n(97184),l=n(42797),d=n(15866),m=n(18360),u=n(59107),h=n(25190),p=n(6202),Z=n(31212),g=n(42175);const f=(0,a.X$)((function({story:e,isPreview:t,isProtected:n,isConnected:f}){const{openStoryViewer:v,loadPeerStoriesByIds:P,showNotification:E}=(0,o.Sv)(),y=(0,u.Z)(),{isMobile:b}=(0,l.ZP)(),C=e&&"isDeleted"in e,S=e&&"content"in e,w=S?e.content.video:void 0,I=S?(0,s.Cc)(e):void 0,N=(0,p.Z)(I),M=S?w?w.thumbnail?.dataUri:e.content.photo?.thumbnail?.dataUri:void 0,k=(0,m.Z)(N,!0),{shouldRender:T,transitionClassNames:x}=(0,Z.Z)(Boolean(k)),A=(0,d.Z)(M,C&&!t,b&&!c.vX),R=(0,i.Z)("EVLTkrt1","media-inner",(!f||C)&&"AQWPv0bP",C&&"tprkr7qf",t&&"V3HabdKr");(0,a.d4)((()=>{!e||S||C||P({peerId:e.peerId,storyIds:[e.id]})}),[e,C,S]);const O=(0,h.Z)((()=>{C?E({message:y("StoryNotFound")}):v({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isSingleStory:!0})}));return a.ZP.createElement("div",{className:R,onClick:f?O:void 0},!C&&t&&a.ZP.createElement("canvas",{ref:A,className:"thumbnail blurred-bg"}),T&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement("img",{src:k,alt:"",className:(0,i.Z)("WAItYc5d",t&&"ClGe8yij",x),draggable:!1}),S&&a.ZP.createElement(g.Z,{story:e,className:x})),C&&a.ZP.createElement("span",null,a.ZP.createElement("i",{className:(0,i.Z)("nLA7VEhv","icon icon-story-expired"),"aria-hidden":!0}),y("StoryExpiredSubtitle")),Boolean(w?.duration)&&a.ZP.createElement("div",{className:"message-media-duration"},(0,r.k9)(w.duration)),n&&a.ZP.createElement("span",{className:"protector"}))}))},97182:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(99203),s=n(48778);const i=e=>{const{isOpen:t}=e,n=(0,s.Z)(o.gl.Extra,"ContextMenuContainer",!t);return n?a.ZP.createElement(n,e):void 0}},95822:(e,t,n)=>{n.d(t,{Z:()=>b});var a=n(60748),o=n(83716),s=n(57710),i=n(4463),r=n(46752),c=n(26593),l=n(83967),d=n(42797),m=n(60706),u=n(3657),h=n(25190),p=n(72645),Z=n(70692),g=n(6701),f=n(87204),v=n(31212),P=n(41280),E=n(62230),y=n(39196);const b=({id:e,message:t,observeIntersection:n,noAvatars:b,canAutoLoad:C,isInSelectMode:S,isSelected:w,uploadProgress:I,forcedWidth:N,size:M="inline",dimensions:k,asForwarded:T,nonInteractive:x,shouldAffectAppendix:A,isDownloading:R,isProtected:O,theme:L,onClick:B,onCancelUpload:D})=>{const $=(0,a.sO)(null),F=(0,i.O$)(t)||(0,i.F$)(t),U=F.blobUrl,j=(0,u.Op)($,n),{isMobile:_}=(0,d.ZP)(),[V,z]=(0,a.eJ)(C),H=V&&j,{mediaData:W,loadProgress:q}=(0,g.Z)((0,i.Ti)(t,M),!H),G=U||W,Y=Boolean(N),[X]=(0,a.eJ)(!G),K=Boolean(G),J=(0,P.Z)(t,K),Q=(0,P.Z)(t,!Y),ee=(0,Z.Z)(!K),te=(0,i.DH)(t),[ne,ae,oe]=(0,m.Z)(F.isSpoiler);(0,a.d4)((()=>{F.isSpoiler?ae():oe()}),[F.isSpoiler]);const{loadProgress:se}=(0,g.Z)((0,i.Ti)(t,"download"),!R,(0,i.kG)(t,"download")),{isUploading:ie,isTransferring:re,transferProgress:ce}=(0,i.Sc)(t,I||(R?se:q),H&&!G,void 0!==I),le=!1===(0,f.Z)(V),{shouldRender:de,transitionClassNames:me}=(0,v.Z)(re,void 0,le,"slow"),{shouldRender:ue,transitionClassNames:he}=(0,v.Z)(!G&&!V),pe=(0,h.Z)((()=>{ie?D?.(t):G?ne?oe():B?.(t.id):z((e=>!e))})),Ze=(0,i.B4)(t);(0,p.Z)((([e])=>{if(!A)return void(e&&$.current.closest(o.be_).removeAttribute(o.s22));const t=$.current.closest(o.be_);G?(0,c.Z)(G,Ze,w,L).then((e=>{(0,s.WM)((()=>{t.style.setProperty("--appendix-bg",e),t.setAttribute(o.s22,"")}))})):t.classList.add("has-appendix-thumb")}),[A,G,Ze,S,w,L]);const{width:ge,height:fe,isSmall:ve}=k||(0,l.GH)(t,T,b,_),Pe=(0,r.Z)("media-inner",!ie&&!x&&"interactive",ve&&"small-image",ge===fe&&"square-image",fe<l.Xo&&"fix-min-height"),Ee=k?` width: ${ge}px; left: ${k.x}px; top: ${k.y}px;`:"",ye="inline"===M?`height: ${fe}px;${Ee}`:void 0;return a.ZP.createElement("div",{id:e,ref:$,className:Pe,style:ye,onClick:ie?void 0:pe},Y&&a.ZP.createElement("canvas",{ref:Q,className:"thumbnail blurred-bg"}),a.ZP.createElement("img",{src:G,className:(0,r.Z)("full-media",Y&&"with-blurred-bg"),alt:"",style:N?`width: ${N}px`:void 0,draggable:!O}),X&&a.ZP.createElement("canvas",{ref:J,className:(0,r.Z)("thumbnail",ee)}),O&&a.ZP.createElement("span",{className:"protector"}),de&&!ue&&a.ZP.createElement("div",{className:`media-loading ${me}`},a.ZP.createElement(y.Z,{progress:ce,onClick:ie?pe:void 0})),ue&&a.ZP.createElement("i",{className:(0,r.Z)("icon","icon-download",he)}),a.ZP.createElement(E.Z,{isVisible:ne,withAnimation:!0,thumbDataUri:te,width:ge,height:fe,className:"media-spoiler"}),re&&a.ZP.createElement("span",{className:"message-transfer-progress"},Math.round(100*ce),"%"))}},56766:(e,t,n)=>{n.d(t,{Z:()=>T});var a=n(60748),o=n(33555),s=n(59187),i=n(4463),r=n(10396),c=n(46752),l=n(790),d=n(74753),m=n(74399),u=n(11309),h=n(60706),p=n(3657),Z=n(25190),g=n(70692),f=n(6701),v=n(87204),P=n(31212),E=n(33799),y=n(41280),b=n(65979),C=n(62230),S=n(231),w=n(57080),I=n(39196);const N=m.Rj/2,M=2*(N-6)*Math.PI;let k;const T=({message:e,className:t,canAutoLoad:n,isDownloading:T,origin:x,observeIntersection:A,onStop:R,onReadMedia:O})=>{const L=(0,a.sO)(null),B=(0,a.sO)(null),D=(0,a.sO)(null),$=e.content.video,{cancelMessageMediaDownload:F,openOneTimeMediaModal:U}=(0,o.Sv)(),j=(0,p.Op)(L,A),[_,V]=(0,a.eJ)(n),z=Boolean(_&&j),{mediaData:H,loadProgress:W}=(0,f.Z)((0,i.Ti)(e,"inline"),!z,(0,i.kG)(e,"inline")),{loadProgress:q}=(0,f.Z)((0,i.Ti)(e,"download"),!T,s.IU.BlobUrl),[G,Y]=(0,h.Z)(),X=(0,i.qR)(e),K="oneTimeModal"===x,J=X&&!K,Q=!Boolean((0,i.DH)(e))||G||J,ee=(0,y.Z)(e,Q),te=(0,g.Z)(!Q),ne=(0,i.DH)(e),ae=_&&!G||T,oe=!1===(0,v.Z)(_),{shouldRender:se,transitionClassNames:ie}=(0,P.Z)(ae,void 0,oe),[re,ce]=(0,a.eJ)(!1),[le,de]=(0,E.Z)(0),me=(0,u.WR)(le,16);(0,a.d4)((()=>{if(!re)return;const e=B.current;de(e.currentTime/e.duration)}),[de,re,me]),(0,a.bt)((()=>{if(!re||!D.current)return;const e=M-me()*M;D.current.setAttribute("stroke-dashoffset",e.toString())}),[re,me]);const ue=Boolean(H&&j),he=(0,Z.Z)((()=>{B.current&&(ce(!1),de(0),(0,d.Z)(B.current))})),pe=(0,Z.Z)((()=>{k?.(),k=he})),Ze=(0,Z.Z)((()=>{const e=B.current;re?e.paused?((0,d.Z)(e),(0,r.Es)()):e.pause():(pe(),e.pause(),e.currentTime=0,(0,d.Z)(e),(0,r.Es)(),ce(!0))}));(0,a.d4)((()=>{K&&Ze()}),[K]);const ge=(0,Z.Z)((()=>{if(H){if(!T)return X&&!K?(U({message:e}),void O?.()):void Ze();F({message:e})}else V((e=>!e))})),fe=(0,Z.Z)((e=>{const t=e.currentTarget;de(t.currentTime/t.duration)}));return a.ZP.createElement("div",{ref:L,className:(0,c.Z)("RoundVideo","media-inner",K&&"non-interactive",t),onClick:ge},H&&a.ZP.createElement("div",{className:"video-wrapper"},J&&a.ZP.createElement(C.Z,{isVisible:!0,thumbDataUri:ne,width:m.Rj,height:m.Rj,className:"media-spoiler"}),a.ZP.createElement(w.Z,{canPlay:ue,ref:B,src:H,className:"full-media",width:m.Rj,height:m.Rj,autoPlay:!J,disablePictureInPicture:!0,muted:!re,loop:!re,playsInline:!0,onEnded:re?R??he:void 0,onTimeUpdate:re?fe:void 0,onReady:Y})),!J&&a.ZP.createElement("canvas",{ref:ee,className:(0,c.Z)("thumbnail",te),style:`width: ${m.Rj}px; height: ${m.Rj}px`}),a.ZP.createElement("div",{className:"progress"},re&&a.ZP.createElement("svg",{width:m.Rj,height:m.Rj},a.ZP.createElement("circle",{ref:D,cx:N,cy:N,r:N-6,className:"progress-circle",transform:`rotate(-90, ${N}, ${N})`,"stroke-dasharray":M,"stroke-dashoffset":M}))),se&&a.ZP.createElement("div",{className:`media-loading ${ie}`},a.ZP.createElement(I.Z,{progress:T?q:W})),J&&!se&&a.ZP.createElement("div",{className:"play-wrapper"},a.ZP.createElement(S.Z,{color:"dark",round:!0,size:"smaller",className:"play",nonInteractive:!0},a.ZP.createElement(b.Z,{name:"play"})),a.ZP.createElement(b.Z,{name:"view-once"})),!H&&!_&&a.ZP.createElement("i",{className:"icon icon-download"}),!K&&a.ZP.createElement("div",{className:"message-media-duration"},re?(0,l.k9)(B.current.currentTime):(0,l.k9)($.duration),(!re||B.current.paused)&&a.ZP.createElement(b.Z,{name:"muted"})))}},35269:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(60748),o=n(33555),s=n(4463),i=n(46752),r=n(790),c=n(40647),l=n(74399),d=n(83967),m=n(13617),u=n(42797),h=n(60706),p=n(3657),Z=n(25190),g=n(6202),f=n(70692),v=n(6701),P=n(87204),E=n(31212),y=n(41280),b=n(62230),C=n(57080),S=n(39196);const w=({id:e,message:t,observeIntersectionForLoading:n,observeIntersectionForPlaying:w,noAvatars:I,canAutoLoad:N,canAutoPlay:M,uploadProgress:k,forcedWidth:T,dimensions:x,asForwarded:A,isDownloading:R,isProtected:O,onClick:L,onCancelUpload:B})=>{const D=(0,a.sO)(null),$=(0,a.sO)(null),F=(0,s.b7)(t)||(0,s.Cg)(t),U=F.blobUrl,[j,_,V]=(0,h.Z)(F.isSpoiler);(0,a.d4)((()=>{F.isSpoiler?_():V()}),[F.isSpoiler]);const z=(0,p.Op)(D,n),H=(0,p.Op)(D,w)&&z,W=(0,a.sO)(z);H&&!W.current&&(W.current=!0);const{isMobile:q}=(0,u.ZP)(),[G,Y]=(0,a.eJ)(N),X=Boolean(G&&z),[K,J]=(0,a.eJ)(Boolean(M&&!j)),Q=(0,s.Ti)(t,"inline"),[ee]=(0,a.eJ)(Boolean(Q&&c.UV(Q))),{mediaData:te,loadProgress:ne}=(0,v.Z)(Q,!X,(0,s.kG)(t,"inline")),ae=U||te,[oe,se]=(0,h.Z)(),ie=(0,s.DH)(t),re=Boolean(ie),ce=Boolean(T),le=(0,s.Ti)(t,"preview"),[de]=(0,a.eJ)(Boolean(le&&c.UV(le))),me=z,ue=(0,g.Z)(le,!me),he=(0,f.Z)((re||ue)&&!oe),pe=!re||ue||oe,Ze=(0,y.Z)(t,pe),ge=(0,y.Z)(t,!ce),fe=(0,f.Z)(!pe),ve=ae&&W.current,Pe=(0,m.Z)($,!0,!ve),{loadProgress:Ee}=(0,v.Z)((0,s.Ti)(t,"download"),!R,(0,s.kG)(t,"download")),{isUploading:ye,isTransferring:be,transferProgress:Ce}=(0,s.Sc)(t,k||(R?Ee:ne),X&&!oe&&!ee||R,void 0!==k),Se=!1===(0,P.Z)(G),{shouldRender:we,transitionClassNames:Ie}=(0,E.Z)(be&&!Pe,void 0,Se),{transitionClassNames:Ne}=(0,E.Z)(Boolean((G||ae)&&!K&&!we)),[Me,ke]=(0,a.eJ)(0),Te=(0,Z.Z)((e=>{ke(Math.max(0,e.currentTarget.currentTime-1))})),xe=(Number.isFinite($.current?.duration)?$.current?.duration:F.duration)||0,Ae=(0,s.B4)(t),Re=Boolean((0,s.Cg)(t)),{width:Oe,height:Le}=x||(0,l.GC)(F,Ae,A,Re,I,q),Be=(0,Z.Z)((()=>{ye?B?.(t):R?(0,o.Sv)().cancelMessageMediaDownload({message:t}):ae?(ae&&!K&&J(!0),j?V():L?.(t.id)):Y((e=>!e))})),De=(0,i.Z)("media-inner dark",!ye&&"interactive",Le<d.Xo&&"fix-min-height"),$e=`height: ${Le}px;${x?` width: ${Oe}px; left: ${x.x}px; top: ${x.y}px;`:""}`;return a.ZP.createElement("div",{ref:D,id:e,className:De,style:$e,onClick:ye?void 0:Be},ce&&a.ZP.createElement("canvas",{ref:ge,className:"thumbnail blurred-bg"}),ve&&a.ZP.createElement(C.Z,{ref:$,src:ae,className:(0,i.Z)("full-media",ce&&"with-blurred-bg"),canPlay:K&&H&&!Pe,muted:!0,loop:!0,playsInline:!0,draggable:!O,onTimeUpdate:Te,onReady:se,style:T?`width: ${T}px`:void 0}),a.ZP.createElement("img",{src:ue,className:(0,i.Z)("thumbnail",he,ce&&"with-blurred-bg"),alt:"",style:T?`width: ${T}px;`:void 0,draggable:!O}),re&&!de&&a.ZP.createElement("canvas",{ref:Ze,className:(0,i.Z)("thumbnail",fe)}),O&&a.ZP.createElement("span",{className:"protector"}),a.ZP.createElement("i",{className:(0,i.Z)("icon","icon-large-play",Ne)}),a.ZP.createElement(b.Z,{isVisible:j,withAnimation:!0,thumbDataUri:ie,width:Oe,height:Le,className:"media-spoiler"}),we&&a.ZP.createElement("div",{className:(0,i.Z)("media-loading",Ie)},a.ZP.createElement(S.Z,{progress:Ce,onClick:Be})),!G&&!ae&&a.ZP.createElement("i",{className:"icon icon-download"}),!be||Pe&&!R?a.ZP.createElement("div",{className:"message-media-duration"},F.isGif?"GIF":(0,r.k9)(Math.max(xe-Me,0)),Pe&&a.ZP.createElement("i",{className:"icon icon-message-failed playback-failed"})):a.ZP.createElement("span",{className:"message-transfer-progress"},ye||R?`${Math.round(100*Ce)}%`:"..."))}},54659:(e,t,n)=>{n.d(t,{Z:()=>C});var a=n(60748),o=n(33555),s=n(91713),i=n(4463),r=n(46752),c=n(48035),l=n(32340),d=n(83967),m=n(42797),u=n(31526),h=n(59107),p=n(25190),Z=n(73482),g=n(82535),f=n(41278),v=n(10088),P=n(231),E=n(93609),y=n(95822),b=n(35269);const C=(0,a.X$)((({message:e,observeIntersection:t,noAvatars:n,canAutoLoad:C,canAutoPlay:S,inPreview:w,asForwarded:I,isDownloading:N=!1,isProtected:M,isConnected:k,story:T,theme:x,backgroundEmojiId:A,shouldWarnAboutSvg:R,autoLoadFileMaxSizeMb:O,onMediaClick:L,onAudioPlay:B,onCancelMediaTransfer:D})=>{const{openTelegramLink:$}=(0,o.Sv)(),F=(0,i.s1)(e),{isMobile:U}=(0,m.ZP)(),j=(0,h.Z)(),_=(0,p.Z)((()=>{L()})),V=(0,p.Z)((()=>{F&&$({url:F.url})})),{story:z}=F||{};if((0,u.Z)(z?.peerId,z?.id,T),!F)return;const{siteName:H,url:W,displayUrl:q,title:G,description:Y,photo:X,video:K,audio:J,type:Q,document:ee}=F,te="telegram_story"===Q,ne=w||T&&"isDeleted"in T?void 0:function(e){switch(e){case"telegram_channel_request":case"telegram_megagroup_request":case"telegram_chat_request":return"lng_view_button_request_join";case"telegram_message":return"lng_view_button_message";case"telegram_bot":return"lng_view_button_bot";case"telegram_voicechat":return"lng_view_button_voice_chat";case"telegram_livestream":return"lng_view_button_voice_chat_channel";case"telegram_megagroup":case"telegram_chat":return"lng_view_button_group";case"telegram_channel":return"lng_view_button_channel";case"telegram_user":return"lng_view_button_user";case"telegram_botapp":return"lng_view_button_bot_app";case"telegram_chatlist":return"ViewChatList";case"telegram_story":return"lng_view_button_story";case"telegram_channel_boost":case"telegram_group_boost":return"lng_view_button_boost";default:return}}(Q),ae=(0,c.Z)(Y,170),oe=Boolean(ae||G||H);let se=!1;if(oe&&F?.photo&&!F.video){const{width:t,height:n}=(0,d.GH)(e,void 0,void 0,U);se=t===n}const ie=(X||K)&&L&&!se,re=(0,r.Z)("WebPage",w&&"in-preview",se&&"with-square-photo",!X&&!K&&!w&&"without-media",K&&"with-video",!oe&&"no-article",ee&&"with-document",ne&&"with-quick-button");return a.ZP.createElement("div",{className:re,"data-initial":(H||q)[0],dir:j.isRtl?"rtl":"auto"},a.ZP.createElement("div",{className:(0,r.Z)("WebPage--content",te&&"is-story")},te&&a.ZP.createElement(E.Z,{story:T,isProtected:M,isConnected:k,isPreview:!0}),X&&!K&&a.ZP.createElement(y.Z,{message:e,observeIntersection:t,noAvatars:n,canAutoLoad:C,size:se?"pictogram":"inline",asForwarded:I,nonInteractive:!ie,isDownloading:N,isProtected:M,theme:x,onClick:ie?_:void 0,onCancelUpload:D}),oe&&a.ZP.createElement("div",{className:"WebPage-text"},A&&a.ZP.createElement(f.Z,{emojiDocumentId:A,className:"WebPage--background-icons"}),a.ZP.createElement(v.Z,{className:"site-name",url:W,text:H||q}),!w&&G&&a.ZP.createElement("p",{className:"site-title"},(0,l.Z)(G)),ae&&a.ZP.createElement("p",{className:"site-description"},(0,l.Z)(ae,["emoji","br"]))),!w&&K&&a.ZP.createElement(b.Z,{message:e,observeIntersectionForLoading:t,noAvatars:n,canAutoLoad:C,canAutoPlay:S,asForwarded:I,isDownloading:N,isProtected:M,onClick:ie?_:void 0,onCancelUpload:D}),!w&&J&&a.ZP.createElement(Z.ZP,{theme:x,message:e,origin:s.Cr.Inline,noAvatars:n,isDownloading:N,onPlay:B,onCancelUpload:D}),!w&&ee&&a.ZP.createElement(g.Z,{message:e,observeIntersection:t,autoLoadFileMaxSizeMb:O,onMediaClick:_,onCancelUpload:D,isDownloading:N,shouldWarnAboutSvg:R}),w&&q&&!oe&&a.ZP.createElement("div",{className:"WebPage-text"},A&&a.ZP.createElement(f.Z,{emojiDocumentId:A,className:"WebPage--background-icons"}),a.ZP.createElement("p",{className:"site-name"},q),a.ZP.createElement("p",{className:"site-description"},j("Chat.Empty.LinkPreview")))),ne&&(ce=ne,a.ZP.createElement(P.Z,{className:"WebPage--quick-button",size:"tiny",color:"translucent",isRectangular:!0,onClick:V},j(ce))));var ce}))},26593:(e,t,n)=>{n.d(t,{Z:()=>o});const a={dark:{outgoing:"rgb(135,116,225)",incoming:"rgb(33,33,33)"},light:{outgoing:"rgb(238,255,222)",incoming:"rgb(255,255,255)"}};function o(e,t,n,o){return n?Promise.resolve(a[o||"light"][t?"outgoing":"incoming"]):async function(e,t){const n=new Image;n.src=e,n.crossOrigin="anonymous",n.width||await new Promise((e=>{n.onload=e}));const a=document.createElement("canvas"),o=a.getContext("2d");a.width=n.width,a.height=n.height,o.drawImage(n,0,0,n.width,n.height);const s=t?n.width-1:0,i=n.height-1;return`rgba(${Array.from(o.getImageData(s,i,1,1).data).join(",")})`}(e,t)}},83967:(e,t,n)=>{n.d(t,{GH:()=>m,Pw:()=>d,Vx:()=>r,Xo:()=>l});var a=n(4463),o=n(74399);const s=12,i=40,r=20*o.Gw,c=s*o.Gw,l=5*o.Gw;function d(e,t){return(e?.length??0)>i||t?r:c}function m(e,t,n,i){const r=(0,a.B4)(e),c=(0,a.O$)(e)||(0,a.F$)(e),m=(0,a.b7)(e),u=Boolean((0,a.F$)(e)),h=Boolean((0,a.Cg)(e)),{width:p,height:Z}=c?(0,o.Eh)(c,r,t,u,n,i):(0,o.GC)(m,r,t,h,n,i),g=d((0,a.UD)(e));let f=1;p<g&&g-p<s&&(f=g/p),Z*f<l&&l-Z*f<s&&(f=l/Z);const v=Math.round(p*f),P=Math.round(Z*f);return{width:v,height:P,isSmall:v<g||P<l}}},41280:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(4463),o=n(97184),s=n(42797),i=n(15866);function r(e,t,n){const{isMobile:r}=(0,s.ZP)(),c=n||(0,a.DH)(e);return(0,i.Z)(c,Boolean(t),r&&!o.vX)}},45277:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(60748),o=n(31664),s=n(57710),i=n(81740);const r=500,c=750,l=20;function d(e,t,n,d,m,u,h,p){const Z=(0,a.sO)(!h);(0,a.bt)((()=>{const t=Z.current;if(Z.current=!1,n&&e.current){const n=e.current.closest(".MessageList"),a=m,h=()=>{const t=(0,i.ZP)(n,e.current,a?"end":"centerOrTop",l,void 0!==d?a?r:c:void 0,d,void 0,u,!0);if(p){const t=e.current.querySelector(".is-quote");t&&(0,s.WM)((()=>{(0,o.D_)(t,"animate")}))}return t};t?(0,s.lT)(h):(0,s.i$)((()=>{(0,s.WM)(h())}))}}),[e,t,n,d,m,u,p])}},75368:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(33555),s=n(69118);const i=new Map;function r(e,t,n,s){const r=s&&n?e?.byLangCode[s]?.[n]:void 0,{isPending:l,text:d}=r||{};return(0,a.d4)((()=>{t&&n&&!d&&void 0===l&&s&&function(e,t,n){const a=i.get(n)||new Map,s=a.get(e)||[];s.includes(t)||(s.push(t),a.set(e,s),i.set(n,a),(0,o.Sv)().markMessagesTranslationPending({chatId:e,messageIds:s,toLanguageCode:n})),c()}(t,n,s)}),[t,d,l,n,s]),t&&n?{isPending:l,translatedText:d}:{isPending:!1,translatedText:void 0}}const c=(0,s.P2)((function(){const{translateMessages:e}=(0,o.Sv)();let t=!1;i.forEach(((n,a)=>{n.forEach(((n,o)=>{const s=n.slice(0,20);s.length<n.length&&(t=!0),e({chatId:o,messageIds:s,toLanguageCode:a}),function(e,t,n){const a=i.get(n);if(!a?.size)return void i.delete(n);const o=a.get(e);if(!o?.length)return void a.delete(e);const s=o.filter((e=>!t.includes(e)));if(!s?.length)return a.delete(e),void(a.size||i.delete(n));a.set(e,s)}(o,s,a)}))})),t&&c()}),500)},96621:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(60748),o=n(33555),s=n(4463),i=n(46752),r=n(59107),c=n(25190),l=n(231),d=n(8337),m=n(74399),u=n(96459),h=n(65979);const p="uGUjDZKl",Z="M62HGuIV",g="WMpEr5XQ",f=2*m.Gw,v=(0,a.X$)((({reaction:e,chosen:t,isReady:n,noAppearAnimation:o,style:s,isLocked:r,onToggleReaction:c})=>a.ZP.createElement("div",{className:(0,i.Z)(p,"oc1hpMwv",t&&Z,!o&&n&&"sx6RTuAU",o&&"kqcWe4tf"),style:s,onClick:function(){c(e)}},a.ZP.createElement(u.Z,{documentId:e.documentId,size:f}),r&&a.ZP.createElement(h.Z,{className:g,name:"lock-badge"}))));var P=n(60706),E=n(6202),y=n(97799);const b=2*m.Gw,C=(0,a.X$)((({reaction:e,isReady:t,noAppearAnimation:n,chosen:o,isLocked:s,onToggleReaction:r})=>{const c=(0,E.Z)(`sticker${e.appearAnimation?.id}`,!t||n),l=(0,E.Z)(`document${e.selectAnimation?.id}`,!t||n),d=(0,E.Z)(`document${e.staticIcon?.id}`,!n),[m,u]=(0,P.Z)(),[f,,v]=(0,P.Z)(!0),[C,S,w]=(0,P.Z)();return a.ZP.createElement("div",{className:(0,i.Z)(p,o&&Z),onClick:function(){r(e.reaction)},onMouseEnter:t&&!f?S:void 0},n&&a.ZP.createElement("img",{className:"MZ2tH980",src:d,alt:e.reaction.emoticon,draggable:!1}),!m&&!n&&a.ZP.createElement(y.Z,{key:e.appearAnimation?.id,tgsUrl:c,play:f,noLoop:!0,size:b,onEnded:v,forceAlways:!0}),!f&&!n&&a.ZP.createElement(y.Z,{key:e.selectAnimation?.id,tgsUrl:l,play:C,noLoop:!0,size:b,onLoad:u,onEnded:w,forceAlways:!0}),s&&a.ZP.createElement(h.Z,{className:g,name:"lock-badge"}))})),S=(0,i.y)("ReactionSelector"),w=(0,a.X$)((({allAvailableReactions:e,topReactions:t,defaultTagReactions:n,enabledReactions:m,currentReactions:u,maxUniqueReactions:h,isPrivate:p,isReady:Z,canPlayAnimatedEmojis:g,className:f,isCurrentUserPremium:P,isInSavedMessages:E,isInStoryViewer:y,onClose:b,onToggleReaction:w,onShowMore:I})=>{const{openPremiumModal:N}=(0,o.Sv)(),M=(0,a.sO)(null),k=(0,r.Z)(),T=E&&!P&&!y,x=(0,a.Ye)((()=>{const a=E?n:"some"===m?.type?m.allowed:e?.map((e=>e.reaction)),o=a?.map((t=>{const n="documentId"in t,a=e?.find((e=>(0,s.Hl)(e.reaction,t)));if((n||a)&&!a?.isInactive&&(p||m&&(0,s.XU)(t,m))&&(!(h&&u&&u.length>=h)||u.some((({reaction:e})=>(0,s.Hl)(t,e)))))return n?t:a})).filter(Boolean)||[];return(0,s.PO)(o,t)}),[e,u,n,m,E,p,h,t]),A=(0,a.Ye)((()=>8===x.length?x:x.slice(0,7)),[x]),R=A.length<x.length,O=(0,a.Ye)((()=>{const e=u?.filter((({chosenOrder:e})=>void 0!==e))||[];return new Set(e.map((({reaction:e})=>A.findIndex((t=>t&&(0,s.Hl)("reaction"in t?t.reaction:t,e))))))}),[u,A]),L=(0,c.Z)((()=>{const e=M.current?.getBoundingClientRect()||{x:0,y:0};I({x:e.x,y:e.y})})),B=(0,c.Z)((()=>{b?.(),N({initialSection:"saved_tags"})})),D=(0,a.Ye)((()=>{if(E){if(!P){const e=k("lng_subscribe_tag_about").split("{link}");return a.ZP.createElement("span",null,e[0],a.ZP.createElement(d.Z,{isPrimary:!0,onClick:B},k("lng_subscribe_tag_link")),e[1])}return k("SavedTagReactionsHint2")}if(y)return k("StoryReactionsHint")}),[P,E,y,k]);if(A.length)return a.ZP.createElement("div",{className:(0,i.Z)(S("&",k.isRtl&&"isRtl"),f),ref:M},a.ZP.createElement("div",{className:S("bubble-small",k.isRtl&&"isRtl")}),a.ZP.createElement("div",{className:S("items-wrapper")},a.ZP.createElement("div",{className:S("bubble-big",k.isRtl&&"isRtl")}),a.ZP.createElement("div",{className:S("items")},D&&a.ZP.createElement("div",{className:S("hint")},D),a.ZP.createElement("div",{className:S("reactions"),dir:k.isRtl?"rtl":void 0},A.map(((e,t)=>"reaction"in e?a.ZP.createElement(C,{key:(0,s.jq)(e.reaction),isReady:Z,onToggleReaction:w,reaction:e,noAppearAnimation:!g,chosen:O.has(t),isLocked:T}):a.ZP.createElement(v,{key:(0,s.jq)(e),isReady:Z,onToggleReaction:w,reaction:e,noAppearAnimation:!g,chosen:O.has(t),isLocked:T,style:`--_animation-delay: ${20*(7-t)}ms`}))),R&&a.ZP.createElement(l.Z,{color:"translucent",className:S("show-more"),onClick:L},a.ZP.createElement("i",{className:"icon icon-down"}))))))}))},14018:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(60748),o=n(33555),s=n(46752),i=n(74399),r=n(17240),c=n(60706),l=n(59107),d=n(25190),m=n(12644),u=n(36368),h=n(231),p=n(97687),Z=n(34563);const g=(0,a.X$)((({isOpen:e,title:t,subtitle:n,placeholder:o,submitText:s,maxLength:i,initialValue:r="",onClose:c,onSubmit:m})=>{const u=(0,l.Z)(),[g,f]=(0,a.eJ)(r),v=(0,d.Z)((e=>{f(e.target.value)})),P=(0,d.Z)((()=>{m(g)}));return a.ZP.createElement(Z.Z,{className:"narrow",title:t,isOpen:e,onClose:c,isSlim:!0},Boolean(n)&&a.ZP.createElement("div",{className:"cGrbcqD_"},n),a.ZP.createElement(p.Z,{placeholder:o,value:g,onChange:v,maxLength:i,teactExperimentControlled:!0}),a.ZP.createElement("div",{className:"dialog-buttons mt-2"},a.ZP.createElement(h.Z,{className:"confirm-dialog-button",onClick:P},s||u("Save")),a.ZP.createElement(h.Z,{className:"confirm-dialog-button",isText:!0,onClick:c},u("Cancel"))))}));var f=n(52328),v=n(58964),P=n(31482);const E=1.25*i.Gw,y=(0,a.X$)((({reaction:e,tag:t,containerId:n,isChosen:i,isOwnMessage:p,className:Z,chosenClassName:y,withCount:b,isDisabled:C,withContextMenu:S,observeIntersection:w,onClick:I,onRemove:N})=>{const{editSavedReactionTag:M}=(0,o.Sv)(),k=(0,a.sO)(null),T=(0,a.sO)(null),x=(0,l.Z)(),[A,R,O]=(0,c.Z)(),{title:L,count:B}=t||{},D=Boolean(L||b&&B),$=(0,d.Z)((()=>{I?.(e)})),F=(0,d.Z)((()=>{N?.(e)})),U=(0,d.Z)((t=>{M({reaction:e,title:t}),O()})),{isContextMenuOpen:j,contextMenuPosition:_,handleBeforeContextMenu:V,handleContextMenu:z,handleContextMenuClose:H,handleContextMenuHide:W}=(0,r.Z)(k,!S),q=(0,d.Z)((()=>k.current)),G=(0,d.Z)((()=>document.body)),Y=(0,d.Z)((()=>T.current)),{positionX:X,positionY:K,transformOriginX:J,transformOriginY:Q,style:ee}=(0,m.Z)(_,q,G,Y,(()=>({withPortal:!0,shouldAvoidNegativePosition:!0})));if(!b||0!==B)return a.ZP.createElement(h.Z,{className:(0,s.Z)(P.Z.root,P.Z.tag,p&&P.Z.own,i&&P.Z.chosen,i&&y,C&&P.Z.disabled,Z),size:"tiny",onClick:$,onMouseDown:V,onContextMenu:z,ref:k},a.ZP.createElement(u.Z,{className:P.Z.animatedEmoji,containerId:n,reaction:e,loopLimit:1,size:E,observeIntersection:w}),D&&a.ZP.createElement("span",{className:P.Z.tagText},L&&a.ZP.createElement("span",null,L),b&&a.ZP.createElement("span",null,B)),a.ZP.createElement("svg",{className:P.Z.tail,width:"15",height:"30",viewBox:"0 0 15 30"},a.ZP.createElement("path",{className:P.Z.tailFill,d:"m 0,30 c 3.1855,0 6.1803,-1.5176 8.0641,-4.0864 l 5.835,-7.9568 c 1.2906,-1.7599 1.2906,-4.1537 0,-5.9136 L 8.0641,4.08636 C 6.1803,1.51761 3.1855,0 0,0"})),S&&a.ZP.createElement(g,{isOpen:A,maxLength:15,title:x(t?.title?"SavedTagRenameTag":"SavedTagLabelTag"),subtitle:x("SavedTagLabelTagText"),placeholder:x("SavedTagLabelPlaceholder"),initialValue:t?.title,onClose:O,onSubmit:U}),S&&_&&a.ZP.createElement(f.Z,{ref:T,isOpen:j,transformOriginX:J,transformOriginY:Q,positionX:X,positionY:K,style:ee,autoClose:!0,withPortal:!0,onClose:H,onCloseAnimationEnd:W},a.ZP.createElement(v.Z,{icon:"tag-filter",onClick:$},x("SavedTagFilterByTag")),a.ZP.createElement(v.Z,{icon:"tag-name",onClick:R},x(t?.title?"SavedTagRenameTag":"SavedTagLabelTag")),a.ZP.createElement(v.Z,{icon:"tag-crossed",destructive:!0,onClick:F},x("SavedTagRemoveTag"))))}))},17891:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(65326),s=n(34446);function i(e,t){const n=void 0===t,i=(0,a.sO)(n),r=(0,a.sO)(),c=(0,o.Z)();return(0,s.Z)((()=>{n||(i.current=!1,r.current&&(clearTimeout(r.current),r.current=void 0))}),e),(0,a.d4)((()=>{if(n||i.current)return;const e=()=>{i.current=!0,c()};t>0?r.current=window.setTimeout(e,t):e()}),e),i.current}},16289:(e,t,n)=>{n.d(t,{Z:()=>g});var a=n(60748),o=n(46752),s=n(790),i=n(2155),r=n(59107);const c="gvrp3KoR",l="IHb3ZATQ",d="zAPFdKbZ",m=[[{name:"followers",title:"ChannelStats.Overview.Followers"},{name:"enabledNotifications",title:"ChannelStats.Overview.EnabledNotifications",isPercentage:!0}],[{name:"viewsPerPost",title:"ChannelStats.Overview.ViewsPerPost"},{name:"viewsPerStory",title:"ChannelStats.Overview.ViewsPerStory"}],[{name:"sharesPerPost",title:"ChannelStats.Overview.SharesPerPost"},{name:"sharesPerStory",title:"ChannelStats.Overview.SharesPerStory"}],[{name:"reactionsPerPost",title:"ChannelStats.Overview.ReactionsPerPost"},{name:"reactionsPerStory",title:"ChannelStats.Overview.ReactionsPerStory"}]],u=[[{name:"members",title:"Stats.GroupMembers"},{name:"messages",title:"Stats.GroupMessages"}],[{name:"viewers",title:"Stats.GroupViewers"},{name:"posters",title:"Stats.GroupPosters"}]],h=[[{name:"viewsCount",title:"Stats.Message.Views",isPlain:!0},{name:"publicForwards",title:"Stats.Message.PublicShares",isPlain:!0}],[{name:"reactionsCount",title:"Channel.Stats.Overview.Reactions",isPlain:!0},{name:"forwardsCount",title:"Stats.Message.PrivateShares",isPlain:!0,isApproximate:!0}]],p=[[{name:"viewsCount",title:"Channel.Stats.Overview.Views",isPlain:!0},{name:"publicForwards",title:"PublicShares",isPlain:!0}],[{name:"reactionsCount",title:"Channel.Stats.Overview.Reactions",isPlain:!0},{name:"forwardsCount",title:"PrivateShares",isPlain:!0}]],Z=[[{name:"level",title:"Stats.Boosts.Level",isPlain:!0},{name:"premiumSubscribers",title:"Stats.Boosts.PremiumSubscribers",isPercentage:!0,isApproximate:!0,withAbsoluteValue:!0}],[{name:"boosts",title:"Stats.Boosts.ExistingBoosts",isPlain:!0},{name:"remainingBoosts",title:"Stats.Boosts.BoostsToLevelUp",isPlain:!0}]],g=(0,a.X$)((({title:e,type:t,statistics:n,className:g})=>{const f=(0,r.Z)(),{period:v}=n,P=function(e){switch(e){case"group":return u;case"message":return h;case"boost":return Z;case"story":return p;default:return m}}(t);return a.ZP.createElement("div",{className:(0,o.Z)("Gi8Nokbl",g)},a.ZP.createElement("div",{className:"H01lE7mv"},e&&a.ZP.createElement("div",{className:"VQbs04hT"},e),v&&a.ZP.createElement("div",{className:"X7bBlGdi"},(0,s.Tu)(f,1e3*v.minDate)," — ",(0,s.Tu)(f,1e3*v.maxDate))),a.ZP.createElement("table",{className:"s5beXqqL"},P.map((e=>a.ZP.createElement("tr",null,e.map((e=>{const t=n[e.name];return e.isPlain?a.ZP.createElement("td",{className:c},a.ZP.createElement("b",{className:d},`${e.isApproximate?"≈":""}${(0,i.kh)(t)}`),a.ZP.createElement("h3",{className:l},f(e.title))):e.isPercentage?a.ZP.createElement("td",{className:c},e.withAbsoluteValue&&a.ZP.createElement("span",{className:d},`${e.isApproximate?"≈":""}${(0,i.kh)(t.part)}`),a.ZP.createElement("span",{className:e.withAbsoluteValue?"_mYEmh_u":d},t.percentage,"%"),a.ZP.createElement("h3",{className:l},f(e.title))):a.ZP.createElement("td",{className:c},a.ZP.createElement("b",{className:d},(0,i.bi)(t.current))," ",(({change:e,percentage:t})=>{if(!e)return;const n=Number(e)<0;return a.ZP.createElement("span",{className:(0,o.Z)("idLrmbhS",n&&"SLfwGHQC")},n?`-${(0,i.bi)(Math.abs(e))}`:`+${(0,i.bi)(e)}`,t&&a.ZP.createElement(a.ZP.Fragment,null," ","(",t,"%)"))})(t),a.ZP.createElement("h3",{className:l},f(e.title)))})))))))}))},47505:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(60748),o=n(33555),s=n(46752),i=n(42797),r=n(78781),c=n(59107),l=n(91713),d=n(4463),m=n(30386),u=n(17240),h=n(25190),p=n(12644),Z=n(19156),g=n(70172),f=n(52328),v=n(58964),P=n(41372);const E=(0,a.X$)((function({peer:e,isArchived:t}){const{openChat:n,openChatWithInfo:i,openStoryViewer:r,toggleStoriesHidden:E}=(0,o.Sv)(),y=(0,c.Z)(),b=(0,a.sO)(null),C="isSelf"in e&&e.isSelf,S=!(0,d.YC)(e.id);(0,Z.Z)(e.id);const{isContextMenuOpen:w,contextMenuPosition:I,handleBeforeContextMenu:N,handleContextMenu:M,handleContextMenuClose:k,handleContextMenuHide:T}=(0,u.Z)(b),x=(0,h.Z)((()=>b.current)),A=(0,h.Z)((()=>document.body)),R=(0,h.Z)((()=>b.current.querySelector(".story-peer-context-menu .bubble"))),O=(0,h.Z)((()=>({withPortal:!0,isDense:!0}))),{positionX:L,positionY:B,transformOriginX:D,transformOriginY:$,style:F}=(0,p.Z)(I,x,A,R,O),U=(0,h.Z)((()=>{w||r({peerId:e.id,origin:l.ze.StoryRibbon})})),j=(0,h.Z)((e=>{(0,m.b)(e),N(e)})),_=(0,h.Z)((()=>{i({id:e.id,shouldReplaceHistory:!0,profileTab:"stories"})})),V=(0,h.Z)((()=>{i({id:e.id,shouldReplaceHistory:!0,profileTab:"storiesArchive"})})),z=(0,h.Z)((()=>{n({id:e.id,shouldReplaceHistory:!0})})),H=(0,h.Z)((()=>{i({id:e.id,shouldReplaceHistory:!0})})),W=(0,h.Z)((()=>{E({peerId:e.id,isHidden:!t})}));return a.ZP.createElement("div",{ref:b,role:"button","data-peer-id":e.id,tabIndex:0,className:P.Z.peer,onMouseDown:j,onClick:U,onContextMenu:M},a.ZP.createElement(g.Z,{peer:e,withStory:!0,storyViewerOrigin:l.ze.StoryRibbon,storyViewerMode:"full"}),a.ZP.createElement("div",{className:(0,s.Z)(P.Z.name,e.hasUnreadStories&&P.Z.name_hasUnreadStory)},C?y("MyStory"):(0,d.OU)(y,e)),void 0!==I&&a.ZP.createElement(f.Z,{isOpen:w,transformOriginX:D,transformOriginY:$,positionX:L,positionY:B,style:F,className:(0,s.Z)("story-peer-context-menu",P.Z.contextMenu),autoClose:!0,withPortal:!0,onClose:k,onCloseAnimationEnd:T},C?a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(v.Z,{onClick:_,icon:"play-story"},y("StoryList.Context.SavedStories")),a.ZP.createElement(v.Z,{onClick:V,icon:"archive"},y("StoryList.Context.ArchivedStories"))):a.ZP.createElement(a.ZP.Fragment,null,!S&&a.ZP.createElement(v.Z,{onClick:z,icon:"message"},y("SendMessageTitle")),S?a.ZP.createElement(v.Z,{onClick:H,icon:"channel"},y("ChatList.ContextOpenChannel")):a.ZP.createElement(v.Z,{onClick:H,icon:"user"},y("StoryList.Context.ViewProfile")),a.ZP.createElement(v.Z,{onClick:W,icon:t?"unarchive":"archive"},y(t?"StoryList.Context.Unarchive":"StoryList.Context.Archive")))))})),y=(0,a.X$)((0,o.c$)(((e,{isArchived:t})=>{const{orderedPeerIds:{active:n,archived:a}}=e.stories;return{orderedPeerIds:t?a:n,usersById:e.users.byId,chatsById:e.chats.byId}}))((function({isArchived:e,className:t,orderedPeerIds:n,usersById:o,chatsById:l,isClosing:d}){const m=(0,c.Z)(),u=(0,s.Z)(P.Z.root,!n.length&&P.Z.hidden,d&&P.Z.closing,t,"no-scrollbar"),h=(0,a.sO)(null);return(0,r.Z)(h,(0,i.W7)()),a.ZP.createElement("div",{ref:h,id:"StoryRibbon",className:u,dir:m.isRtl?"rtl":void 0},n.map((t=>{const n=o[t]||l[t];if(n)return a.ZP.createElement(E,{key:t,peer:n,isArchived:e})})))})))},85194:(e,t,n)=>{n.d(t,{Z:()=>Z});var a=n(60748),o=n(33555),s=n(83716),i=n(7054),r=n(46752),c=n(32136),l=n(18674),d=n(59107),m=n(31212),u=n(19156),h=n(70172),p=n(4710);const Z=(0,a.X$)((0,o.c$)(((e,{isArchived:t})=>{const{orderedPeerIds:{archived:n,active:a},byPeerId:o}=e.stories,{storyViewer:{isRibbonShown:s,isArchivedRibbonShown:r}}=(0,i.jUK)(e),c=(0,i.nd)(e),l=(0,i.$Yd)(e,"storyRibbonAnimations");return{currentUserId:e.currentUserId,orderedPeerIds:t?n:a,isShown:t?!r:!s,isForumPanelOpen:c,withAnimation:l,usersById:e.users.byId,chatsById:e.chats.byId,peerStories:o}}))((function({currentUserId:e,orderedPeerIds:t,usersById:n,chatsById:i,canShow:Z,isShown:g,isForumPanelOpen:f,isArchived:v,withAnimation:P,peerStories:E}){const{toggleStoryRibbon:y}=(0,o.Sv)(),b=(0,d.Z)(),C=(0,a.Ye)((()=>1===t.length?[n[t[0]]||i[t[0]]]:t.map((e=>n[e]||i[e])).filter((t=>t&&t.id!==e)).slice(0,s.Ob7).reverse()),[e,t,n,i]),S=(0,a.Ye)((()=>C?.length?C.reduce(((e,t)=>{const n=E[t.id];if(!n)return e;const a=n.orderedIds.some((e=>{const t=n.byId[e];if(!t||!("isForCloseFriends"in t))return!1;const a=n.lastReadId&&t.id<=n.lastReadId;return t.isForCloseFriends&&!a}));return e[t.id]=a,e}),{}):{}),[E,C]),w=(0,a.Ye)((()=>t.slice(0,5)),[t]);(0,u.Z)(w);const I=Z&&g,{shouldRender:N,transitionClassNames:M}=(0,m.Z)(I,void 0,void 0,"slow");if((0,a.d4)((()=>{P&&!f&&(I?((0,l.YW)(c.zn+s.fK3),(0,c.V$)(v)):((0,l.YW)(c.zn+s.fK3),(0,c.DO)(v)))}),[v,I,P,f]),N)return a.ZP.createElement("button",{type:"button",id:"StoryToggler",className:(0,r.Z)(p.Z.root,M),"aria-label":b("Chat.Context.Peer.OpenStory"),onClick:()=>y({isShown:!0,isArchived:v}),dir:b.isRtl?"rtl":void 0},C.map((e=>a.ZP.createElement(h.Z,{key:e.id,peer:e,size:"tiny",className:p.Z.avatar,withStorySolid:!0,forceFriendStorySolid:S[e.id]}))))})))},32136:(e,t,n)=>{n.d(t,{DO:()=>g,V$:()=>f,zn:()=>d});var a=n(83716),o=n(57710),s=n(9933),i=n(3858),r=n(74399),c=n(41372),l=n(4710);const d=250,m=.25*r.Gw,u=11,h=.1875*r.Gw,p=.125*r.Gw,Z=new Set;function g(e){C();const{container:t,toggler:n,leftMainHeader:i,ribbonPeers:r,toggleAvatars:c}=v(e);if(!(n&&c&&r&&t&&i))return;const{bottom:p,right:g}=i.getBoundingClientRect(),f=p+m,S=c[0],w=c[c.length-1],I=E(S);Array.from(r).reverse().forEach(((e,i,{length:r})=>{const c=E(e);if(!c)return;const m=c===I;let p=y(n,c),v=u+i+1;if(p||(p=i===r-1?w:S,v=u),!p)return;let{top:C,left:N,width:M}=p.getBoundingClientRect();const{left:k,width:T}=e.getBoundingClientRect();if(k>g)return;N-=h,M+=2*h;const x=N-k,A=C-f,R=M/T;C-=h;const O=k-N+2*h,L=f-C+h,B=T/(M+2*h);(0,o.WM)((()=>{if(!p)return;const n=P(e);let i;v>u?(i=P(p),m&&i.classList.add(l.Z.ghostLast)):n.classList.add(l.Z.ghostAnimateName),(0,s.Zs)(n,{top:`${f}px`,left:`${k}px`,zIndex:`${v}`,opacity:i?"0":"",transform:`translate3d(${x}px, ${A}px, 0) scale(${R})`}),i&&(0,s.Zs)(i,{top:`${C}px`,left:`${N}px`,zIndex:`${v}`}),t.appendChild(n),i&&t.appendChild(i),p.classList.add("animating"),e.classList.add("animating"),(0,o.WM)((()=>{(0,s.Zs)(n,{opacity:"",transform:""}),i?(0,s.Zs)(i,{opacity:"0",transform:`translate3d(${O}px, ${L}px, 0) scale(${B})`}):n.classList.add(l.Z.ghostRevealName);const r=b((()=>{(0,o.WM)((()=>{t.contains(n)&&t.removeChild(n),i&&t.contains(i)&&t.removeChild(i),p?.classList.remove("animating"),e.classList.remove("animating")}))}),d+a.fK3);Z.add(r)}))}))}))}function f(e){C();const{container:t,toggler:n,toggleAvatars:i,ribbonPeers:r,leftMainHeader:c}=v(e);if(!(n&&i&&r&&t&&c))return;const{right:m}=c.getBoundingClientRect(),g=i[0],f=i[i.length-1],S=E(g);Array.from(r).reverse().forEach(((e,i,{length:r})=>{const c=E(e);if(!c)return;const v=c===S;let C=y(n,c),w=u+i+1;if(C||(C=i===r-1?f:g,w=u),!C)return;const{top:I,left:N,width:M}=e.getBoundingClientRect();let{left:k,width:T,top:x}=C.getBoundingClientRect();if(N>m)return;k-=h,T+=2*h;const A=k-N,R=x-I-p,O=T/M;x-=h;const L=N-k+2*h,B=I-x+h,D=M/(T+2*h);(0,o.WM)((()=>{const n=P(e);let i;w>u?(i=P(C),v&&i.classList.add(l.Z.ghostLast)):n.classList.add(l.Z.ghostAnimateName,l.Z.ghostRevealName),(0,s.Zs)(n,{top:`${I}px`,left:`${N}px`,width:`${M}px`,zIndex:`${w}`}),i&&(0,s.Zs)(i,{top:`${x}px`,left:`${k}px`,zIndex:`${w}`,opacity:"0",transform:`translate3d(${L}px, ${B}px, 0) scale(${D})`}),e.classList.add("animating"),C.classList.add("animating"),t.appendChild(n),i&&t.appendChild(i),(0,o.WM)((()=>{(0,s.Zs)(n,{opacity:i?"0":"",transform:`translate3d(${A}px, ${R}px, 0) scale(${O})`}),i?(0,s.Zs)(i,{opacity:"",transform:""}):n.classList.remove(l.Z.ghostRevealName);const r=b((()=>{(0,o.WM)((()=>{t.contains(n)&&t.removeChild(n),i&&t.contains(i)&&t.removeChild(i),e.classList.remove("animating"),C.classList.remove("animating")}))}),d+a.fK3);Z.add(r)}))}))}))}function v(e){let t=document.getElementById("LeftColumn");if(t&&e&&(t=t.querySelector(".ArchivedChats")),!t)return{};const n=t.querySelector("#StoryToggler"),a=t.querySelector("#StoryRibbon"),o=t.querySelector(".left-header"),s=a?.querySelectorAll(`.${c.Z.peer}`),i=n?.querySelectorAll(".Avatar");return{container:t,toggler:n,leftMainHeader:o,ribbonPeers:s,toggleAvatars:i}}function P(e){const t=e.cloneNode(!0);t.classList.add(l.Z.ghost),t.classList.remove("animating"),t.draggable=!1,t.oncontextmenu=i.Z;const n=e.querySelector("canvas");if(n){const e=t.querySelector("canvas");e?.getContext("2d")?.drawImage(n,0,0)}return t}function E(e){return e?.getAttribute("data-peer-id")}function y(e,t){return e?.querySelector(`[data-peer-id="${t}"]`)}function b(e,t){const n=setTimeout(e,t);return()=>{clearTimeout(n),e()}}function C(){Z.forEach((e=>e())),Z.clear()}},29497:(e,t,n)=>{n.d(t,{M:()=>a,X:()=>o});const a="video/mp4; codecs=hvc1.1.6.L63.00",o="video/mp4; codecs=avc1.64001E"},19156:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(60748),o=n(33555),s=n(59187),i=n(4463),r=n(7054),c=n(36560),l=n(71394),d=n(40647),m=n(80793),u=n(69118),h=n(29497),p=n(87712);const Z={},g=(0,u.wO)(1e3),f=function(e,t){(0,a.d4)((()=>{if(void 0===e)return;(Array.isArray(e)?e:[e]).forEach((e=>{const n=t||(0,o.Rd)().stories.byPeerId[e]?.orderedIds?.[0];n&&(async e=>{await g,e.forEach((({hash:e,format:t,isStream:n})=>{n?async function(e){const t=(0,m.z)((0,d.Oj)(e));let n=0;for await(const e of t)if(n+=e.byteLength,n>=2097152)break}(e):d.he(e,t).then((e=>{e&&(t===s.IU.Progressive&&function(e){const t=document.head,n=document.createElement("video");n.preload="auto",n.src=e,n.muted=!0,n.autoplay=!0,n.disableRemotePlayback=!0,n.style.display="none",t.appendChild(n),n.load(),setTimeout((()=>{(0,c.Z)(n),t.removeChild(n)}),1e3)}(e),t===s.IU.BlobUrl&&(0,l.pt)(e))}))}))})(function(e,t){const n=(0,r.nST)((0,o.Rd)(),e);if(!n||!n.orderedIds?.length)return[];const a=function(e,t,n){const a=e.indexOf(t),o=Math.max(a-5,0),s=Math.min(a+5,e.length);return e.slice(o,s)}(n.orderedIds,t),c=[];return a.forEach((t=>{if(Z[e]?.has(t))return;const a=n.byId[t];if(!a||!("content"in a))return;const o=Boolean(a.content.video);c.push({hash:(0,i.Cc)(a,"full"),format:o?s.IU.Progressive:s.IU.BlobUrl,isStream:o&&(0,p.U)(h.M)}),c.push({hash:(0,i.Cc)(a),format:s.IU.BlobUrl}),a.content.altVideo&&c.push({hash:(0,i.Cc)(a,"full",!0),format:s.IU.Progressive}),Z[e]=(Z[e]||new Set).add(t)})),c}(e,n))}))}),[t,e])}},42175:(e,t,n)=>{n.d(t,{Z:()=>E});var a=n(60748),o=n(33555),s=n(83716),i=n(57710),r=n(46752),c=n(80036),l=n(22418),d=n(4463),m=n(74399),u=n(274),h=n(25190),p=n(78722),Z=n(36368);const g="pruw1nLm",f=(0,a.X$)((({story:e,mediaArea:t,index:n,className:s,style:i,isPreview:l})=>{const{sendStoryReaction:g}=(0,o.Sv)(),f=(0,a.sO)(null),[v,P]=(0,a.eJ)(1.5*m.Gw),{peerId:E,id:y,views:b}=e,{reactions:C}=b||{},{reaction:S,isDark:w,isFlipped:I}=t,N=!(0,d.YC)(E),M=`${(0,d.hl)(E,y)}-${n}-${l?"preview":"viewer"}`,k=(0,a.Ye)((()=>C?.find((e=>(0,d.Hl)(e.reaction,S)))?.count),[S,C]),T=!l&&Boolean(k)&&N,x=(0,h.Z)((()=>{if(!f.current)return;const e=f.current.clientHeight;P(Math.round(.6*e))}));(0,u.Z)((([e])=>{Boolean(k)!==Boolean(e)&&x()}),[k]),(0,p.Z)(f,x);const A=(0,h.Z)((()=>{g({peerId:E,storyId:y,containerId:M,reaction:S})}));return a.ZP.createElement("div",{ref:f,className:(0,r.Z)("WQ5DA3P_",w&&"eic2vQ8c",s),style:(0,c.Z)(i,`--custom-emoji-size: ${v}px`),onClick:A},a.ZP.createElement("div",{className:(0,r.Z)("j4MKFabm",I&&"furSXGdL")}),Boolean(v)&&a.ZP.createElement(Z.Z,{className:(0,r.Z)("Et3MvYmN",T&&"mFTLUHm2"),reaction:S,containerId:M,size:v,effectSize:4*v,shouldPause:l,shouldLoop:!l}),T&&a.ZP.createElement("span",{className:"Tr8mYyDk"},k))})),v=9/16;function P(e){const{x:t,y:n,width:a,height:o,rotation:s}=e.coordinates;return(0,c.Z)(`left: ${t}%`,`top: ${n}%`,`width: ${a}%`,`height: ${o}%`,`transform: rotate(${s}deg) translate(-50%, -50%)`)}const E=(0,a.X$)((({story:e,isActive:t,className:n})=>{const{openMapModal:c,focusMessage:d,closeStoryViewer:m}=(0,o.Sv)(),u=(0,a.sO)(null),h=(0,l.Z)();(0,a.d4)((()=>{if(!u.current||!t)return;const e=u.current;if(h.width>s.l35)return void(0,i.WM)((()=>{e.style.removeProperty("--media-width"),e.style.removeProperty("--media-height")}));const n=h.width/h.height,a=n<v?e.clientHeight*v:e.clientWidth,o=n<v?e.clientHeight:e.clientWidth/v;(0,i.WM)((()=>{e.style.setProperty("--media-width",`${a}px`),e.style.setProperty("--media-height",`${o}px`)}))}),[t,h]);const p=e.mediaAreas;return a.ZP.createElement("div",{className:(0,r.Z)("RXAMu4VD",!t&&"_5HkplWee",n),ref:u},p?.map(((n,o)=>{switch(n.type){case"geoPoint":case"venue":case"channelPost":{const e=t&&("geoPoint"===n.type||"venue"===n.type);return a.ZP.createElement("div",{className:(0,r.Z)(g,e&&"xFjJpeOA"),style:P(n),onClick:()=>(e=>{switch(e.type){case"geoPoint":case"venue":c({geoPoint:e.geo});break;case"channelPost":d({chatId:e.channelId,messageId:e.messageId}),m()}})(n)})}case"suggestedReaction":return a.ZP.createElement(f,{key:`${n.type}-${o}`,story:e,mediaArea:n,index:o,isPreview:!t,className:g,style:P(n)});default:return}})))}))},13617:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(60748),o=n(33555),s=n(97184),i=n(59107),r=n(25190);const c=8e3;function l(e,t,n){const{showNotification:l}=(0,o.Sv)(),d=(0,i.Z)(),[m,u]=(0,a.eJ)(!1),h=(0,r.Z)((()=>{u(!0),t||l({message:s.q$?d("Video.Unsupported.Mobile"):d("Video.Unsupported.Desktop"),duration:c})})),p=(0,r.Z)((e=>{const t=e.currentTarget,{error:n}=t;n&&(3!==n.code&&4!==n.code||h())})),Z=(0,r.Z)((e=>{const t=e.currentTarget;t.videoHeight&&t.videoWidth||h()}));return(0,a.d4)((()=>{if(n)return;const{current:t}=e;return t?(t.addEventListener("error",p),t.addEventListener("canplay",Z),()=>{t.removeEventListener("error",p),t.removeEventListener("canplay",Z)}):void 0}),[n,e]),m}},13995:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(60748),o=n(33555),s=n(4463),i=n(7054),r=n(69118);const c=36e5,l=new Map;let d=new Set;const m=(0,r.P2)((()=>{const e=Array.from(d),t=e.slice(0,100),n=e.slice(101);(0,o.Sv)().loadStoriesMaxIds({peerIds:t}),t.forEach((e=>l.set(e,Date.now()))),d=new Set(n),d.size&&m()}),500);function u(e){const t=(0,a.Ye)((()=>{const t=(0,o.Rd)();return e?.map((e=>(0,i.RGZ)(t,e))).filter(Boolean)}),[e]),n=(0,a.Ye)((()=>{const e=(0,o.Rd)();return t?.filter((t=>{const n=l.get(t.id)||0;if(Date.now()-n<c)return!1;if((0,s.YC)(t.id)){const n=t,a=(0,i.ssc)(e,n.id),o=a&&"userStatusEmpty"!==a.type;return!n.isContact&&!n.isSelf&&!(0,s.cS)(n)&&!t.isSupport&&o}{const e=t;return(0,s.eA)(e)&&!e.isRestricted}})).map((e=>e.id))}),[t]);(0,a.d4)((()=>{n?.length&&(n.forEach((e=>d.add(e))),m())}),[n])}},53455:(e,t,n)=>{n.d(t,{Yy:()=>i,ZP:()=>h,fi:()=>s,vb:()=>l});var a=n(60782),o=n(91090);const s=[{icon:"user",title:"FilterContacts",key:"contacts"},{icon:"non-contacts",title:"FilterNonContacts",key:"nonContacts"},{icon:"group",title:"FilterGroups",key:"groups"},{icon:"channel",title:"FilterChannels",key:"channels"},{icon:"bots",title:"FilterBots",key:"bots"}],i=[{icon:"mute",title:"FilterMuted",key:"excludeMuted"},{icon:"archive",title:"FilterArchived",key:"excludeArchived"},{icon:"readchats",title:"FilterRead",key:"excludeRead"}],r=["includedChatIds","bots","channels","groups","contacts","nonContacts"],c=["excludedChatIds","excludeArchived","excludeMuted","excludeRead"];function l(e,t,n){let o=[],s=[];if("included"===t){const{includedChatIds:t,...i}=n?e.includeFilters||{}:(0,a.ei)(e.folder,r);o=t||[],s=Object.keys(i).filter((e=>Boolean(i[e])))}else{const{excludedChatIds:t,...i}=n?e.excludeFilters||{}:(0,a.ei)(e.folder,c);o=t||[],s=Object.keys(i).filter((e=>Boolean(i[e])))}return{selectedChatIds:o,selectedChatTypes:s}}function d(e){if(e){const{includedChatIds:t,...n}=e;if(Object.values(n).filter(Boolean).length>1||t?.length)return"";if(n.bots)return"Bots";if(n.groups)return"Groups";if(n.channels)return"Channels";if(n.contacts)return"Contacts";if(n.nonContacts)return"Non-Contacts"}return""}const m={mode:"create",chatFilter:"",folder:{title:"",includedChatIds:[],excludedChatIds:[]}},u=(e,t)=>{switch(t.type){case"setTitle":return{...e,folder:{...e.folder,title:t.payload},isTouched:!0};case"setFolderId":return{...e,folderId:t.payload,mode:"edit"};case"editIncludeFilters":return{...e,includeFilters:(0,a.ei)(e.folder,r)};case"editExcludeFilters":return{...e,excludeFilters:(0,a.ei)(e.folder,c)};case"setIncludeFilters":return{...e,includeFilters:t.payload,chatFilter:""};case"setExcludeFilters":return{...e,excludeFilters:t.payload,chatFilter:""};case"saveFilters":return e.includeFilters?{...e,folder:{...(0,a.CE)(e.folder,r),title:e.folder.title?e.folder.title:d(e.includeFilters),...e.includeFilters},includeFilters:void 0,chatFilter:"",isTouched:!0}:e.excludeFilters?{...e,folder:{...(0,a.CE)(e.folder,c),...e.excludeFilters},excludeFilters:void 0,chatFilter:"",isTouched:!0}:e;case"editFolder":{const{id:e,description:n,...a}=t.payload;return{mode:"edit",folderId:e,folder:a,chatFilter:""}}case"setChatFilter":return{...e,chatFilter:t.payload};case"setIsTouched":return{...e,isTouched:t.payload};case"setIsLoading":return{...e,isLoading:t.payload};case"setError":return{...e,isLoading:!1,error:t.payload};case"setIsChatlist":return{...e,folder:{...e.folder,isChatList:t.payload}};case"reset":return m;default:return e}},h=()=>(0,o.Z)(u,m)},49488:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60748),o=n(25190);const s=function(e,t){const n=(0,o.Z)(e);(0,a.d4)((()=>{if("number"!=typeof t)return;const e=setTimeout((()=>n()),t);return()=>clearTimeout(e)}),[t])}},11309:(e,t,n)=>{n.d(t,{CH:()=>i,Vr:()=>l,WR:()=>r,iD:()=>c});var a=n(67360),o=n(71790),s=n(3927);function i(e,t,n,a=!1){return(0,s.Z)((t=>{t(e())}),t,n,a)}function r(e,t,n=!1){const a=i((()=>e()),[e],t,n);return(0,o.Z)(a,[a,e],!0)}function c(e,t,n,o=!1,s=!1){return(0,a.Z)((t=>{t(e())}),t,n,o,s)}function l(e,t,n=!1,a=!1){const s=c((()=>e()),[e],t,n,a);return(0,o.Z)(s,[s,e],!0)}},23186:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(60748),o=n(33555),s=n(83716),i=n(7054),r=n(10396),c=n(64532),l=n(85266),d=n(274),m=n(25190),u=n(34446);const h=(e,t,n,h,p,Z,g,f=!1,v,P,E=!1,y=!1,b,C=!1,S=!1)=>{const w=(0,a.sO)(null),[I,N]=(0,a.eJ)(!1);let M=I;const[k,T]=(0,a.eJ)(0),x=(0,m.Z)((()=>{N(!1),P&&P()}));(0,u.Z)((()=>{if(!e)return;w.current=(0,r.z2)(e,n,((e,a)=>{if(!S){switch(e){case"onPlay":{const{setVolume:e,setPlaybackRate:a,toggleMuted:r,proxy:l}=w.current;N(!0),"oneTimeVoice"!==n&&(0,c.N)(Z,function(e){let t={};if(e&&e.current){const{play:n,pause:a,setCurrentTime:s,proxy:i,requestNextTrack:r,requestPreviousTrack:c,isFirst:l,isLast:d}=e.current;t={play:()=>{n(i.src)},pause:()=>{a()},stop:()=>{a(),s(0),(0,o.Sv)().closeAudioPlayer()},seekbackward:e=>{const t=e.seekOffset||10;s(Math.max(i.currentTime-t,0))},seekforward:e=>{const t=e.seekOffset||10;s(Math.min(i.currentTime+t,i.duration))},seekTo:e=>{e.seekTime&&s(e.seekTime)}},d()||(t.nexttrack=()=>{r()}),l()||(t.previoustrack=()=>{c()})}return t}(w)),(0,c.pC)("playing");const{audioPlayer:d}=(0,i.jUK)((0,o.Rd)());e(d.volume),r(Boolean(d.isMuted));const m=l.duration&&Number.isFinite(l.duration)?l.duration:t;("voice"===n||m>s.J0S)&&a(d.playbackRate),(0,c.NS)({duration:l.duration||0,playbackRate:l.playbackRate,position:l.currentTime});break}case"onRateChange":{const{proxy:e}=w.current;(0,c.NS)({duration:e.duration||0,playbackRate:e.playbackRate,position:e.currentTime});break}case"onPause":N(!1),(0,c.pC)("paused"),b?.();break;case"onTimeUpdate":{const{proxy:e}=w.current;if(C&&0===e.currentTime)break;const n=e.duration&&Number.isFinite(e.duration)?e.duration:t;y||T(e.currentTime/n);break}case"onEnded":(0,c.pC)("paused")}p?.[e]?.(a)}}),v,x);const{proxy:a}=w.current;I||a.paused||(N(!0),M=!0),g&&!S&&g(a)}),[e]),(0,a.d4)((()=>{I&&Z&&(0,c.Ym)(Z)}),[Z,I]);const{play:A,pause:R,setCurrentTime:O,proxy:L,destroy:B,setVolume:D,stop:$,isFirst:F,isLast:U,requestNextTrack:j,requestPreviousTrack:_,setPlaybackRate:V,toggleMuted:z}=w.current??{},H=(0,a.Ye)((()=>L?.duration&&Number.isFinite(L.duration)?L.duration:t),[L?.duration,t]);(0,a.d4)((()=>{L&&(C&&0===L.currentTime||!H||(0,l.z)(L)||y||T(L.currentTime/H))}),[H,k,L,y,C]),(0,a.d4)((()=>()=>{B?.(E)}),[B,E]),(0,d.Z)((([e,t])=>{e===f&&h===t||L?.src&&L?.paused||f&&h&&!I&&A?.(h)}),[f,h,I,A,L?.src,L?.paused,n]);const W=(0,m.Z)((()=>{h&&A?.(h)})),q=(0,m.Z)((()=>{I?R?.():W()})),G=(0,m.Z)((e=>{O?.(e),H&&L&&T(L.currentTime/H)}));return{isPlaying:M,playProgress:k,playPause:q,pause:R,play:W,stop:$,setCurrentTime:G,setVolume:D,audioProxy:L,duration:H,requestNextTrack:j,requestPreviousTrack:_,isFirst:F,isLast:U,setPlaybackRate:V,toggleMuted:z}}},15866:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(60748),o=n(96264),s=n(57710),i=n(97184),r=n(34446);const c=2,l=2;function d(e,t=!1,n,d=c,m,u){const h=(0,a.sO)(null),p=(0,a.sO)();return(0,r.Z)((()=>{t||(p.current=!1)}),[e,t]),(0,a.d4)((()=>{const a=h.current;if(!e||!a||t||p.current)return;p.current=!0;const r=new Image,c=()=>{const e=m||r.width,t=u||r.height,n=a.getContext("2d",{alpha:!1});(0,s.WM)((()=>{a.width=e,a.height=t,i.vX&&(n.filter=`blur(${d}px)`),n.drawImage(r,2*-d,2*-d,e+4*d,t+4*d),i.vX||(0,o.Z)(n,0,0,e,t,d,l)}))};r.onload=()=>{n?(0,s.i$)(c):c()},r.src=e}),[e,t,u,m,d,n]),h}},41470:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(60748),o=n(33555),s=n(83716),i=n(4463),r=n(60782),c=n(59107);const l=({chat:e,user:t,folderId:n,isPinned:l,isMuted:d,canChangeFolder:m,isSavedDialog:u,currentUserId:h,handleDelete:p,handleMute:Z,handleChatFolderChange:g,handleReport:f},v=!1)=>{const P=(0,c.Z)(),{isSelf:E}=t||{},y=t?.id===s.awM,b=(0,a.Ye)((()=>{if(e)return u?P("Delete"):(0,i.YC)(e.id)?P("DeleteChatUser"):(0,i.cc)(e)?P("DeleteChat"):(0,i.eA)(e)?P("LeaveChannel"):P("Group.LeaveGroup")}),[e,u,P]);return(0,a.Ye)((()=>{if(!e)return;const{toggleChatPinned:a,toggleSavedDialogPinned:s,updateChatMutedState:c,toggleChatArchived:h,toggleChatUnread:C}=(0,o.Sv)(),S=()=>{u?s({id:e.id}):a({id:e.id,folderId:n})},w=l?{title:P("UnpinFromTop"),icon:"unpin",handler:S}:{title:P("PinToTop"),icon:"pin",handler:S},I={title:b,icon:"delete",destructive:!0,handler:p};if(u)return(0,r.oA)([w,I]);const N=m?{title:P("ChatList.Filter.AddToFolder"),icon:"folder",handler:g}:void 0,M=d?{title:P("ChatList.Unmute"),icon:"unmute",handler:()=>c({chatId:e.id,isMuted:!1})}:{title:`${P("ChatList.Mute")}...`,icon:"mute",handler:Z};if(v)return(0,r.oA)([w,N,M]);const k=e.unreadCount||e.hasUnreadMark?{title:P("MarkAsRead"),icon:"readchats",handler:()=>C({id:e.id})}:void 0,T=e.unreadCount||e.hasUnreadMark||e.isForum?void 0:{title:P("MarkAsUnread"),icon:"unread",handler:()=>C({id:e.id})},x=(0,i.pE)(e)?{title:P("Unarchive"),icon:"unarchive",handler:()=>h({id:e.id})}:{title:P("Archive"),icon:"archive",handler:()=>h({id:e.id})},A=f&&((0,i.eA)(e)||(0,i.Bf)(e)||t&&!t.isSelf)?{title:P("ReportPeer.Report"),icon:"flag",handler:f}:void 0,R=void 0!==n;return(0,r.oA)([N,k,T,w,!E&&M,!E&&!y&&!R&&x,A,I])}),[e,t,m,P,g,l,v,d,h,p,Z,f,n,E,y,u,b])}},71790:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(33799),o=n(93862),s=n(70971),i=n(34446);const r=function(e,t,n=!1){const r=t?e:()=>e;t??(t=[e]);const[c,l]=(0,a.Z)(),d=(0,s.Y)(r);function m(){const e=d.current;n?e(l):l(e())}return(0,i.Z)(m,t),(0,o.b)(m,t),c}},86203:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(65326),s=n(93862),i=n(70971),r=n(34446);const c=function(e,t,n=!1){const c=t?e:()=>e();t??(t=[e]);const l=(0,a.sO)(),d=(0,o.Z)(),m=(0,i.Y)(c);function u(e=!1){const t=m.current;if(n)t((e=>{l.current!==e&&(l.current=e,d())}));else{const n=t();l.current!==n&&(l.current=n,e||d())}}return(0,r.Z)((()=>{u(!0)}),t),(0,s.b)(u,t),l.current}},75790:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60748),o=n(33555);function s(e,t,n,s,i){const{loadMessage:r}=(0,o.Sv)();(0,a.d4)((()=>{i||t&&!n&&r({chatId:e,messageId:t,replyOriginForId:s})}),[i,e,n,t,s])}},31526:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(33555),s=n(69118);const i=function(e,t,n){const{loadPeerStoriesByIds:i}=(0,o.Sv)(),r=(0,a.Ye)((()=>{const n=(0,s.P2)(i,200,!0);return()=>{n({peerId:e,storyIds:[t]})}}),[t,e]);(0,a.d4)((()=>{e&&t&&(!n||!("content"in n)&&!("isDeleted"in n))&&r()}),[r,n,t,e])}},95616:(e,t,n)=>{n.d(t,{d7:()=>i,mE:()=>c,yi:()=>r});var a=n(60748),o=n(16974),s=n(65326);function i(e){const t=(0,s.Z)();return(0,a.d4)((()=>(0,o.M2)(e,t)),[e,t]),(0,o.gO)(e)}function r(){const e=(0,s.Z)();return(0,a.d4)((()=>(0,o.O6)(e)),[e]),(0,o.wC)()}function c(){const e=(0,s.Z)();return(0,a.d4)((()=>(0,o.r_)(e)),[e]),(0,o.Yz)()}},54416:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(65326),s=n(25190),i=n(34446);function r(e=!1){const t=(0,a.sO)(e),n=(0,a.sO)(!1),r=(0,o.Z)();(0,i.Z)((()=>{e&&(t.current=!0)}),[e]);const c=(0,s.Z)((()=>{t.current=!1,n.current=!1,r()})),l=(0,s.Z)((()=>{n.current=!0,r()}));return{shouldRenderForumPanel:t.current,isAnimationStarted:n.current,handleForumPanelAnimationEnd:c,handleForumPanelAnimationStart:l}}},69156:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60748),o=n(33799);function s(e){const[t,n]=(0,o.Z)();return(0,a.d4)((()=>{function t(){const t=window.getSelection();if(!t?.rangeCount)return;const a=t.getRangeAt(0);if(!a)return;if(!document.querySelector(e))return;const{commonAncestorContainer:o}=a;(o instanceof Element?o:o.parentElement).closest(e)&&n(a)}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[e,n]),t}},78781:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(60748);const o=(e,t,n=!1)=>{(0,a.d4)((()=>{if(t)return;const a=e.current;function o(e){e.deltaX||(a.scrollLeft+=e.deltaY/4,n&&e.preventDefault())}return a.addEventListener("wheel",o,{passive:!n}),()=>{a.removeEventListener("wheel",o)}}),[e,t,n])}},73541:(e,t,n)=>{n.d(t,{y:()=>r});var a=n(60748),o=n(16063);const s=new Set(["INPUT","TEXTAREA","SELECT"]),i=(0,o._)();function r(e){(0,a.d4)((()=>{if(!e)return;const t=Object.entries(e);return i.addCallback((function(e){(function(e){return!(e.target instanceof HTMLElement)||!s.has(e.target.tagName)})(e)&&t.forEach((([t,n])=>{(function(e){return t=>function(e,t){const{alt:n,ctrl:a,meta:o,mod:s,shift:i,key:r}=e,{altKey:c,ctrlKey:l,metaKey:d,shiftKey:m,key:u}=t;if(n!==c)return!1;if(s){if(!l&&!d)return!1}else{if(a!==l)return!1;if(o!==d)return!1}return i===m&&Boolean(r&&(u.toLowerCase()===r.toLowerCase()||t.code.replace("Key","").toLowerCase()===r.toLowerCase()))}(function(e){const t=e.toLowerCase().split("+").map((e=>e.trim())),n={alt:t.includes("alt"),ctrl:t.includes("ctrl"),meta:t.includes("meta"),mod:t.includes("mod"),shift:t.includes("shift")},a=["alt","ctrl","meta","shift","mod"];return{...n,key:t.find((e=>!a.includes(e)))}}(e),t)})(t)(e)&&n(e)}))}))}),[e])}document.documentElement.addEventListener("keydown",i.runCallbacks)},12515:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(57710),s=n(42797);const i=500,r=300;function c(e,t,n){const{isMobile:c}=(0,s.ZP)();(0,a.d4)((()=>{t?c||setTimeout((()=>{(0,o.WM)((()=>{e.current?.isConnected&&e.current.focus()}))}),i):(e.current?.isConnected&&e.current.blur(),n&&setTimeout(n,r))}),[e,c,t,n])}},6701:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(60748),o=n(59187),s=n(40647),i=n(69118),r=n(97184),c=n(65326),l=n(27704);const d=.75,m=1500,u=500;function h(e,t=!1,n=o.IU.BlobUrl,h,p=!1){const Z=e?s.UV(e):void 0,g=r.I_&&n===o.IU.Progressive,f=(0,c.Z)(),v=(0,l.Z)(),[P,E]=(0,a.eJ)(Z&&!g?1:0),y=(0,a.sO)(),b=(0,a.Ye)((()=>(0,i.P2)((e=>{y.current&&(!h||Date.now()-y.current>h)&&E(e)}),u,!0)),[h]);return(0,a.d4)((()=>{!t&&e&&(Z?g&&setTimeout((()=>{E(d)}),m):(E(0),y.current&&s.cC(b),y.current=Date.now(),s.he(e,n,p,b,v).then((()=>{const e=Date.now()-y.current;y.current=void 0,!h||e>=h?f():setTimeout(f,h-e)}))))}),[t,e,Z,n,f,g,h,b,p,v]),(0,a.d4)((()=>{t&&y.current&&(s.cC(b),E(0),y.current=void 0)}),[b,t]),(0,a.d4)((()=>()=>{e&&s.Iq(e,v)}),[v,e]),{mediaData:Z,loadProgress:P}}},56503:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(60748),o=n(97184),s=n(25190);const i=250;let r;function c(e,t,n=i,c=!1){const l=(0,a.sO)(!1),d=(0,s.Z)((()=>{l.current=!0}));return(0,a.d4)((()=>{r&&(clearTimeout(r),r=void 0),!e||o.$b||c||(r=window.setTimeout((()=>{l.current||t()}),2*n))}),[c,e,n,t]),[(0,s.Z)((()=>{l.current=!0})),(0,s.Z)((()=>{l.current=!1,r&&(clearTimeout(r),r=void 0),r=window.setTimeout((()=>{l.current||t()}),n)})),d]}},52678:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(65326),s=n(87204),i=n(34446);function r(e,t){const n=(0,s.Z)(e,!0),r=(0,a.sO)(),c=(0,o.Z)(),l=null!=e,d=null!=n;return l&&r.current&&(clearTimeout(r.current),r.current=void 0),(0,i.Z)((()=>{t&&!l&&d&&!r.current&&(r.current=window.setTimeout((()=>{r.current=void 0,c()}),t))}),[t,c,l,d]),r.current&&t&&!l?n:e}},91090:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60748),o=n(65326);function s(e,t){const n=(0,o.Z)(),s=(0,a.sO)(e),i=(0,a.sO)(t),r=(0,a.I4)((e=>(i.current=s.current(i.current,e),n(),i.current)),[]);return[i.current,r]}},88957:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67360);function o(e,t,n,o=[]){return(0,a.Z)((e=>{e()}),o,e,t,n)}},33057:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(60748),o=n(83716),s=n(790),i=n(82267),r=n(59107),c=n(25190),l=n(99203),d=n(48778);const m=e=>{const{isOpen:t}=e,n=(0,d.Z)(l.gl.Extra,"CalendarModal",!t);return n?a.ZP.createElement(n,e):void 0},u=(e,t,n)=>{const l=(0,r.Z)(),[d,u]=(0,a.eJ)(),h=(0,c.Z)(((e,t=!1)=>{const n=Math.round(Math.max(e.getTime(),Date.now()+6e4)/1e3)+(t?0:(0,i.Qj)());d?.(n),u(void 0)})),p=(0,c.Z)((()=>{h(new Date(1e3*o.t4X),!0)})),Z=(0,c.Z)((()=>{u(void 0),t?.()})),g=(0,c.Z)((e=>{u((()=>e))})),f=n?new Date(1e3*n):new Date;f.setSeconds(0),f.setMilliseconds(0);const v=new Date;return v.setFullYear(v.getFullYear()+1),[g,a.ZP.createElement(m,{isOpen:Boolean(d),withTimePicker:!0,selectedAt:f.getTime(),maxAt:(0,s._F)(v),isFutureMode:!0,secondButtonLabel:e?l("Schedule.SendWhenOnline"):void 0,onClose:Z,onSubmit:h,onSecondButtonClick:e?p:void 0})]}},56389:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(60748),o=n(33555),s=n(83716),i=n(69118);const r=(e,t)=>(0,a.Ye)((()=>(0,i.P2)((n=>{e&&t&&(0,o.Sv)().sendMessageAction({chatId:e,threadId:t,action:n})}),s.o_S)),[e,t])},33799:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60748),o=n(19369);function s(e){const t=(0,a.sO)();return t.current??(t.current=(0,o.gQ)(e)),t.current}},93862:(e,t,n)=>{n.d(t,{b:()=>i});var a=n(60748),o=n(19369),s=n(7792);function i(e,t){const n=(0,a.sO)(!0);n.current&&(n.current=!1,t?.forEach((t=>{(0,o.$Z)(t)&&t.subscribe(e)}))),(0,s.Z)((()=>()=>{(0,o.Dc)(e)}))}},87712:(e,t,n)=>{n.d(t,{F:()=>m,U:()=>u});var a=n(60748),o=n(83716),s=n(57710),i=n(9933),r=n(36560),c=n(80793),l=n(97184);const d=100;function m(e,t,n){return(0,a.d4)((()=>{if(!t||!e.current)return;const a=Z(),o=e.current;if(!l.s$||!n||!a?.isTypeSupported(n))return;const m=new a;function u(){if(!t||!n)return;const e=m.addSourceBuffer(n),a=(0,c.z)(t);e.addEventListener("updateend",(function(){a.next().then((({value:t,done:n})=>{"open"===m.readyState&&(n?p(m):h(e,t))}))})),a.next().then((({value:t,done:n})=>{n||"open"!==m.readyState||((0,s.WM)((()=>{o.style.display="block",setTimeout((()=>{(0,s.WM)((()=>{(0,i.Zs)(o,{opacity:"1"})}))}),d)})),h(e,t))}))}return m.addEventListener("sourceopen",u,{once:!0}),(0,s.WM)((()=>{(0,i.Zs)(o,{display:"none",opacity:"0"}),o.src=URL.createObjectURL(m)})),()=>{(0,s.WM)((()=>{const e=o.src;(0,r.Z)(o),m.removeEventListener("sourceopen",u),"open"===m.readyState&&p(m),URL.revokeObjectURL(e)}))}}),[n,t,e]),u(n)}function u(e){return!(!l.s$||!e)&&Boolean(Z()?.isTypeSupported(e))}function h(e,t){try{e.appendBuffer(t)}catch(e){o.eMD&&console.warn("[Stream] failed to append buffer",e)}}function p(e){try{e.endOfStream()}catch(e){o.eMD&&console.warn("[Stream] failed to end stream",e)}}function Z(){return"ManagedMediaSource"in window?ManagedMediaSource:"MediaSource"in window?MediaSource:void 0}},20797:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(60748),o=n(69118),s=n(25190);function i(e){const t=(0,s.Z)(e);(0,a.d4)((()=>(0,o.Gq)(t)),[t])}},74095:(e,t,n)=>{n.d(t,{K:()=>i});var a=n(69995);function o(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?a:String(a))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s{constructor(e,t,n){this.target=e,this.onUpdate=t,this.channel=n,o(this,"requestStates",new Map),o(this,"requestStatesByCallback",new Map)}destroy(){}init(...e){this.postMessage({type:"init",args:e})}request(e){const{requestStates:t,requestStatesByCallback:n}=this,o=(0,a.Z)(),s={type:"callMethod",messageId:o,...e},i={messageId:o},r=new Promise(((e,t)=>{Object.assign(i,{resolve:e,reject:t})}));if("function"==typeof s.args[s.args.length-1]){s.withCallback=!0;const e=s.args.pop();i.callback=e,n.set(e,i)}return t.set(o,i),r.catch((()=>{})).finally((()=>{t.delete(o),i.callback&&n.delete(i.callback)})),this.postMessage(s),r}cancelCallback(e){e.isCanceled=!0;const{messageId:t}=this.requestStatesByCallback.get(e)||{};t&&this.postMessage({type:"cancelProgress",messageId:t})}onMessage(e){const{requestStates:t,channel:n}=this;if(e.channel===n)if("update"===e.type&&this.onUpdate&&this.onUpdate(e.update),"methodResponse"===e.type){const n=t.get(e.messageId);n&&(e.error?n.reject(e.error):n.resolve(e.response))}else if("methodCallback"===e.type){const n=t.get(e.messageId);n?.callback?.(...e.callbackArgs)}else if("unhandledError"===e.type)throw new Error(e.error?.message)}postMessage(e){e.channel=this.channel,this.target.postMessage(e)}}function i(e,t,n){const a=new s(e,t,n);function o({data:e}){a.onMessage(e)}return e.addEventListener("message",o),a.destroy=()=>{e.removeEventListener("message",o)},a}},8582:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(33555),o=n(57710),s=n(7054),i=n(9933);const r=300,c=new Map;function l(e,t,n=r){(0,s.FOo)((0,a.Rd)())||(n=0);const l="rtl"===e.getAttribute("dir"),{scrollLeft:d,offsetWidth:m,scrollWidth:u,dataset:{scrollId:h}}=e;let p=t-d;if(p<0){const e=-d*(l?-1:1);p=Math.max(p,e)}else if(p>0){const e=u-(d+m);p=Math.min(p,e)}if(0===p)return Promise.resolve();h&&c.has(h)&&c.get(h)();const Z=d+p;return new Promise((t=>{(0,o.WM)((()=>{if(0===n)return e.scrollLeft=Z,void t();let a=!1;const s=Math.random().toString();e.dataset.scrollId=s,c.set(s,(()=>{a=!0})),e.style.scrollSnapType="none";const r=Date.now();(0,i.jt)((()=>{if(a)return!1;const o=Math.min((Date.now()-r)/n,1),i=p*(1-function(e){return 1-(1-e)**3.5}(o));return e.scrollLeft=Math.round(Z-i),o>=1&&(e.style.scrollSnapType="",delete e.dataset.scrollId,c.delete(s),t()),o<1}),o.WM)}))}))}},81740:(e,t,n)=>{n.d(t,{Ni:()=>g,ZP:()=>h,wA:()=>p});var a=n(33555),o=n(91713),s=n(83716),i=n(57710),r=n(7054),c=n(9933),l=n(97184),d=n(18674);let m,u=!1;function h(...e){m=e.slice(0,8);const t=Z(...m);if(e[8])return t;(0,i.WM)(t)}function p(){u&&((0,c.vR)(),(0,i.i$)((()=>{(0,i.WM)(Z(...m))})))}function Z(e,t,n,h=0,p=s.V$q,Z,g,P){Z!==o.fo.Static&&(0,r.FOo)((0,a.Rd)())||(g=0);const{offsetTop:E,offsetHeight:y}=t,{scrollTop:b,offsetHeight:C,scrollHeight:S}=e,w=P&&e.dataset.normalHeight?Number(e.dataset.normalHeight):C;let I;switch(n){case"start":I=E-h+(l.wZ?1:0);break;case"end":I=E+y+h-w;break;case"nearest":case"center":case"centerOrTop":I=y<w?E+y/2-w/2:E-h}const N=function(e,t,n=s.V$q,a){const{scrollTop:i}=e;if(void 0===a){const e=t-i;if(e<-n)return i+(e+n);if(e>n)return i+(e-n)}else{if(a===o.fo.Up)return t+n;if(a===o.fo.Down)return Math.max(0,t-n)}return i}(e,I,p,Z);let M=I-N;if(M<0){const e=-N;M=Math.max(M,e)}else if(M>0){const e=S-(N+w);M=Math.min(M,e)}const k=Math.abs(M);return()=>{if(k<1)return void(b!==N&&(e.scrollTop=N));const t=N+M;if(0===g)return void(e.scrollTop=t);u=!0;const n=k<=s.xnK?f:v,a=g||s.bKs+k/s.V$q*(s.ckE-s.bKs),o=Date.now(),r=(0,d.YW)();(0,c.cK)((()=>{const s=Math.min((Date.now()-o)/a,1),i=M*(1-n(s)),c=Math.round(t-i);return e.scrollTop=c,u=s<1&&c!==t,u||(m=void 0,r()),u}),i.WM)}}function g(){return u}function f(e){return 1-(1-e)**3.5}function v(e){return 1-(1-e)**6.5}},10396:(e,t,n)=>{n.d(t,{An:()=>P,Es:()=>g,z2:()=>f});var a=n(33555),o=n(91713),s=n(57710),i=n(7054),r=n(490),c=n(85266),l=n(74753),d=n(97184);const m=new Map;let u,h=[],p=[];function Z(e,t){const n=u&&m.get(u);n&&(n.audio.pause(),n.audio.currentTime=0,n.onTrackChange&&n.onTrackChange());const s=v(e,(0,i.jUK)((0,a.Rd)()).audioPlayer.origin||o.Cr.Inline,t);if(!s)return;if(!m.has(s))return void(0,a.Sv)().openAudioPlayer((0,r.Ak)(E(s).messageKey));const c=m.get(s);c.onForcePlay&&c.onForcePlay(),u=s,c.audio.src&&(0,l.Z)(c.audio)}function g(){const e=u&&m.get(u);e&&e.audio.pause()}function f(e,t,n,g,f){if(!m.has(e)){const n=function(e,t,n,a){const o=new Audio;function s(t){return n=>{m.has(e)&&((0,c.z)(o)||m.get(e).handlers.forEach((e=>{e(t,n)})))}}return o.addEventListener("timeupdate",s("onTimeUpdate")),o.addEventListener("play",s("onPlay")),o.addEventListener("pause",s("onPause")),o.addEventListener("loadstart",s("onLoadStart")),o.addEventListener("loadeddata",s("onLoadedData")),o.addEventListener("playing",s("onPlaying")),o.addEventListener("ended",(()=>{m.has(e)&&((0,c.z)(o)||Z(e))})),{audio:o,type:t,proxy:new Proxy(o,{get:(e,t)=>e[t]}),handlers:[],onForcePlay:n,onTrackChange:a}}(e,t,g,f);m.set(e,n),function(e,t){"audio"!==e.type||p.includes(t)||(p.push(t),p.sort(y)),"voice"!==e.type||h.includes(t)||(h.push(t),h.sort(y))}(n,e)}const{audio:P,proxy:b,handlers:C}=m.get(e);return C.push(n),{play(n){if(!P.paused)return;const s=u&&m.get(u);s&&u!==e&&(s.audio.pause(),s.audio.currentTime=0,(0,c.z)(s.audio)&&(s.audio.dataset.preventPlayAfterPatch="true"),s.onTrackChange&&s.onTrackChange()),u=e,P.src||(P.src=n,P.preload="auto",n.includes("/progressive/")&&d.s$&&(delete P.dataset.preventPlayAfterPatch,(0,c.B)(P))),(0,l.Z)(P),function(e,t){if((0,i.jUK)((0,a.Rd)()).globalSearch.currentContent===o.nJ.Music)return;const{chatId:n}=(0,r.Ak)(E(t).messageKey),s=(0,i.Btg)((0,a.Rd)())?.chatId,c=e=>e.startsWith(`msg${n}`)||s&&e.startsWith(`msg${s}`);"audio"===e&&(p=p.filter(c)),"voice"===e&&(h=h.filter(c))}(t,e)},pause(){u===e&&P.pause()},stop(){if(u===e){const e=P.src;P.pause(),(0,s.Yq)((()=>{P.src="",P.src=e}))}},setCurrentTime(t){u===e&&(P.fastSeek?P.fastSeek(t):P.currentTime=t)},setVolume(t){u===e&&(P.volume=t,P.muted=!1)},setPlaybackRate(t){u===e&&(P.playbackRate=t)},toggleMuted(e){P.muted=void 0===e?!P.muted:e},proxy:b,requestNextTrack(){Z(e)},isLast:()=>!v(e,(0,i.jUK)((0,a.Rd)()).audioPlayer.origin),isFirst:()=>!v(e,(0,i.jUK)((0,a.Rd)()).audioPlayer.origin,!0),requestPreviousTrack(){Z(e,!0)},destroy(t=!1){const a=m.get(e);a&&(a.handlers=a.handlers.filter((e=>e!==n)),a.handlers.length||(a.audio.pause(),m.delete(e),t&&function(e,t){const n=e=>e!==t;"audio"===e.type&&(p=p.filter(n)),"voice"===e.type&&(h=h.filter(n))}(a,e),e===u&&(u=void 0)))}}}function v(e,t=o.Cr.Inline,n){const a=function(e){switch(e.type){case"audio":return p;case"voice":return h;default:return}}(m.get(e));if(!a)return;if(t===o.Cr.Search){const t=a.indexOf(e);if(t<0)return;return a[t+(n?-1:1)]}const{chatId:s}=(0,r.Ak)(E(e).messageKey),i=a.filter((e=>e.startsWith(`msg${s}`))),c=i.indexOf(e);if(c<0)return;let l=t===o.Cr.Inline?-1:1;return n&&(l*=-1),i[c+l]}function P(e){const t=(0,r.zf)(e);if(t)return`${t}-${e.date}`}function E(e){return{messageKey:e.match(/^msg(-?\d+)-(\d+)/)[0],date:Number(e.split("-").pop())}}function y(e,t){if(!e||!t)return 0;const{date:n,messageKey:a}=E(e),{date:o,messageKey:s}=E(t),i=o-n;return 0===i?s.localeCompare(a):i}},75851:(e,t,n)=>{n.d(t,{CO:()=>s,eb:()=>r,ix:()=>c,rZ:()=>l,uR:()=>d,wK:()=>o,xP:()=>i});var a=n(71394);function o(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}function s(e){const t=e[0].toString(16),n=e[1].toString(16),a=e[2].toString(16);return(1==t.length?"0"+t:t)+(1==n.length?"0"+n:n)+(1==a.length?"0"+a:a)}function i([e,t,n]){e/=255,t/=255,n/=255;let a,o,s=Math.max(e,t,n),i=Math.min(e,t,n),r=s,c=s-i;if(o=0==s?0:c/s,s==i)a=0;else{switch(s){case e:a=(t-n)/c+(t<n?6:0);break;case t:a=(n-e)/c+2;break;case n:a=(e-t)/c+4}a/=6}return[a,o,r]}function r([e,t,n]){let a,o,s,i=Math.floor(6*e),r=6*e-i,c=n*(1-t),l=n*(1-r*t),d=n*(1-(1-r)*t);switch(i%6){case 0:a=n,o=d,s=c;break;case 1:a=l,o=n,s=c;break;case 2:a=c,o=n,s=d;break;case 3:a=c,o=l,s=n;break;case 4:a=d,o=c,s=n;break;case 5:a=n,o=c,s=l}return[Math.round(255*a),Math.round(255*o),Math.round(255*s)]}async function c(e){const t=[0,0,0];let n,o,s,i,r=-4,c=[0,0,0],l=0;const d=document.createElement("canvas"),m=d.getContext&&d.getContext("2d");if(!m)return t;const u=await(0,a.pt)(e);s=u.naturalHeight||u.offsetHeight||u.height,o=u.naturalWidth||u.offsetWidth||u.width,d.height=s,d.width=o,m.drawImage(u,0,0);try{n=m.getImageData(0,0,o,s)}catch(e){return t}for(i=n.data.length;(r+=20)<i;)0!==n.data[r+3]&&(++l,c[0]+=n.data[r],c[1]+=n.data[r+1],c[2]+=n.data[r+2]);return c[0]=Math.floor(c[0]/l),c[1]=Math.floor(c[1]/l),c[2]=Math.floor(c[2]/l),c}function l(e){const[t,n,a]=e;return.2126*t+.7152*n+.0722*a}function d(e){let[t,n,a]=i(e);return n=Math.min(1,n+.05+.1*(1-n)),a=a>.5?Math.max(0,.65*a):Math.max(0,Math.min(1,1-.65*a)),`hsla(${360*t}, ${100*n}%, ${100*a}%, .4)`}},3570:(e,t,n)=>{function a(e,t){return t-Math.floor(t/e)*e}n.d(t,{Z:()=>a})},6562:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(69118);const o=10,s=1e3;let i=[],r=!1;function c(e,t){i.push({url:e,filename:t}),r||(r=!0,setTimeout((async()=>{await async function(){let e=0;for(const t of i)l(t),e++,e===o&&(await(0,a.wO)(s),e=0);i=[]}(),r=!1}),s))}function l({url:e,filename:t}){const n=document.createElement("a");n.href=e,n.download=t;try{n.click()}catch(e){console.error(e)}}},9668:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(33681),o=n(15594);const s=new RegExp(`^(?:${a.Z.source})+$`,""),i=e=>{const t=(0,o.Z)(e).split("\n"),n=t.join("");if(n.length>800)return!1;if(!Boolean(n.match(s)))return!1;const i=t.map((e=>{let t=0;for(;a.Z.exec(e);)if(t++,t>100)return a.Z.lastIndex=0,-1;return t}));let r=t.length;for(let e=0;e<i.length;e++){if(-1===i[e])return!1;i[e]>r&&(r=i[e])}return r}},65723:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(97184);function o(e,t,n){if(!t&&e===document.activeElement)return;const o=window.getSelection(),s=document.createRange(),i=e.lastChild||e;a.$b||n||i&&i.nodeValue?(s.selectNodeContents(n?e:i),s.collapse(!1),o.removeAllRanges(),o.addRange(s)):e.focus()}},60998:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(83716);const o=1;function s(){const e=window.getSelection();let t=e?.rangeCount?e.getRangeAt(0).cloneContents():void 0;const n=e?.focusNode&&e.focusOffset>0&&i(e.focusNode,a.gnl);if(!t||0===t.childElementCount)return;const s=Array.from(t.children).reduce(((e,t)=>t.nodeType===o&&t.classList.contains("message-date-group")?Array.from(t.querySelectorAll(".Message")).reduce(((e,t)=>e.concat(Number(t.dataset.messageId))),e):t.nodeType===o&&t.classList.contains("Message")?e.concat(Number(t.dataset.messageId)):e),[]);for(;t.firstChild;)t.removeChild(t.firstChild);return t=void 0,n||s.pop(),s}function i(e,t){return!(e.nodeType!==o||!e.classList.contains(t))||!!e.parentNode&&i(e.parentNode,t)}},93447:(e,t,n)=>{n.d(t,{j:()=>s,t:()=>i});var a=n(75851);const o=240;function s(e,t,n="image/png"){const a=e instanceof Blob?URL.createObjectURL(e):e,o=new Image;return new Promise((s=>{o.onload=()=>{r(o,o.width*t,o.height*t,n).then((e=>{if(!e)throw new Error("Image resize failed!");return URL.createObjectURL(e)})).then(s).finally((()=>{e instanceof Blob&&URL.revokeObjectURL(a)}))},o.src=a}))}function i(e,t,n,a="image/png"){const o=e instanceof Blob?URL.createObjectURL(e):e,s=new Image;return new Promise((i=>{s.onload=()=>{r(s,t,n,a).then((e=>{if(!e)throw new Error("Image resize failed!");return URL.createObjectURL(e)})).then(i).finally((()=>{e instanceof Blob&&URL.revokeObjectURL(o)}))},s.src=o}))}async function r(e,t,n,s="image/png"){if(!("createImageBitmap"in window))return c(e,t,n,void 0,s);try{const i=await window.createImageBitmap(e,{resizeWidth:t,resizeHeight:n,resizeQuality:"high"});if(i.height!==n||i.width!==t)throw new Error("Image bitmap resize not supported!");const r=await(0,a.ix)(e.src),c=(0,a.rZ)(r)<o?"#fff":"#000";return await new Promise((e=>{const t=document.createElement("canvas");t.width=i.width,t.height=i.height;const n=t.getContext("2d");n.fillStyle=c,n.fillRect(0,0,t.width,t.height);const a=t.getContext("bitmaprenderer");a?a.transferFromImageBitmap(i):n.drawImage(i,0,0),t.toBlob(e,s)}))}catch(a){return c(e,t,n,void 0,s)}}async function c(e,t,n,s=.5,i="image/png"){const r=document.createElement("canvas"),c=r.getContext("2d"),l=document.createElement("canvas"),d=l.getContext("2d");if(r.width=t,r.height=n,e.width*s>t){const n=1/s;let a={width:Math.floor(e.width*s),height:Math.floor(e.height*s)};for(l.width=a.width,l.height=a.height,d.drawImage(e,0,0,a.width,a.height);a.width*s>t;)a={width:Math.floor(a.width*s),height:Math.floor(a.height*s)},d.drawImage(l,0,0,a.width*n,a.height*n,0,0,a.width,a.height);c.drawImage(l,0,0,a.width,a.height,0,0,r.width,r.height)}else c.drawImage(e,0,0,r.width,r.height);const m=await(0,a.ix)(e.src),u=(0,a.rZ)(m)<o?"#fff":"#000";return c.fillStyle=u,c.globalCompositeOperation="destination-over",c.fillRect(0,0,r.width,r.height),new Promise((e=>{r.toBlob(e,i)}))}},55254:(e,t,n)=>{n.d(t,{P:()=>o});var a=n(43858);function o(e){if("none"===e.style.display)return!1;const t=e.getBoundingClientRect(),{height:n}=a.Z.get();return t.top<=n&&t.top+t.height>=0}},91489:(e,t,n)=>{n.d(t,{Qw:()=>r,k4:()=>l,lZ:()=>c,zY:()=>i});const a={google:"https://maps.google.com/maps",bing:"https://bing.com/maps/default.aspx",osm:"https://www.openstreetmap.org",apple:"https://maps.apple.com"},o=new Map(Object.entries({"building/medical":"#43b3f4","building/gym":"#43b3f4","education/cafeteria":"#f7943f","travel/bedandbreakfast":"#9987ff","travel/hotel":"#9987ff","travel/hostel":"#9987ff","travel/resort":"#9987ff","travel/hotel_bar":"#e56dd6",arts_entertainment:"#e56dd6",building:"#6e81b2",education:"#a57348",event:"#959595",food:"#f7943f",home:"#00aeef",nightlife:"#e56dd6",parks_outdoors:"#6cc039",shops:"#ffb300",travel:"#1c9fff",work:"#ad7854"})),s=["#e56cd5","#f89440","#9986ff","#44b3f5","#6dc139","#ff5d5a","#f87aad","#6e82b3","#f5ba21"];function i(e,t,n=15){const{lat:o,long:s}=t,i=a[e];switch(e){case"google":return`${i}/place/${o}+${s}/@${o},${s},${n}z`;case"bing":return`${i}?cp=${o}~${s}&lvl=${n}&sp=point.${o}_${s}`;case"apple":return`${i}?q=${o},${s}`;default:return`${i}/?mlat=${o}&mlon=${s}&zoom=${n}`}}function r(e,t){return 156543.03392*Math.cos(e*(Math.PI/180))/2**t}function c(e){return e?`https://ss3.4sqi.net/img/categories_v2/${e}_88.png`:""}function l(e){return e?o.get(e)||o.get(e.split("/")[0])||s[(t=e,t.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0)%s.length)]:"#008df2";var t}},64532:(e,t,n)=>{n.d(t,{Ay:()=>r,N:()=>o,NS:()=>l,Of:()=>d,Ym:()=>s,pC:()=>c});const a={play:void 0,pause:void 0,seekbackward:void 0,seekforward:void 0,previoustrack:void 0,nexttrack:void 0,stop:void 0,seekTo:void 0};function o(e,t){const{mediaSession:n}=window.navigator;n?(e&&s(e),t&&i(t)):console.warn("MediaSession API not supported in this browser")}function s(e){const{mediaSession:t}=window.navigator;t&&(t.metadata=e??null)}function i(e){const{mediaSession:t}=window.navigator;t&&Object.entries({...a,...e}).forEach((([e,n])=>{try{t.setActionHandler(e,n)}catch(e){}}))}function r(){const{mediaSession:e}=window.navigator;e&&(e.metadata=null,i(a),e.playbackState&&(e.playbackState="none"),e.setPositionState?.())}function c(e="none"){const{mediaSession:t}=window.navigator;t&&t.playbackState&&(t.playbackState=e)}function l(e){if(!e||void 0===e.position||void 0===e.duration)return;e.position=Math.min(e.position,e.duration);const{mediaSession:t}=window.navigator;t?.setPositionState?.(e)}function d({title:e,artist:t,album:n,artwork:a}){if("MediaMetadata"in window)return new window.MediaMetadata({title:e,artist:t,album:n,artwork:a})}},16580:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(60782);const o=new WeakMap;function s(e){return(...t)=>{const n=o.get(e);if(n&&(0,a.et)(n.lastArgs,t))return n.lastResult;const s=e(...t);return o.set(e,{lastArgs:t,lastResult:s}),s}}},89455:(e,t,n)=>{n.d(t,{ZP:()=>c,fu:()=>l,xe:()=>i});var a=n(59187),o=n(83716),s=n(97184);const i={B:a.Vv.Bold,STRONG:a.Vv.Bold,I:a.Vv.Italic,EM:a.Vv.Italic,INS:a.Vv.Underline,U:a.Vv.Underline,S:a.Vv.Strike,STRIKE:a.Vv.Strike,DEL:a.Vv.Strike,CODE:a.Vv.Code,PRE:a.Vv.Pre,BLOCKQUOTE:a.Vv.Blockquote},r=3;function c(e,t=!1,n=!1){const c=document.createElement("div");c.innerHTML=n?e:function(e){let t=e.slice(0);return t=t.replace(/&nbsp;/g," "),t=t.replace(/<div><br([^>]*)?><\/div>/g,"\n"),t=t.replace(/<br([^>]*)?>/g,"\n"),t=t.replace(/<\/div>(\s*)<div>/g,"\n"),t=t.replace(/<div>/g,"\n"),t=t.replace(/<\/div>/g,""),t=t.replace(/^`{3}(.*?)[\n\r](.*?[\n\r]?)`{3}/gms,'<pre data-language="$1">$2</pre>'),t=t.replace(/^`{3}[\n\r]?(.*?)[\n\r]?`{3}/gms,"<pre>$1</pre>"),t=t.replace(/[`]{3}([^`]+)[`]{3}/g,"<pre>$1</pre>"),t=t.replace(/(?!<(code|pre)[^<]*|<\/)[`]{1}([^`\n]+)[`]{1}(?![^<]*<\/(code|pre)>)/g,"<code>$2</code>"),s.op||(t=t.replace(/\[<img[^>]+alt="([^"]+)"[^>]*>]/gm,"[$1]")),t=t.replace(/(?!<(?:code|pre)[^<]*|<\/)\[([^\]\n]+)\]\(customEmoji:(\d+)\)(?![^<]*<\/(?:code|pre)>)/g,'<img alt="$1" data-document-id="$2">'),t=t.replace(/(?!<(code|pre)[^<]*|<\/)[*]{2}([^*\n]+)[*]{2}(?![^<]*<\/(code|pre)>)/g,"<b>$2</b>"),t=t.replace(/(?!<(code|pre)[^<]*|<\/)[_]{2}([^_\n]+)[_]{2}(?![^<]*<\/(code|pre)>)/g,"<i>$2</i>"),t=t.replace(/(?!<(code|pre)[^<]*|<\/)[~]{2}([^~\n]+)[~]{2}(?![^<]*<\/(code|pre)>)/g,"<s>$2</s>"),t=t.replace(/(?!<(code|pre)[^<]*|<\/)[|]{2}([^|\n]+)[|]{2}(?![^<]*<\/(code|pre)>)/g,`<span data-entity-type="${a.Vv.Spoiler}">$2</span>`),t}(t?function(e){return e.replace(new RegExp(`\\[([^\\]]+?)]\\((${o.FM6}+?)\\)`,"g"),((e,t,n)=>`<a href="${n.includes("://")?n:n.includes("@")?`mailto:${n}`:`https://${n}`}">${t}</a>`))}(e):e),l(c);const d=c.innerText.trim().replace(/\u200b+/g,"");let m=-c.innerText.indexOf(d[0]),u=0;const h=[];function p(e){if(e.nodeType===Node.COMMENT_NODE)return;const{index:t,entity:n}=function(e,t,n){const o=function(e){if(e instanceof HTMLElement&&e.dataset.entityType)return e.dataset.entityType;if(i[e.nodeName])return i[e.nodeName];if("A"===e.nodeName){const t=e;return t.dataset.entityType===a.Vv.MentionName?a.Vv.MentionName:t.dataset.entityType===a.Vv.Url?a.Vv.Url:t.href.startsWith("mailto:")?a.Vv.Email:t.href.startsWith("tel:")?a.Vv.Phone:t.href!==t.textContent?a.Vv.TextUrl:a.Vv.Url}return"SPAN"===e.nodeName?e.dataset.entityType:"IMG"===e.nodeName&&e.dataset.documentId?a.Vv.CustomEmoji:void 0}(e);if(!o||!e.textContent)return{index:n,entity:void 0};const s=t.indexOf(e.textContent,n),r=s>=0?s:n,c=t.substring(0,r).length,{length:l}=t.substring(r,r+e.textContent.length);return o===a.Vv.TextUrl?{index:r,entity:{type:o,offset:c,length:l,url:e.href}}:o===a.Vv.MentionName?{index:r,entity:{type:o,offset:c,length:l,userId:e.dataset.userId}}:o===a.Vv.Pre?{index:r,entity:{type:o,offset:c,length:l,language:e.dataset.language}}:o===a.Vv.CustomEmoji?{index:r,entity:{type:o,offset:c,length:l,documentId:e.dataset.documentId}}:{index:r,entity:{type:o,offset:c,length:l}}}(e,d,m);if(n)m=t,h.push(n);else if(e.textContent){if(0===t&&""===e.textContent.trim())return;m+=e.textContent.length}e.hasChildNodes()&&u<=r&&(u+=1,Array.from(e.childNodes).forEach(p))}return Array.from(c.childNodes).forEach((e=>{u=1,p(e)})),{text:d,entities:h.length?h:void 0}}function l(e){e.querySelectorAll("img").forEach((e=>{e.dataset.documentId?e.textContent=e.alt||"":e.replaceWith(e.alt||"")}))}},80793:(e,t,n)=>{n.d(t,{z:()=>d});var a=n(59187),o=n(92387);const s=262144,i=5242879,r=new Map,c=new Map,l=new Map;async function*d(e,t=0,n=s){const d=e.match(/fileSize=(\d+)/);let m;for(m=d?d&&Number(d[1]):c.get(e);;){if(m&&t>=m)return;let s=t+n-1;m&&s>m&&(s=m-1);const d=`${e}:${t}-${s}`;let u=r.get(d);if(!u){let n=l.get(d);n||(n=(0,o.t9)("downloadMedia",{mediaFormat:a.IU.Progressive,url:e,start:t,end:s}),l.set(d,n));const h=await n.finally((()=>{l.delete(d)}));if(!h?.arrayBuffer)return;h.fullSize&&!m&&(m=h.fullSize,c.set(e,h.fullSize)),u=h.arrayBuffer,s<=i&&r.set(d,h.arrayBuffer)}yield u,t=s+1}}},41098:(e,t,n)=>{n.d(t,{Mq:()=>r,dG:()=>c,gJ:()=>s,qK:()=>i,tx:()=>o});const a=document.createElement("div");function o(e){const t=window.getSelection();if(t?.getRangeAt&&t.rangeCount){const n=t.getRangeAt(0);n.deleteContents();const a=n.createContextualFragment(e),o=a.lastChild;n.insertNode(a),o?(n.setStartAfter(o),n.setEndAfter(o)):n.collapse(!1),t.removeAllRanges(),t.addRange(n)}}function s(e,t){if(!e)return"";const n=window.getSelection();if(!n||!n.rangeCount)return e.innerHTML;const o=n.getRangeAt(0).cloneRange();return o.intersectsNode(e)?t||e.contains(o.commonAncestorContainer)?(o.collapse(!0),o.setStart(e,0),a.innerHTML="",a.appendChild(o.cloneContents()),a.innerHTML):"":e.innerHTML}function i(e){let t=0;const n=window.getSelection();if(!n||0===n.rangeCount)return t;const a=n.getRangeAt(0),o=a.cloneRange();return o.selectNodeContents(e),o.setEnd(a.endContainer,a.endOffset),t=o.toString().length,t}function r(e,t){for(const n of e.childNodes)if(n.nodeType===Node.TEXT_NODE){if(n.length>=t){const e=document.createRange(),a=window.getSelection();return e.setStart(n,t),e.collapse(!0),a.removeAllRanges(),a.addRange(e),-1}t-="length"in n?n.length:0}else if(-1===(t=r(n,t)))return-1;return t}function c(){const e=window.getSelection();e?.removeAllRanges()}},85655:(e,t,n)=>{let a;function o(e="*",t,n=!1){a||(a=document.createElement("input"),a.setAttribute("type","file")),a.setAttribute("accept",e),n?a.removeAttribute("multiple"):a.setAttribute("multiple","multiple"),a.onchange=null,a.value="",a.onchange=t,a.click()}n.d(t,{g:()=>o})},1735:(e,t,n)=>{function a(e){const t=8*e.length,n=Math.floor(t/5);if(!n)return[];const a=Array(n),o=e;for(let e=0,t=n-1;e!==t;++e){const t=Math.floor(5*e/8),n=Math.floor(5*e%8),s=o[t]+(o[t+1]<<8);a[e]=s>>n&31}const s=Math.floor(5*(n-1)/8),i=Math.floor(5*(n-1)%8),r=o[s]+(o[s+1]<<8);return a[n-1]=r>>i&31,a}function o(e,t){let n=0;const a=new Array(t),o=e.length/t,s=e[0],i=e[e.length-1];for(let r=0;r<t;r++){const t=Math.floor(r*o),c=((e[t-1]??s)+(e[t]??s)+(e[t+1]??i))/3;a[r]=c,n<c&&(n=c)}return{data:a,peak:n}}n.d(t,{C:()=>o,x:()=>a})},31482:(e,t,n)=>{n.d(t,{Z:()=>a});const a={root:"gXO57D98",chosen:"VXSJn0Sm","animated-emoji":"lFjoRm_p",animatedEmoji:"lFjoRm_p",tag:"Dr889Kzc",tail:"cUfY1b26","is-safari":"rxxUijuG",isSafari:"rxxUijuG","tail-fill":"y591o4fN",tailFill:"y591o4fN","tag-text":"ly7cruxF",tagText:"ly7cruxF",counter:"P2FqNJAi",disabled:"NRtGofbf"}},41372:(e,t,n)=>{n.d(t,{Z:()=>a});const a={root:"CdTfL4f7",fadeIn:"MyeHARy0",closing:"EZbKn_M3",peer:"kW0xpExG",name:"BDZrSTO_",name_hasUnreadStory:"OoUm5AUZ",nameHasUnreadStory:"OoUm5AUZ",hidden:"lnVtxMZI",contextMenu:"N1sagA0s"}},4710:(e,t,n)=>{n.d(t,{Z:()=>a});const a={name:"BDZrSTO_",root:"QOz6fQFU",avatar:"dXSy0i2c",avatarHidden:"n0vJEdNW",ghost:"E1IeDpeb",ghostAnimateName:"HMp3KTKQ",ghostRevealName:"unYkDic1",ghostLast:"dZJGfaXC"}},68973:(e,t,n)=>{e.exports=n.p+"encoderWorker.min.8ea62f6317fbac7d4558.js"}}]);
//# sourceMappingURL=9958.a4f07edfa6b9d4ae6c3d.js.map